/* VimeoPlayer - v4.40.66 - 2025-05-28 - https://player.vimeo.com/NOTICE.txt */
const e={MANIFEST:"manifest",SEGMENT:"segment"},t={method:"GET",async:!0,retry:0,throwHttpErrors:!0,headers:{},hooks:{beforeRequest:[],beforeRetry:[],afterResponse:[]},validateStatus:function(e){return e>=200&&e<300},retryStatus:function(e){return[408,413,429].includes(e)||e>=500&&e<600}};function n(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function r(e,t,n){if("function"==typeof e?e===t:e.has(t))return arguments.length<3?t:n;throw new TypeError("Private element is not present on this object")}function i(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function o(e,t){return e.get(r(e,t))}function s(e,t,n){i(e,t),t.set(e,n)}function a(e,t,n){return e.set(r(e,t),n),n}function u(e,t){i(e,t),t.add(e)}function c(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,S(r.key),r)}}function l(e,t,n){return t&&c(e.prototype,t),n&&c(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function d(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(n)return(n=n.call(e)).next.bind(n);if(Array.isArray(e)||(n=b(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0;return function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function h(e,t,n){return(t=S(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function f(e){return f=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},f(e)}function p(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,E(e,t)}function _(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(_=function(){return!!e})()}function m(e){if(null==e)throw new TypeError("Cannot destructure "+e)}function v(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function g(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?v(Object(n),!0).forEach((function(t){h(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):v(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function y(e,t){if(null==e)return{};var n,r,i=function(e,t){if(null==e)return{};var n={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(t.includes(r))continue;n[r]=e[r]}return n}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)n=o[r],t.includes(n)||{}.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}function E(e,t){return E=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},E(e,t)}function T(e){return function(e){if(Array.isArray(e))return n(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||b(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function S(e){var t=function(e){if("object"!=typeof e||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:t+""}function b(e,t){if(e){if("string"==typeof e)return n(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?n(e,t):void 0}}function A(e){var t="function"==typeof Map?new Map:void 0;return A=function(e){if(null===e||!function(e){try{return-1!==Function.toString.call(e).indexOf("[native code]")}catch(Pp){return"function"==typeof e}}(e))return e;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(void 0!==t){if(t.has(e))return t.get(e);t.set(e,n)}function n(){return function(e,t,n){if(_())return Reflect.construct.apply(null,arguments);var r=[null];r.push.apply(r,t);var i=new(e.bind.apply(e,r));return n&&E(i,n.prototype),i}(e,arguments,f(this).constructor)}return n.prototype=Object.create(e.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}}),E(n,e)},A(e)}function w(e){return e.filter(((e,t,n)=>n.indexOf(e)===t))}function I(e,t){return e.reduce(((e,n,r,i)=>e.concat(t(n,r,i))),[])}function R(e){return(t,...n)=>(n.forEach((n=>{for(const r in n){const i=Object.getOwnPropertyDescriptor(n,r);Object.defineProperty(t,r,Object.assign(i,e))}})),t)}const k=R({enumerable:!1,configurable:!0,writeable:!1}),P=R({enumerable:!1,configurable:!1,writeable:!1}),D=R({enumerable:!0,configurable:!0,writeable:!1}),O=e=>new Promise((t=>setTimeout(t,e)));function L(e){e.substring(0,e.lastIndexOf("/")+1)}const C=(e,t=!1)=>new Promise(((n,r)=>{if(t){const t=document.querySelector(`script[src="${e}"]`);if(t&&!t.dataset.error)return void setTimeout(n,0)}const i=document.createElement("script");i.src=e,i.addEventListener("load",n),i.addEventListener("error",(e=>{i.dataset.error="true",r(e.error)})),document.head.appendChild(i)})),N=e=>Math.pow(e,2),M=e=>Math.sqrt(e),x=(e,t)=>{const n=(n,...r)=>{[`%c${e}`,t].concat(r)},r=e=>(...t)=>{n.apply(void 0,[e].concat(t))},i=r("log"),o=(...e)=>{i.apply(void 0,e)};return Object.assign(o,{log:i,warn:r("warn"),error:r("error")}),o};function U(e,...t){return t.reduce(((e,t)=>(Object.keys(t||{}).forEach((n=>{const r=e[n],i=t[n];r&&void 0===i||(Array.isArray(i)?e[n]=(r||[]).concat(i):(e=>e&&"object"==typeof e)(i)?e[n]=U({},r,i):e[n]=i)})),e)),e)}const F=(e=!1)=>e?window.MediaSource:j,j=void 0!==window.ManagedMediaSource?window.ManagedMediaSource:window.MediaSource;function V(){let e,t,n=new Promise(((n,r)=>{e=n,t=r}));return Object.assign(n,{resolve:e,reject:t}),n}function B(e,t){if(!t||!t.length)return 0;if(1===t.length&&t.end(0)-t.start(0)<1e-6)return 0;let n=0;for(let r=t.length-1;r>=0&&t.end(r)>e;--r)n+=t.end(r)-Math.max(t.start(r),e);return n}function H(e,t){let n=e;for(let r=0;r<t.length;r++)if(t.start(r)<=e&&t.end(r)>=e){n=t.end(r);break}return n-e}function X(){return void 0!==window.performance&&"function"==typeof window.performance.now?window.performance.now():Date.now()}function W(){return Math.trunc(X()/1e3)}function q(e){return W()-e}function G(e){return X()-e}const K=e=>Math.trunc(Date.now()/1e3)-e;function Y(e){try{const t=new URLSearchParams;return Object.entries(e).forEach((([e,n])=>{void 0!==n&&t.append(e,String(n))})),t.toString()}catch(Rp){return""}}function $(e){if("string"!=typeof e)return{};try{const t=new URLSearchParams(e),n={};return t.forEach(((e,t)=>{n[t]=e})),n}catch(Rp){return{}}}function z(e){try{return new URL(e)}catch(t){return{}}}const Q=(e,t,n=!1)=>{try{const r=new URL(e);return Object.entries(t).forEach((([e,t])=>{var i;n&&void 0===t||r.searchParams.set(e,null!==(i=null==t?void 0:t.toString())&&void 0!==i?i:"")})),r.toString()}catch(Rp){return e}},J=e=>{try{const{username:t,password:n,host:r}=new URL(e);return r?t||n?`${t}:${n}@${r}`:r:null}catch(Rp){return null}};function Z(){return([1e7]+-1e3+-4e3+-8e3+-1e11).replace(/[018]/g,(e=>(e^16*Math.random()>>e/4).toString(16)))}function ee(e,t){this.headers={},this.perfTimings={},U(this,t),this.ok=2==(this.status/100|0),this.body=e,this.text=()=>Promise.resolve(e),this.json=()=>Promise.resolve(JSON.parse(e)),this.blob=()=>Promise.resolve(new Blob([e])),this.arrayBuffer=()=>Promise.resolve(e),this.clone=()=>new ee(e,this),this.isVimeoResponse=!0}let te=function(e){function t(){var t;return(t=e.call(this,"The operation was aborted.")||this).name="AbortError",t}return p(t,e),t}(A(Error)),ne=function(e){function t(t){var n;return(n=e.call(this,t.statusText)||this).name="HTTPError",n.response=t,n}return p(t,e),t}(A(Error)),re=function(e){function t(){var t;return(t=e.call(this,"A network error occurred.")||this).name="NetworkError",t}return p(t,e),t}(A(Error)),ie=function(e){function t(t){var n;return(n=e.call(this,"Request timed out.")||this).name="TimeoutError",n.timeoutMs=t,n}return p(t,e),t}(A(Error));function oe(e,t){let{url:n,method:r,body:i,onDownloadProgress:o}=e,s=100;return new Promise((function(a,u){const c=t?new t:new XMLHttpRequest,l=window.performance;c.open(r.toUpperCase(),n,e.async),e.timeout&&(c.timeout=e.timeout),c.onload=function(){if(0===c.status&&(!c.responseURL||0!==c.responseURL.indexOf("file:")))return;const e={};c.getAllResponseHeaders().replace(/^(.*?):[^\S\n]*([\s\S]*?)$/gm,((t,n,r)=>{e[n]=e[n]?`${e[n]},${r}`:r}));let t={};if(window.performance&&void 0!==window.performance.getEntriesByType){const e=window.performance.getEntriesByType("resource");if(e.length&&e.length>=s&&("function"==typeof l.clearResourceTimings&&l.clearResourceTimings(),"function"==typeof l.setResourceTimingBufferSize&&(l.setResourceTimingBufferSize(500),s=500)),e.length){const n=e.filter((e=>e.name===c.responseURL)).sort(((e,t)=>e.connectStart-t.connectStart));n.length&&(t=n[n.length-1].toJSON())}}a(new ee(c.response,{headers:e,statusText:c.statusText,status:c.status,url:c.responseURL,perfTimings:t}))},c.onabort=function(){u(new te)},c.onerror=function(){u(new re)},c.ontimeout=function(){u(new ie(e.timeout))},"function"==typeof o&&c.addEventListener("progress",o);for(let t in e.headers)c.setRequestHeader(t,e.headers[t]);e.withCredentials&&(c.withCredentials=!0),e.responseType&&(c.responseType=e.responseType),e.abort=c.abort.bind(c),c.send(i||null)}))}function se(){}function ae(e,t,n){if(!e.s){if(n instanceof ue){if(!n.s)return void(n.o=ae.bind(null,e,t));1&t&&(t=n.s),n=n.v}if(n&&n.then)return void n.then(ae.bind(null,e,t),ae.bind(null,e,2));e.s=t,e.v=n;const r=e.o;r&&r(e)}}const ue=function(){function e(){}return e.prototype.then=function(t,n){const r=new e,i=this.s;if(i){const e=1&i?t:n;if(e){try{ae(r,1,e(this.v))}catch(Rp){ae(r,2,Rp)}return r}return this}return this.o=function(e){try{const i=e.v;1&e.s?ae(r,1,t?t(i):i):n?ae(r,1,n(i)):ae(r,2,i)}catch(Rp){ae(r,2,Rp)}},r},e}();function ce(e){return e instanceof ue&&1&e.s}function le(e){const t=function(e){return function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];try{return Promise.resolve(e.apply(this,t))}catch(Rp){return Promise.reject(Rp)}}}((function(r){return function(e,t){try{var n=e()}catch(Rp){return t(Rp)}return n&&n.then?n.then(void 0,t):n}(r,(function(i){let o=!1;const s=function(t){if(!e.retryAbortErrors&&t instanceof te)return 0;if(t instanceof ie)return 0;if(n>=e.retry)return 0;if(t instanceof ne){if(!e.retryStatus(t.response.status))return 0;const n=function(e){const t="retry-after".toLowerCase();for(const n in e)if(n.toLowerCase()===t)return e[n];return null}(t.response.headers);if(n&&e.retryStatus(t.response.status)){let e=Number(n);return isNaN(e)?e=Date.parse(n)-Date.now():e*=1e3,e}if(413===t.response.status)return 0}return.3*2**(n-1)*1e3}(i);return n++,function(a,u){var c=function(){if(0!==s&&n>0)return function(e,t){return void 0?t?t(e):e:(e&&e.then||(e=Promise.resolve(e)),t?e.then(t):e)}(O(s),(function(){var s;const a=(null==e||null==(s=e.hooks)?void 0:s.beforeRetry)||[];return function(e,t){return e&&e.then?e.then(t):t(e)}(function(e,t,n){var r,i,o=-1;return function s(a){try{for(;++o<e.length&&(!n||!n());)if((a=t(o))&&a.then){if(!ce(a))return void a.then(s,i||(i=ae.bind(null,r=new ue,2)));a=a.v}r?ae(r,1,a):r=a}catch(Rp){ae(r||(r=new ue),2,Rp)}}(),r}(a,(function(t){return function(e){if(!void 0)return e&&e.then?e.then(se):Promise.resolve()}((0,a[t])(e,i,n))})),(function(){const e=t(r);return o=!0,e}))}))}();return c&&c.then?c.then(u):u(c)}(0,(function(t){if(o)return t;if(e.throwHttpErrors)throw i}))}))}));let n=0;return t}function de(e,t){const n=e.then.bind(e);return Object.assign(e,{abort:t,then:(...e)=>de(n.apply(void 0,e),t)})}function he(e,t,n){return n?t?t(e):e:(e&&e.then||(e=Promise.resolve(e)),t?e.then(t):e)}function fe(e){return function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];try{return Promise.resolve(e.apply(this,t))}catch(Rp){return Promise.reject(Rp)}}}function pe(e,t,n){if(!e.s){if(n instanceof _e){if(!n.s)return void(n.o=pe.bind(null,e,t));1&t&&(t=n.s),n=n.v}if(n&&n.then)return void n.then(pe.bind(null,e,t),pe.bind(null,e,2));e.s=t,e.v=n;const r=e.o;r&&r(e)}}const _e=function(){function e(){}return e.prototype.then=function(t,n){const r=new e,i=this.s;if(i){const e=1&i?t:n;if(e){try{pe(r,1,e(this.v))}catch(Rp){pe(r,2,Rp)}return r}return this}return this.o=function(e){try{const i=e.v;1&e.s?pe(r,1,t?t(i):i):n?pe(r,1,n(i)):pe(r,2,i)}catch(Rp){pe(r,2,Rp)}},r},e}();function me(e){return e instanceof _e&&1&e.s}function ve(e,t,n){var r,i,o=-1;return function s(a){try{for(;++o<e.length&&(!n||!n());)if((a=t(o))&&a.then){if(!me(a))return void a.then(s,i||(i=pe.bind(null,r=new _e,2)));a=a.v}r?pe(r,1,a):r=a}catch(Rp){pe(r||(r=new _e),2,Rp)}}(),r}function ge(e,t){return e&&e.then?e.then(t):t(e)}const ye=["get","post","put","patch","head","delete"],Ee={json:"application/json",text:"text/plain",arrayBuffer:"*/*",blob:"*/*"},Te=["get"];function Se(e,t){const n=fe((function(){let e=!1,n=!1;const r=t.hooks.beforeRequest||[];return ge(ve(r,(function(i){return he((0,r[i])(t),(function(r){if(r instanceof be)return t=r,void(n=!0);if(null!=r&&r.isVimeoResponse){const n=Promise.resolve(r).then(Ae(t));return e=!0,n}}))}),(function(){return n||e})),(function(n){return e?n:oe(t).then(Ae(t))}))}));t=new be(e,t);const{method:r,json:i,jwt:o,searchParams:s}=t;i&&(t.headers["Content-Type"]=Ee.json,t.body=JSON.stringify(i)),o&&(t.headers.Authorization=`jwt ${o}`),s&&(t.url=Q(t.url,s));const a=-1!==Te.indexOf(r.toLowerCase())?le(t)(n):n();for(const u in Ee)a[u]=fe((function(){return t.headers["Content-Type"]=Ee[u],he(a,(function(e){return e.clone()[u]()}))}));return de(a,(()=>t.abort()))}function be(e,n){U(this,t,e="string"==typeof e?{url:e}:e,n)}function Ae(e){const{validateStatus:t,throwHttpErrors:n,hooks:r}=e;return fe((function(i){const o=r.afterResponse||[];return ge(ve(o,(function(t){return he((0,o[t])(e,i.clone()),(function(e){e instanceof ee&&(i=e)}))})),(function(){if(!t||t(i.status))return i;if(n)throw new ne(i);return i}))}))}ye.forEach((function(e){return Se[e]=(t,n)=>Se(t,g({method:e},n)),Se[e]}));const{get:we,post:Ie,put:Re,patch:ke,head:Pe}=Se,De={ARRAY_BUFFER:"arraybuffer"};var Oe=Object.freeze({__proto__:null,ContentTypes:e,defaults:t,requestMethods:ye,responseTypes:Ee,retryMethods:Te,request:Se,Request:be,get:we,post:Ie,put:Re,patch:ke,head:Pe,Response:ee,ResponseTypes:De,AbortError:te,HTTPError:ne,NetworkError:re,TimeoutError:ie,xhr:oe});const Le=navigator.userAgent.toLowerCase(),Ce=["googlebot","google-inspectiontool"],Ne=["bingbot","bingpreview","yandex","slurp","facebookexternalhit","msnbot","feedly","parse.ly"];function Me(e){e=e.toLowerCase();const t=new RegExp(e).test(Le);return"safari"===e?t&&new RegExp("version").test(Le):t}function xe(e){const t=document.createElement("div"),n=e.charAt(0).toUpperCase()+e.slice(1),r=(e+" "+["Webkit","Moz","O","ms"].join(n+" ")+n).split(" ");for(let i in r){const e=r[i];if(void 0!==t.style[e])return e}return e}const Ue=!!Me("android")&&(parseFloat(Le.replace(/^.* android (\d+)\.(\d+).*$/,"$1.$2"))||!0),Fe=window.devicePixelRatio||1,je=!(!Me("windows phone")&&!Me("iemobile"))&&(parseFloat(Le.replace(/^.* windows phone (os )?(\d+)\.(\d+).*$/,"$2.$3"))||!0),Ve=!!Me("msie")&&parseFloat(Le.replace(/^.*msie (\d+).*$/,"$1")),Be=!!Me("trident")&&parseFloat(Le.replace(/^.*trident\/(\d+)\.(\d+).*$/,"$1.$2"))+4,He=Me("ipad;")||Me("iphone;")||Me("ipod touch;")?parseFloat(Le.replace(/^.* os (\d+)_(\d+).*$/,"$1.$2")):navigator.userAgent.includes("Mac")&&"ontouchend"in document,Xe=/(iPhone|iPod|iPad).*AppleWebKit(?!.*Version)/i.test(navigator.userAgent),We="MacIntel"===navigator.platform&&navigator.maxTouchPoints>1,qe=Me("opera")||Me("opr"),Ge=/^Mozilla\/5\.0 \(.* Mac OS X.*\(KHTML, like Gecko\)(?: Mobile\/[\S]*|)$/i.test(Le),Ke=(Me("safari")||Xe)&&Me("apple")&&!Me("chrome")&&!Me("android");function Ye(e){if(!Ke)return!1;const t=e.split("."),n=function(){if(!Me("safari"))return[];const e=Le.split(" ").find((function(e){return/version\//.test(e)}));return e?e.replace("version/","").split(".").map((function(e){return parseInt(e,10)})):[]}();for(let r=0;r<3;r++){const e=parseInt(t[r],10)||0,i=n[r]||0;if(e<i)return!0;if(e>i)return!1}return!0}const $e={autoplayPolicy:Ye("11"),hevc:Ye("11"),dolbyVision:Ye("14.1"),spatial:Ye("11.0.2"),fullscreenRequiresDataLoaded:Ye("17.2")},ze={airPlay:"WebKitPlaybackTargetAvailabilityEvent"in window,android:Ue,appleMail:Ge,hasAutoplayPolicy:Ue||He||$e.autoplayPolicy||function(){if(!Me("chrome"))return[];const e=Le.split(" ").find((function(e){return He?/CriOS\//.test(e):/chrome\//.test(e)}));return e?e.replace("chrome/","").split(".").map((function(e){return parseInt(e,10)})):[]}()[0]>=66,iOS:He,iPadOS:We,mobileAndroid:Ue&&Me("mobile"),browser:{bb10:Me("bb10"),chrome:Me("chrome"),firefox:Me("firefox"),ie:Ve||Be,edge:Me("edge"),opera:qe,safari:Ke,chromium:"chrome"in window&&!Me("crios"),webKit:Ke||Me("crios")},mse:j,devicePixelRatio:Fe,iPhone:Me("iphone;")||Me("ipod touch;")||Me("ipod;"),iPad:Me("ipad;"),iPadNonRetina:Me("ipad;")&&Fe<2,mac:Me("mac os"),pictureInPictureSupportType:function(){if("pictureInPictureEnabled"in document)return"pip-api";const e=document.createElement("video");return!("function"!=typeof e.webkitSetPresentationMode||!e.webkitSupportsPresentationMode("picture-in-picture"))&&"webkit-presentation-mode"}(),pointerEvents:window.navigator.pointerEnabled||window.navigator.msPointerEnabled||!1,passiveEvents:function(){let e=!1;try{const t=Object.defineProperty({},"passive",{get:function(){e=!0}});window.addEventListener("testPassive",null,t),window.removeEventListener("testPassive",null,t)}catch(Rp){}return e}(),svg:!!document.createElementNS&&!!document.createElementNS("http://www.w3.org/2000/svg","svg").createSVGRect,touch:"ontouchstart"in window||window.DocumentTouch&&document instanceof DocumentTouch||Me("windows phone")||window.navigator.maxTouchPoints>1||window.navigator.msMaxTouchPoints||!1,transformProperty:xe("transform"),transitionProperty:xe("transition"),webp:function(){const e=document.createElement("canvas");return!(!e.getContext||!e.getContext("2d"))&&0===e.toDataURL("image/webp").indexOf("data:image/webp")}(),windowsPhone:je,mediaCapabilities:"mediaCapabilities"in navigator,isGoogleBot:(()=>{const e=Le.toLowerCase();return Ce.some((t=>e.includes(t)))})(),isCrawler:(()=>{const e=Le.toLowerCase();return Ne.some((t=>e.includes(t)))})(),storageAccessAPI:"requestStorageAccess"in document&&"hasStorageAccess"in document,clipboardAPI:"clipboard"in navigator&&"write"in navigator.clipboard,videoContentPreload:!Me("iphone"),intersectionObserver:"IntersectionObserver"in window},Qe=e=>{ze.mse=e},Je=/mac os x 10_13/.test(Le),Ze=ze.iOS&&ze.iOS>=11,et="undefined"!=typeof matchMedia&&(matchMedia("(color-gamut: p3)").matches&&screen.pixelDepth>24||matchMedia("(dynamic-range: high), (video-dynamic-range: high)").matches);ze.hevc=function(e="hvc1"){return void 0!==j?j.isTypeSupported(`video/mp4; codecs="${e}"`):$e.hevc&&(Je||Ze)}("hvc1.2.4.H150.90"),ze.hdr=et,ze.dolbyVision=function(){const e='video/mp4; codecs="dvh1"';let t=void 0!==j&&j.isTypeSupported(e);if(!t){const n=document.createElement("video");"canPlayType"in n&&(t="probably"===n.canPlayType(e))}return!((We||ze.iOS)&&!$e.dolbyVision)&&t}(),ze.vp9hdr=(window.matchMedia("(color-gamut: p3)").matches||window.matchMedia("(color-gamut: rec2020)").matches)&&screen.colorDepth>=48&&(j.isTypeSupported('video/webm; codecs="vp09.02.10.10.01.09.16.09.00"')||j.isTypeSupported('video/webm; codecs="vp09.02.10.10.01.09.16.09.01"')||j.isTypeSupported('video/webm; codecs="vp09.02.10.10.01.09.18.09.00"')||j.isTypeSupported('video/webm; codecs="vp09.02.10.10.01.09.18.09.01"')),ze.av1=void 0!==j&&j.isTypeSupported('video/mp4; codecs="av01.0.31M.08.0.110.01.01.01.0"'),ze.webvr=!(!window.navigator||!("getVRDisplays"in window.navigator)),ze.webxr=!!(window.navigator&&"xr"in window.navigator&&"supportsSession"in window.navigator.xr),ze.spatialPlayback=!!ze.mse,ze.stereoscopic=ze.spatialPlayback&&ze.mobileAndroid,ze.fullscreenRequiresDataLoaded=ze.iOS>=17||ze.iPadOS&&$e.fullscreenRequiresDataLoaded;var tt=Array.isArray,nt="object"==typeof global&&global&&global.Object===Object&&global,rt="object"==typeof self&&self&&self.Object===Object&&self,it=nt||rt||Function("return this")(),ot=it.Symbol,st=Object.prototype,at=st.hasOwnProperty,ut=st.toString,ct=ot?ot.toStringTag:void 0,lt=Object.prototype.toString,dt=ot?ot.toStringTag:void 0;function ht(e){return null==e?void 0===e?"[object Undefined]":"[object Null]":dt&&dt in Object(e)?function(e){var t=at.call(e,ct),n=e[ct];try{e[ct]=void 0;var r=!0}catch(Rp){}var i=ut.call(e);return r&&(t?e[ct]=n:delete e[ct]),i}(e):function(e){return lt.call(e)}(e)}function ft(e){return null!=e&&"object"==typeof e}function pt(e){return"symbol"==typeof e||ft(e)&&"[object Symbol]"==ht(e)}var _t=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,mt=/^\w*$/;function vt(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)}function gt(e){if(!vt(e))return!1;var t=ht(e);return"[object Function]"==t||"[object GeneratorFunction]"==t||"[object AsyncFunction]"==t||"[object Proxy]"==t}var yt=it["__core-js_shared__"],Et=function(){var e=/[^.]+$/.exec(yt&&yt.keys&&yt.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}(),Tt=Function.prototype.toString;function St(e){if(null!=e){try{return Tt.call(e)}catch(Rp){}try{return e+""}catch(Rp){}}return""}var bt=/^\[object .+?Constructor\]$/,At=Function.prototype,wt=Object.prototype,It=At.toString,Rt=wt.hasOwnProperty,kt=RegExp("^"+It.call(Rt).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function Pt(e,t){var n=function(e,t){return null==e?void 0:e[t]}(e,t);return function(e){return!(!vt(e)||function(e){return!!Et&&Et in e}(e))&&(gt(e)?kt:bt).test(St(e))}(n)?n:void 0}var Dt=Pt(Object,"create"),Ot=Object.prototype.hasOwnProperty,Lt=Object.prototype.hasOwnProperty;function Ct(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}function Nt(e,t){return e===t||e!=e&&t!=t}function Mt(e,t){for(var n=e.length;n--;)if(Nt(e[n][0],t))return n;return-1}Ct.prototype.clear=function(){this.__data__=Dt?Dt(null):{},this.size=0},Ct.prototype.delete=function(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t},Ct.prototype.get=function(e){var t=this.__data__;if(Dt){var n=t[e];return"__lodash_hash_undefined__"===n?void 0:n}return Ot.call(t,e)?t[e]:void 0},Ct.prototype.has=function(e){var t=this.__data__;return Dt?void 0!==t[e]:Lt.call(t,e)},Ct.prototype.set=function(e,t){var n=this.__data__;return this.size+=this.has(e)?0:1,n[e]=Dt&&void 0===t?"__lodash_hash_undefined__":t,this};var xt=Array.prototype.splice;function Ut(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}Ut.prototype.clear=function(){this.__data__=[],this.size=0},Ut.prototype.delete=function(e){var t=this.__data__,n=Mt(t,e);return!(n<0||(n==t.length-1?t.pop():xt.call(t,n,1),--this.size,0))},Ut.prototype.get=function(e){var t=this.__data__,n=Mt(t,e);return n<0?void 0:t[n][1]},Ut.prototype.has=function(e){return Mt(this.__data__,e)>-1},Ut.prototype.set=function(e,t){var n=this.__data__,r=Mt(n,e);return r<0?(++this.size,n.push([e,t])):n[r][1]=t,this};var Ft=Pt(it,"Map");function jt(e,t){var n=e.__data__;return function(e){var t=typeof e;return"string"==t||"number"==t||"symbol"==t||"boolean"==t?"__proto__"!==e:null===e}(t)?n["string"==typeof t?"string":"hash"]:n.map}function Vt(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}function Bt(e,t){if("function"!=typeof e||null!=t&&"function"!=typeof t)throw new TypeError("Expected a function");var n=function n(){var r=arguments,i=t?t.apply(this,r):r[0],o=n.cache;if(o.has(i))return o.get(i);var s=e.apply(this,r);return n.cache=o.set(i,s)||o,s};return n.cache=new(Bt.Cache||Vt),n}Vt.prototype.clear=function(){this.size=0,this.__data__={hash:new Ct,map:new(Ft||Ut),string:new Ct}},Vt.prototype.delete=function(e){var t=jt(this,e).delete(e);return this.size-=t?1:0,t},Vt.prototype.get=function(e){return jt(this,e).get(e)},Vt.prototype.has=function(e){return jt(this,e).has(e)},Vt.prototype.set=function(e,t){var n=jt(this,e),r=n.size;return n.set(e,t),this.size+=n.size==r?0:1,this},Bt.Cache=Vt;var Ht=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,Xt=/\\(\\)?/g,Wt=function(){var e=Bt((function(e){var t=[];return 46===e.charCodeAt(0)&&t.push(""),e.replace(Ht,(function(e,n,r,i){t.push(r?i.replace(Xt,"$1"):n||e)})),t}),(function(e){return 500===t.size&&t.clear(),e})),t=e.cache;return e}(),qt=ot?ot.prototype:void 0,Gt=qt?qt.toString:void 0;function Kt(e){if("string"==typeof e)return e;if(tt(e))return function(e,t){for(var n=-1,r=null==e?0:e.length,i=Array(r);++n<r;)i[n]=t(e[n],n,e);return i}(e,Kt)+"";if(pt(e))return Gt?Gt.call(e):"";var t=e+"";return"0"==t&&1/e==-1/0?"-0":t}function Yt(e){return null==e?"":Kt(e)}function $t(e,t){return tt(e)?e:function(e,t){if(tt(e))return!1;var n=typeof e;return!("number"!=n&&"symbol"!=n&&"boolean"!=n&&null!=e&&!pt(e))||mt.test(e)||!_t.test(e)||null!=t&&e in Object(t)}(e,t)?[e]:Wt(Yt(e))}function zt(e){if("string"==typeof e||pt(e))return e;var t=e+"";return"0"==t&&1/e==-1/0?"-0":t}function Qt(e,t){for(var n=0,r=(t=$t(t,e)).length;null!=e&&n<r;)e=e[zt(t[n++])];return n&&n==r?e:void 0}function Jt(e,t,n){var r=null==e?void 0:Qt(e,t);return void 0===r?n:r}var Zt="object"==typeof global&&global&&global.Object===Object&&global,en="object"==typeof self&&self&&self.Object===Object&&self,tn=(Zt||en||Function("return this")()).Symbol,nn=Object.prototype,rn=nn.hasOwnProperty,on=nn.toString,sn=tn?tn.toStringTag:void 0,an=Object.prototype.toString,un=tn?tn.toStringTag:void 0;var cn=function(e,t){return function(n){return e(t(n))}}(Object.getPrototypeOf,Object),ln=Function.prototype,dn=Object.prototype,hn=ln.toString,fn=dn.hasOwnProperty,pn=hn.call(Object),_n=function(){var e,t=("undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof module?module:Function("return this")()).Symbol;return"function"==typeof t?t.observable?e=t.observable:(e=t("observable"),t.observable=e):e="@@observable",e}(),mn="@@redux/INIT";function vn(e,t,n){var r;if("function"==typeof t&&void 0===n&&(n=t,t=void 0),void 0!==n){if("function"!=typeof n)throw new Error("Expected the enhancer to be a function.");return n(vn)(e,t)}if("function"!=typeof e)throw new Error("Expected the reducer to be a function.");var i=e,o=t,s=[],a=s,u=!1;function c(){a===s&&(a=s.slice())}function l(){return o}function d(e){if("function"!=typeof e)throw new Error("Expected listener to be a function.");var t=!0;return c(),a.push(e),function(){if(t){t=!1,c();var n=a.indexOf(e);a.splice(n,1)}}}function h(e){if(!function(e){if(!function(e){return null!=e&&"object"==typeof e}(e)||"[object Object]"!=function(e){return null==e?void 0===e?"[object Undefined]":"[object Null]":un&&un in Object(e)?function(e){var t=rn.call(e,sn),n=e[sn];try{e[sn]=void 0;var r=!0}catch(Rp){}var i=on.call(e);return r&&(t?e[sn]=n:delete e[sn]),i}(e):function(e){return an.call(e)}(e)}(e))return!1;var t=cn(e);if(null===t)return!0;var n=fn.call(t,"constructor")&&t.constructor;return"function"==typeof n&&n instanceof n&&hn.call(n)==pn}(e))throw new Error("Actions must be plain objects. Use custom middleware for async actions.");if(void 0===e.type)throw new Error('Actions may not have an undefined "type" property. Have you misspelled a constant?');if(u)throw new Error("Reducers may not dispatch actions.");try{u=!0,o=i(o,e)}finally{u=!1}for(var t=s=a,n=0;n<t.length;n++)(0,t[n])();return e}return h({type:mn}),(r={dispatch:h,subscribe:d,getState:l,replaceReducer:function(e){if("function"!=typeof e)throw new Error("Expected the nextReducer to be a function.");i=e,h({type:mn})}})[_n]=function(){var e,t=d;return(e={subscribe:function(e){if("object"!=typeof e)throw new TypeError("Expected the observer to be an object.");function n(){e.next&&e.next(l())}return n(),{unsubscribe:t(n)}}})[_n]=function(){return this},e},r}function gn(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return 0===t.length?function(e){return e}:1===t.length?t[0]:t.reduce((function(e,t){return function(){return e(t.apply(void 0,arguments))}}))}var yn=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e};function En(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return function(e){return function(n,r,i){var o,s=e(n,r,i),a=s.dispatch,u={getState:s.getState,dispatch:function(e){return a(e)}};return o=t.map((function(e){return e(u)})),a=gn.apply(void 0,o)(s.dispatch),yn({},s,{dispatch:a})}}}var Tn=new WeakMap,Sn=new WeakMap;let bn=function(){function e(){s(this,Tn,Object.create(null)),s(this,Sn,void 0),h(this,"eventNames",(()=>Object.keys(o(Tn,this)))),h(this,"fire",((e,...t)=>{if(!e)throw new Error("Tried to fire an undefined event.");if(e in o(Tn,this)){const n=o(Tn,this)[e].slice(0);for(let e=0,r=n.length;e<r;e++)if(n[e].apply(this,t),o(Sn,this)){a(Sn,this,!1);break}}return this})),h(this,"halt",(()=>(a(Sn,this,!0),this))),h(this,"on",((e,t,n)=>{const r=[].concat(e);for(let i=0,s=r.length;i<s;i++){const e=r[i];if(!e)throw new Error("Tried to listen for an undefined event.");o(Tn,this)[e]||(o(Tn,this)[e]=[]),n?o(Tn,this)[e].unshift(t):o(Tn,this)[e].push(t)}return this})),h(this,"once",((e,t,n)=>{const r=(...n)=>{this.off(e,r),t.apply(this,n)};return r.handler=t,this.on(e,r,n)})),h(this,"off",((e,t)=>{if(!e)return a(Tn,this,Object.create(null)),this;const n=[].concat(e);for(let r=0,i=n.length;r<i;r++){const e=n[r];if(!e)throw new Error("Tried to remove an undefined event.");if(e in o(Tn,this)){const n=o(Tn,this)[e];if(t){let r=n.indexOf(t);if(-1===r)for(let e=0,i=n.length;e<i;e++)if(n[e].handler===t){r=e;break}if(-1===r)return this;n.splice(r,1),0===n.length&&delete o(Tn,this)[e]}else delete o(Tn,this)[e]}}return this})),h(this,"prependOn",((e,t)=>this.on(e,t,!0)))}return e.extend=function(t){return Object.assign(t,new e),t},e}();function An(e){var t=this.__data__=new Ut(e);this.size=t.size}An.prototype.clear=function(){this.__data__=new Ut,this.size=0},An.prototype.delete=function(e){var t=this.__data__,n=t.delete(e);return this.size=t.size,n},An.prototype.get=function(e){return this.__data__.get(e)},An.prototype.has=function(e){return this.__data__.has(e)},An.prototype.set=function(e,t){var n=this.__data__;if(n instanceof Ut){var r=n.__data__;if(!Ft||r.length<199)return r.push([e,t]),this.size=++n.size,this;n=this.__data__=new Vt(r)}return n.set(e,t),this.size=n.size,this};var wn=function(){try{var e=Pt(Object,"defineProperty");return e({},"",{}),e}catch(Rp){}}();function In(e,t,n){"__proto__"==t&&wn?wn(e,t,{configurable:!0,enumerable:!0,value:n,writable:!0}):e[t]=n}var Rn=Object.prototype.hasOwnProperty;function kn(e,t,n){var r=e[t];Rn.call(e,t)&&Nt(r,n)&&(void 0!==n||t in e)||In(e,t,n)}function Pn(e,t,n,r){var i=!n;n||(n={});for(var o=-1,s=t.length;++o<s;){var a=t[o],u=r?r(n[a],e[a],a,n,e):void 0;void 0===u&&(u=e[a]),i?In(n,a,u):kn(n,a,u)}return n}function Dn(e){return ft(e)&&"[object Arguments]"==ht(e)}var On=Object.prototype,Ln=On.hasOwnProperty,Cn=On.propertyIsEnumerable,Nn=Dn(function(){return arguments}())?Dn:function(e){return ft(e)&&Ln.call(e,"callee")&&!Cn.call(e,"callee")},Mn="object"==typeof exports&&exports&&!exports.nodeType&&exports,xn=Mn&&"object"==typeof module&&module&&!module.nodeType&&module,Un=xn&&xn.exports===Mn?it.Buffer:void 0,Fn=(Un?Un.isBuffer:void 0)||function(){return!1},jn=/^(?:0|[1-9]\d*)$/;function Vn(e,t){var n=typeof e;return!!(t=null==t?9007199254740991:t)&&("number"==n||"symbol"!=n&&jn.test(e))&&e>-1&&e%1==0&&e<t}function Bn(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=9007199254740991}var Hn={};function Xn(e){return function(t){return e(t)}}Hn["[object Float32Array]"]=Hn["[object Float64Array]"]=Hn["[object Int8Array]"]=Hn["[object Int16Array]"]=Hn["[object Int32Array]"]=Hn["[object Uint8Array]"]=Hn["[object Uint8ClampedArray]"]=Hn["[object Uint16Array]"]=Hn["[object Uint32Array]"]=!0,Hn["[object Arguments]"]=Hn["[object Array]"]=Hn["[object ArrayBuffer]"]=Hn["[object Boolean]"]=Hn["[object DataView]"]=Hn["[object Date]"]=Hn["[object Error]"]=Hn["[object Function]"]=Hn["[object Map]"]=Hn["[object Number]"]=Hn["[object Object]"]=Hn["[object RegExp]"]=Hn["[object Set]"]=Hn["[object String]"]=Hn["[object WeakMap]"]=!1;var Wn="object"==typeof exports&&exports&&!exports.nodeType&&exports,qn=Wn&&"object"==typeof module&&module&&!module.nodeType&&module,Gn=qn&&qn.exports===Wn&&nt.process,Kn=function(){try{return qn&&qn.require&&qn.require("util").types||Gn&&Gn.binding&&Gn.binding("util")}catch(Rp){}}(),Yn=Kn&&Kn.isTypedArray,$n=Yn?Xn(Yn):function(e){return ft(e)&&Bn(e.length)&&!!Hn[ht(e)]},zn=Object.prototype.hasOwnProperty;function Qn(e,t){var n=tt(e),r=!n&&Nn(e),i=!n&&!r&&Fn(e),o=!n&&!r&&!i&&$n(e),s=n||r||i||o,a=s?function(e,t){for(var n=-1,r=Array(e);++n<e;)r[n]=t(n);return r}(e.length,String):[],u=a.length;for(var c in e)!t&&!zn.call(e,c)||s&&("length"==c||i&&("offset"==c||"parent"==c)||o&&("buffer"==c||"byteLength"==c||"byteOffset"==c)||Vn(c,u))||a.push(c);return a}var Jn=Object.prototype;function Zn(e){var t=e&&e.constructor;return e===("function"==typeof t&&t.prototype||Jn)}function er(e,t){return function(n){return e(t(n))}}var tr=er(Object.keys,Object),nr=Object.prototype.hasOwnProperty;function rr(e){if(!Zn(e))return tr(e);var t=[];for(var n in Object(e))nr.call(e,n)&&"constructor"!=n&&t.push(n);return t}function ir(e){return null!=e&&Bn(e.length)&&!gt(e)}function or(e){return ir(e)?Qn(e):rr(e)}var sr=Object.prototype.hasOwnProperty;function ar(e){return ir(e)?Qn(e,!0):function(e){if(!vt(e))return function(e){var t=[];if(null!=e)for(var n in Object(e))t.push(n);return t}(e);var t=Zn(e),n=[];for(var r in e)("constructor"!=r||!t&&sr.call(e,r))&&n.push(r);return n}(e)}var ur="object"==typeof exports&&exports&&!exports.nodeType&&exports,cr=ur&&"object"==typeof module&&module&&!module.nodeType&&module,lr=cr&&cr.exports===ur?it.Buffer:void 0,dr=lr?lr.allocUnsafe:void 0;function hr(e,t){if(t)return e.slice();var n=e.length,r=dr?dr(n):new e.constructor(n);return e.copy(r),r}function fr(e,t){var n=-1,r=e.length;for(t||(t=Array(r));++n<r;)t[n]=e[n];return t}function pr(){return[]}var _r=Object.prototype.propertyIsEnumerable,mr=Object.getOwnPropertySymbols,vr=mr?function(e){return null==e?[]:(e=Object(e),function(e,t){for(var n=-1,r=null==e?0:e.length,i=0,o=[];++n<r;){var s=e[n];t(s)&&(o[i++]=s)}return o}(mr(e),(function(t){return _r.call(e,t)})))}:pr;function gr(e,t){for(var n=-1,r=t.length,i=e.length;++n<r;)e[i+n]=t[n];return e}var yr=er(Object.getPrototypeOf,Object),Er=Object.getOwnPropertySymbols?function(e){for(var t=[];e;)gr(t,vr(e)),e=yr(e);return t}:pr;function Tr(e,t,n){var r=t(e);return tt(e)?r:gr(r,n(e))}function Sr(e){return Tr(e,or,vr)}function br(e){return Tr(e,ar,Er)}var Ar=Pt(it,"DataView"),wr=Pt(it,"Promise"),Ir=Pt(it,"Set"),Rr=Pt(it,"WeakMap"),kr="[object Map]",Pr="[object Promise]",Dr="[object Set]",Or="[object WeakMap]",Lr="[object DataView]",Cr=St(Ar),Nr=St(Ft),Mr=St(wr),xr=St(Ir),Ur=St(Rr),Fr=ht;(Ar&&Fr(new Ar(new ArrayBuffer(1)))!=Lr||Ft&&Fr(new Ft)!=kr||wr&&Fr(wr.resolve())!=Pr||Ir&&Fr(new Ir)!=Dr||Rr&&Fr(new Rr)!=Or)&&(Fr=function(e){var t=ht(e),n="[object Object]"==t?e.constructor:void 0,r=n?St(n):"";if(r)switch(r){case Cr:return Lr;case Nr:return kr;case Mr:return Pr;case xr:return Dr;case Ur:return Or}return t});var jr=Fr,Vr=Object.prototype.hasOwnProperty,Br=it.Uint8Array;function Hr(e){var t=new e.constructor(e.byteLength);return new Br(t).set(new Br(e)),t}var Xr=/\w*$/,Wr=ot?ot.prototype:void 0,qr=Wr?Wr.valueOf:void 0;function Gr(e,t){var n=t?Hr(e.buffer):e.buffer;return new e.constructor(n,e.byteOffset,e.length)}var Kr=Object.create,Yr=function(){function e(){}return function(t){if(!vt(t))return{};if(Kr)return Kr(t);e.prototype=t;var n=new e;return e.prototype=void 0,n}}();function $r(e){return"function"!=typeof e.constructor||Zn(e)?{}:Yr(yr(e))}var zr=Kn&&Kn.isMap,Qr=zr?Xn(zr):function(e){return ft(e)&&"[object Map]"==jr(e)},Jr=Kn&&Kn.isSet,Zr=Jr?Xn(Jr):function(e){return ft(e)&&"[object Set]"==jr(e)},ei="[object Arguments]",ti="[object Function]",ni="[object Object]",ri={};function ii(e,t,n,r,i,o){var s,a=1&t,u=2&t,c=4&t;if(n&&(s=i?n(e,r,i,o):n(e)),void 0!==s)return s;if(!vt(e))return e;var l=tt(e);if(l){if(s=function(e){var t=e.length,n=new e.constructor(t);return t&&"string"==typeof e[0]&&Vr.call(e,"index")&&(n.index=e.index,n.input=e.input),n}(e),!a)return fr(e,s)}else{var d=jr(e),h=d==ti||"[object GeneratorFunction]"==d;if(Fn(e))return hr(e,a);if(d==ni||d==ei||h&&!i){if(s=u||h?{}:$r(e),!a)return u?function(e,t){return Pn(e,Er(e),t)}(e,function(e,t){return e&&Pn(t,ar(t),e)}(s,e)):function(e,t){return Pn(e,vr(e),t)}(e,function(e,t){return e&&Pn(t,or(t),e)}(s,e))}else{if(!ri[d])return i?e:{};s=function(e,t,n){var r=e.constructor;switch(t){case"[object ArrayBuffer]":return Hr(e);case"[object Boolean]":case"[object Date]":return new r(+e);case"[object DataView]":return function(e,t){var n=t?Hr(e.buffer):e.buffer;return new e.constructor(n,e.byteOffset,e.byteLength)}(e,n);case"[object Float32Array]":case"[object Float64Array]":case"[object Int8Array]":case"[object Int16Array]":case"[object Int32Array]":case"[object Uint8Array]":case"[object Uint8ClampedArray]":case"[object Uint16Array]":case"[object Uint32Array]":return Gr(e,n);case"[object Map]":case"[object Set]":return new r;case"[object Number]":case"[object String]":return new r(e);case"[object RegExp]":return function(e){var t=new e.constructor(e.source,Xr.exec(e));return t.lastIndex=e.lastIndex,t}(e);case"[object Symbol]":return function(e){return qr?Object(qr.call(e)):{}}(e)}}(e,d,a)}}o||(o=new An);var f=o.get(e);if(f)return f;o.set(e,s),Zr(e)?e.forEach((function(r){s.add(ii(r,t,n,r,e,o))})):Qr(e)&&e.forEach((function(r,i){s.set(i,ii(r,t,n,i,e,o))}));var p=l?void 0:(c?u?br:Sr:u?ar:or)(e);return function(e,t){for(var n=-1,r=null==e?0:e.length;++n<r&&!1!==t(e[n],n););}(p||e,(function(r,i){p&&(r=e[i=r]),kn(s,i,ii(r,t,n,i,e,o))})),s}function oi(e){return ii(e,5)}function si(e,t,n){switch(n.length){case 0:return e.call(t);case 1:return e.call(t,n[0]);case 2:return e.call(t,n[0],n[1]);case 3:return e.call(t,n[0],n[1],n[2])}return e.apply(t,n)}function ai(e){return e}ri[ei]=ri["[object Array]"]=ri["[object ArrayBuffer]"]=ri["[object DataView]"]=ri["[object Boolean]"]=ri["[object Date]"]=ri["[object Float32Array]"]=ri["[object Float64Array]"]=ri["[object Int8Array]"]=ri["[object Int16Array]"]=ri["[object Int32Array]"]=ri["[object Map]"]=ri["[object Number]"]=ri[ni]=ri["[object RegExp]"]=ri["[object Set]"]=ri["[object String]"]=ri["[object Symbol]"]=ri["[object Uint8Array]"]=ri["[object Uint8ClampedArray]"]=ri["[object Uint16Array]"]=ri["[object Uint32Array]"]=!0,ri["[object Error]"]=ri[ti]=ri["[object WeakMap]"]=!1;var ui=Math.max;function ci(e,t,n){return t=ui(void 0===t?e.length-1:t,0),function(){for(var r=arguments,i=-1,o=ui(r.length-t,0),s=Array(o);++i<o;)s[i]=r[t+i];i=-1;for(var a=Array(t+1);++i<t;)a[i]=r[i];return a[t]=n(s),si(e,this,a)}}function li(e){return function(){return e}}var di=wn?function(e,t){return wn(e,"toString",{configurable:!0,enumerable:!1,value:li(t),writable:!0})}:ai,hi=Date.now,fi=function(e){var t=0,n=0;return function(){var r=hi(),i=16-(r-n);if(n=r,i>0){if(++t>=800)return arguments[0]}else t=0;return e.apply(void 0,arguments)}}(di);function pi(e,t){return fi(ci(e,t,ai),e+"")}function _i(e,t,n){(void 0!==n&&!Nt(e[t],n)||void 0===n&&!(t in e))&&In(e,t,n)}var mi=function(e,t,n){for(var r=-1,i=Object(e),o=n(e),s=o.length;s--;){var a=o[++r];if(!1===t(i[a],a,i))break}return e},vi=Function.prototype,gi=Object.prototype,yi=vi.toString,Ei=gi.hasOwnProperty,Ti=yi.call(Object);function Si(e){if(!ft(e)||"[object Object]"!=ht(e))return!1;var t=yr(e);if(null===t)return!0;var n=Ei.call(t,"constructor")&&t.constructor;return"function"==typeof n&&n instanceof n&&yi.call(n)==Ti}function bi(e,t){if(("constructor"!==t||"function"!=typeof e[t])&&"__proto__"!=t)return e[t]}function Ai(e,t,n,r,i){e!==t&&mi(t,(function(o,s){if(i||(i=new An),vt(o))!function(e,t,n,r,i,o,s){var a=bi(e,n),u=bi(t,n),c=s.get(u);if(c)_i(e,n,c);else{var l=o?o(a,u,n+"",e,t,s):void 0,d=void 0===l;if(d){var h=tt(u),f=!h&&Fn(u),p=!h&&!f&&$n(u);l=u,h||f||p?tt(a)?l=a:function(e){return ft(e)&&ir(e)}(a)?l=fr(a):f?(d=!1,l=hr(u,!0)):p?(d=!1,l=Gr(u,!0)):l=[]:Si(u)||Nn(u)?(l=a,Nn(a)?l=function(e){return Pn(e,ar(e))}(a):vt(a)&&!gt(a)||(l=$r(u))):d=!1}d&&(s.set(u,l),i(l,u,r,o,s),s.delete(u)),_i(e,n,l)}}(e,t,s,n,Ai,r,i);else{var a=r?r(bi(e,s),o,s+"",e,t,i):void 0;void 0===a&&(a=o),_i(e,s,a)}}),ar)}function wi(e,t,n,r,i,o){return vt(e)&&vt(t)&&(o.set(t,e),Ai(e,t,void 0,wi,o),o.delete(t)),e}function Ii(e){return pi((function(t,n){var r=-1,i=n.length,o=i>1?n[i-1]:void 0,s=i>2?n[2]:void 0;for(o=e.length>3&&"function"==typeof o?(i--,o):void 0,s&&function(e,t,n){if(!vt(n))return!1;var r=typeof t;return!!("number"==r?ir(n)&&Vn(t,n.length):"string"==r&&t in n)&&Nt(n[t],e)}(n[0],n[1],s)&&(o=i<3?void 0:o,i=1),t=Object(t);++r<i;){var a=n[r];a&&e(t,a,r,o)}return t}))}var Ri=Ii((function(e,t,n,r){Ai(e,t,n,r)})),ki=pi((function(e){return e.push(void 0,wi),si(Ri,void 0,e)}));let Pi=function(e){function t(t){var n;return(n=e.call(this)||this)._available=!1,n._active=!1,n._video=t,n}p(t,e);var n=t.prototype;return n.showPicker=function(){},n.getFile=function(){const e=this.constructor.displayName.replace("ExternalDisplay","");if(this._video.externalDisplayFiles[e])return this._video.externalDisplayFiles[e];const t=this.constructor.supportedVideoTypes,n=this._video.files.filter((e=>-1!==t.indexOf(e.mime))).sort(((e,n)=>e.mime===n.mime?e.priority-n.priority:t.indexOf(e.mime)-t.indexOf(n.mime)));if(!n.length)throw new Error(`No files available for ${this.constructor.displayName} external display.`);return n[0]},l(t,[{key:"active",get:function(){return this._active}},{key:"available",get:function(){return this._available}},{key:"element",get:function(){return document.createElement("div")}}],[{key:"displayName",get:function(){return"ExternalDisplay"}},{key:"supported",get:function(){return!1}},{key:"supportedVideoTypes",get:function(){return[]}}])}(bn);const Di={ABORT:"abort",CAN_PLAY:"canplay",CAN_PLAY_THROUGH:"canplaythrough",DURATION_CHANGE:"durationchange",EMPTIED:"emptied",ENDED:"ended",ENTER_PICTURE_IN_PICTURE:"enterpictureinpicture",LEAVE_PICTURE_IN_PICTURE:"leavepictureinpicture",ERROR:"error",LOADED_DATA:"loadeddata",LOADED_METADATA:"loadedmetadata",LOAD_START:"loadstart",PAUSE:"pause",PLAY:"play",PLAYING:"playing",PROGRESS:"progress",RATE_CHANGE:"ratechange",RESIZE:"resize",SEEKED:"seeked",SEEKING:"seeking",STALLED:"stalled",SUSPEND:"suspend",TIME_UPDATE:"timeupdate",VOLUME_CHANGE:"volumechange",WAITING:"waiting",WEBKIT_BEGIN_FULLSCREEN:"webkitbeginfullscreen",WEBKIT_END_FULLSCREEN:"webkitendfullscreen",WEBKIT_PRESENTATION_MODE_CHANGED:"webkitpresentationmodechanged"},Oi={ADD_TRACK:"addtrack",REMOVE_TRACK:"removetrack",CHANGE:"change"},Li={AVAILABLE:"externaldisplayavailable",UNAVAILABLE:"externaldisplayunavailable",ACTIVATED:"externaldisplayactivated",DEACTIVATED:"externaldisplaydeactivated"},Ci={AIRPLAY_AVAILABLE:"available",AIRPLAY_UNAVAILABLE:"unavailable",AIRPLAY_ACTIVATED:"activated",AIRPLAY_DEACTIVATED:"deactivated"},Ni={SCANNER_CHANGE:"scannerchange",SCANNER_ERROR:"scannererror",FILE_ERROR:"fileerror",FILE_SRC_UPDATE:"filesrcupdate",DOWNLOAD_START:"downloadstart",DOWNLOAD_END:"downloadend",DOWNLOAD_ERROR:"downloaderror",DOWNLOAD_TIMEOUT:"downloadtimeout",DRM_AUTH_FAILURE:"drmauthfailure",DRM_AUTH_SUCCESS:"drmauthsuccess",DRM_FAILURE:"drmfailure",DRM_KEY_SWITCH:"drmkeyswitch",DRM_OUTPUT_RESTRICTED:"drmoutputrestricted",EME_UNSUPPORTED:"emeunsupported",CURRENT_FILE_CHANGE:"currentfilechange",MEDIA_URL_EXPIRED:"mediaurlexpired",MEDIA_URL_BAD_REQUEST:"mediaurlbadrequest",STREAM_CHANGE:"streamchange",STREAM_CHANGE_START:"streamchangestart",STREAM_UPDATED:"streamupdated",STREAM_BUFFER_START:"streambufferstart",STREAM_BUFFER_END:"streambufferend",AVAILABLE_STREAMS_CHANGED:"availablestreamschanged",MEDIA_CAPABILITY_STREAMS_UNSUPPORTED:"mediacapabilitystreamsunsupported",DROPPED_FRAMES:"droppedframes",BANDWIDTH:"bandwidth",STREAM_TARGET_CHANGE:"streamtargetchange",CUE_POINT:"cuepoint",BUFFER_OCCUPANCY:"bufferoccupancy",MANIFEST_TIMEOUT:"manifesttimeout",MANIFEST_LOADED:"manifestloaded",STREAMS_LOADED:"streamsloaded",TEXT_SRC_UPDATE:"texttracksrcupdate",TEXT_TRACKS_AVAILABLE:"texttracksavailable",AV_DURATION_MISMATCH:"avdurationmismatch",BUFFER_STARTED:"bufferstarted",BUFFER_ENDED:"bufferended",QUOTA_EXCEEDED_ERROR:"quotaexceedederror",CHAPTER_CUES_UPDATED:"chaptercuesupdated",APPEND_BUFFER_END:"appendbufferend",DROPPED_FRAME_PERCENT_EXCEEDED:"droppedframepercentexceeded",LOAD_SEGMENT_FAILED:"loadsegmentfailed",AUDIO_TRACK_CHANGED:"audiotrackchanged",SEGMENT_CUES_LOADED:"segmentcuesloaded"},Mi={STREAM_ONLINE:"livestreamonline",STREAM_OFFLINE:"livestreamoffline",BUFFER_GAP_JUMP:"livebuffergapjump",BUFFER_GAP_JUMP_PREVENT:"livebuffergapjumpprevent",STALL_JUMP:"livestalljump",LATENCY_UPDATED:"latencyupdated"},xi={CAMERA_UPDATE:"cameraupdate",CAMERA_CHANGE:"camerachange",MOTION_START:"motionstart",MOTION_END:"motionend",SPATIAL_UNSUPPORTED:"spatialunsupported",WEBVR_ENTER:"entervr",WEBVR_EXIT:"exitvr",WEBVR_HARDWARE_AVAILABLE:"webvrhardwareavailable",AMBISONIC_UNSUPPORTED:"ambisonicunsupported"},Ui={MEDIASESSION_PLAY:"mediasessionplay",MEDIASESSION_PAUSE:"mediasessionpause",MEDIASESSION_SEEK_FORWARD:"mediasessionseekforward",MEDIASESSION_SEEK_TO:"mediasessionseekto",MEDIASESSION_SEEK_BACKWARD:"mediasessionseekbackward"},Fi=Object.assign({},Di,Oi,Li,Ci,Ni,xi,Mi,Ui);var ji="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function Vi(e,t,n){return e(n={path:t,exports:{},require:function(e,t){return function(){throw new Error("Dynamic requires are not currently supported by @rollup/plugin-commonjs")}(null==t&&n.path)}},n.exports),n.exports}var Bi=Vi((function(e,t){
/*! For license information please see hls-parser.min.js.LICENSE.txt */
self,e.exports=function(){return e={851:(e,t,n)=>{var r=n(771),i=r.getOptions,o=r.setOptions,s=n(463),a=n(367),u=n(890);e.exports={parse:s,stringify:a,types:u,getOptions:i,setOptions:o}},463:(e,t,n)=>{function r(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=o(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var s,a=!0,u=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return a=e.done,e},e:function(e){u=!0,s=e},f:function(){try{a||null==n.return||n.return()}finally{if(u)throw s}}}}function i(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e)){var n=[],r=!0,i=!1,o=void 0;try{for(var s,a=e[Symbol.iterator]();!(r=(s=a.next()).done)&&(n.push(s.value),!t||n.length!==t);r=!0);}catch(e){i=!0,o=e}finally{try{r||null==a.return||a.return()}finally{if(i)throw o}}return n}}(e,t)||o(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function o(e,t){if(e){if("string"==typeof e)return s(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?s(e,t):void 0}}function s(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var a=n(771),u=n(890),c=u.Rendition,l=u.Variant,d=u.SessionData,h=u.Key,f=u.MediaInitializationSection,p=u.DateRange,_=u.SpliceInfo,m=u.MasterPlaylist,v=u.MediaPlaylist,g=u.Segment,y=u.PartialSegment,E=u.RenditionReport;function T(e){return a.trim(e,'"')}function S(e){var t=a.splitAt(e,",");return{duration:a.toNumber(t[0]),title:decodeURIComponent(escape(t[1]))}}function b(e){var t=a.splitAt(e,"@");return{length:a.toNumber(t[0]),offset:t[1]?a.toNumber(t[1]):-1}}function A(e,t){t.IV&&e.compatibleVersion<2&&(e.compatibleVersion=2),(t.KEYFORMAT||t.KEYFORMATVERSIONS)&&e.compatibleVersion<5&&(e.compatibleVersion=5)}function w(e){var t=a.splitByCommaWithPreservingQuotes(e),n={};return t.forEach((function(e){var t,r,o=i(a.splitAt(e,"="),2),s=o[0],u=o[1],c=T(u);switch(s){case"URI":n[s]=c;break;case"START-DATE":case"END-DATE":n[s]=new Date(c);break;case"IV":n[s]=(t=c,16!==(r=a.hexToByteSequence(t)).length&&a.INVALIDPLAYLIST("IV must be a 128-bit unsigned integer"),r);break;case"BYTERANGE":n[s]=b(c);break;case"RESOLUTION":n[s]=function(e){var t=a.splitAt(e,"x");return{width:a.toNumber(t[0]),height:a.toNumber(t[1])}}(c);break;case"END-ON-NEXT":case"DEFAULT":case"AUTOSELECT":case"FORCED":case"PRECISE":case"CAN-BLOCK-RELOAD":case"INDEPENDENT":case"GAP":n[s]="YES"===c;break;case"DURATION":case"PLANNED-DURATION":case"BANDWIDTH":case"AVERAGE-BANDWIDTH":case"FRAME-RATE":case"TIME-OFFSET":case"CAN-SKIP-UNTIL":case"HOLD-BACK":case"PART-HOLD-BACK":case"PART-TARGET":case"BYTERANGE-START":case"BYTERANGE-LENGTH":case"LAST-MSN":case"LAST-PART":case"SKIPPED-SEGMENTS":n[s]=a.toNumber(c);break;default:s.startsWith("SCTE35-")?n[s]=a.hexToByteSequence(c):s.startsWith("X-")?n[s]=function(e){return e.startsWith('"')?T(e):e.startsWith("0x")||e.startsWith("0X")?a.hexToByteSequence(e):a.toNumber(e)}(u):n[s]=c}})),n}function I(){a.INVALIDPLAYLIST("The file contains both media and master playlist tags.")}function R(e,t,n){var i,o=(i=t.attributes,new c({type:i.TYPE,uri:i.URI,groupId:i["GROUP-ID"],language:i.LANGUAGE,assocLanguage:i["ASSOC-LANGUAGE"],name:i.NAME,isDefault:i.DEFAULT,autoselect:i.AUTOSELECT,forced:i.FORCED,instreamId:i["INSTREAM-ID"],characteristics:i.CHARACTERISTICS,channels:i.CHANNELS})),s=e[a.camelify(n)],u=function(e,t){var n,i=!1,o=r(e);try{for(o.s();!(n=o.n()).done;){var s=n.value;if(s.name===t.name)return"All EXT-X-MEDIA tags in the same Group MUST have different NAME attributes.";s.isDefault&&(i=!0)}}catch(e){o.e(e)}finally{o.f()}return i&&t.isDefault?"EXT-X-MEDIA A Group MUST NOT have more than one member with a DEFAULT attribute of YES.":""}(s,o);u&&a.INVALIDPLAYLIST(u),s.push(o),o.isDefault&&(e.currentRenditions[a.camelify(n)]=s.length-1)}function k(e,t,n,i,o){var s,u=new l({uri:n,bandwidth:t.BANDWIDTH,averageBandwidth:t["AVERAGE-BANDWIDTH"],codecs:t.CODECS,resolution:t.RESOLUTION,frameRate:t["FRAME-RATE"],hdcpLevel:t["HDCP-LEVEL"]}),c=r(e);try{for(c.s();!(s=c.n()).done;){var d=s.value;if("EXT-X-MEDIA"===d.name){var h=d.attributes,f=h.TYPE;if(f&&h["GROUP-ID"]||a.INVALIDPLAYLIST("EXT-X-MEDIA TYPE attribute is REQUIRED."),t[f]===h["GROUP-ID"]&&(R(u,d,f),"CLOSED-CAPTIONS"===f)){var p,_=r(u.closedCaptions);try{for(_.s();!(p=_.n()).done;){var m=p.value.instreamId;if(m&&m.startsWith("SERVICE")&&o.compatibleVersion<7){o.compatibleVersion=7;break}}}catch(e){_.e(e)}finally{_.f()}}}}}catch(e){c.e(e)}finally{c.f()}return function(e,t,n){["AUDIO","VIDEO","SUBTITLES","CLOSED-CAPTIONS"].forEach((function(r){"CLOSED-CAPTIONS"===r&&"NONE"===e[r]?(n.isClosedCaptionsNone=!0,t.closedCaptions=[]):e[r]&&!t[a.camelify(r)].find((function(t){return t.groupId===e[r]}))&&a.INVALIDPLAYLIST("".concat(r," attribute MUST match the value of the GROUP-ID attribute of an EXT-X-MEDIA tag whose TYPE attribute is ").concat(r,"."))}))}(t,u,o),u.isIFrameOnly=i,u}function P(e,t){if(e.method!==t.method)return!1;if(e.uri!==t.uri)return!1;if(e.iv){if(!t.iv)return!1;if(e.iv.length!==t.iv.length)return!1;for(var n=0;n<e.iv.length;n++)if(e.iv[n]!==t.iv[n])return!1}else if(t.iv)return!1;return e.format===t.format&&e.formatVersion===t.formatVersion}function D(e,t,n,r,i,o,s){for(var u=new g({uri:t,mediaSequenceNumber:i,discontinuitySequence:o}),c=!1,l=!1,d=function(t){var n=e[t],r=n.name,i=n.value,o=n.attributes;if("EXTINF"===r)!Number.isInteger(i.duration)&&s.compatibleVersion<3&&(s.compatibleVersion=3),Math.round(i.duration)>s.targetDuration&&a.INVALIDPLAYLIST("EXTINF duration, when rounded to the nearest integer, MUST be less than or equal to the target duration"),u.duration=i.duration,u.title=i.title;else if("EXT-X-BYTERANGE"===r)s.compatibleVersion<4&&(s.compatibleVersion=4),u.byterange=i;else if("EXT-X-DISCONTINUITY"===r)u.parts.length>0&&a.INVALIDPLAYLIST("EXT-X-DISCONTINUITY must appear before the first EXT-X-PART tag of the Parent Segment."),u.discontinuity=!0;else if("EXT-X-KEY"===r)u.parts.length>0&&a.INVALIDPLAYLIST("EXT-X-KEY must appear before the first EXT-X-PART tag of the Parent Segment."),A(s,o),u.key=new h({method:o.METHOD,uri:o.URI,iv:o.IV,format:o.KEYFORMAT,formatVersion:o.KEYFORMATVERSIONS});else if("EXT-X-MAP"===r)u.parts.length>0&&a.INVALIDPLAYLIST("EXT-X-MAP must appear before the first EXT-X-PART tag of the Parent Segment."),s.compatibleVersion<5&&(s.compatibleVersion=5),s.hasMap=!0,u.map=new f({uri:o.URI,byterange:o.BYTERANGE});else if("EXT-X-PROGRAM-DATE-TIME"===r)u.programDateTime=i;else if("EXT-X-DATERANGE"===r){var d={};Object.keys(o).forEach((function(e){(e.startsWith("SCTE35-")||e.startsWith("X-"))&&(d[e]=o[e])})),u.dateRange=new p({id:o.ID,classId:o.CLASS,start:o["START-DATE"],end:o["END-DATE"],duration:o.DURATION,plannedDuration:o["PLANNED-DURATION"],endOnNext:o["END-ON-NEXT"],attributes:d})}else if("EXT-X-CUE-OUT"===r)u.markers.push(new _({type:"OUT",duration:i}));else if("EXT-X-CUE-IN"===r)u.markers.push(new _({type:"IN"}));else if("EXT-X-CUE-OUT-CONT"===r||"EXT-X-CUE"===r||"EXT-OATCLS-SCTE35"===r||"EXT-X-ASSET"===r||"EXT-X-SCTE35"===r)u.markers.push(new _({type:"RAW",tagName:r,value:i}));else if("EXT-X-PRELOAD-HINT"!==r||o.TYPE)if("EXT-X-PRELOAD-HINT"===r&&"PART"===o.TYPE&&l)a.INVALIDPLAYLIST("Servers should not add more than one EXT-X-PRELOAD-HINT tag with the same TYPE attribute to a Playlist.");else if("EXT-X-PART"!==r&&"EXT-X-PRELOAD-HINT"!==r||o.URI){if("EXT-X-PRELOAD-HINT"===r&&"MAP"===o.TYPE)c&&a.INVALIDPLAYLIST("Servers should not add more than one EXT-X-PRELOAD-HINT tag with the same TYPE attribute to a Playlist."),c=!0,s.hasMap=!0,u.map=new f({hint:!0,uri:o.URI,byterange:{length:o["BYTERANGE-LENGTH"],offset:o["BYTERANGE-START"]||0}});else if("EXT-X-PART"===r||"EXT-X-PRELOAD-HINT"===r&&"PART"===o.TYPE){"EXT-X-PART"!==r||o.DURATION||a.INVALIDPLAYLIST("EXT-X-PART: DURATION attribute is mandatory"),"EXT-X-PRELOAD-HINT"===r&&(l=!0);var m=new y({hint:"EXT-X-PRELOAD-HINT"===r,uri:o.URI,byterange:"EXT-X-PART"===r?o.BYTERANGE:{length:o["BYTERANGE-LENGTH"],offset:o["BYTERANGE-START"]||0},duration:o.DURATION,independent:o.INDEPENDENT,gap:o.GAP});u.parts.push(m)}}else a.INVALIDPLAYLIST("EXT-X-PART / EXT-X-PRELOAD-HINT: URI attribute is mandatory");else a.INVALIDPLAYLIST("EXT-X-PRELOAD-HINT: TYPE attribute is mandatory")},m=n;m<=r;m++)d(m);return u}function O(e,t,n,r,i){var o=t.discontinuity,s=t.key,u=t.map,c=t.byterange,l=t.uri;if(o&&(t.discontinuitySequence=n+1),s||(t.key=r),u||(t.map=i),c&&-1===c.offset){var d=e.segments;if(d.length>0){var h=d[d.length-1];h.byterange&&h.uri===l?c.offset=h.byterange.offset+h.byterange.length:a.INVALIDPLAYLIST("If offset of EXT-X-BYTERANGE is not present, a previous Media Segment MUST be a sub-range of the same media resource")}else a.INVALIDPLAYLIST("If offset of EXT-X-BYTERANGE is not present, a previous Media Segment MUST appear in the Playlist file")}return e.segments.push(t),[t.discontinuitySequence,t.key,t.map]}function L(e,t){var n=i(function(e){var t=e.indexOf(":");return-1===t?[e.slice(1).trim(),null]:[e.slice(1,t).trim(),e.slice(t+1).trim()]}(e),2),r=n[0],o=n[1],s=function(e){switch(e){case"EXTM3U":case"EXT-X-VERSION":return"Basic";case"EXTINF":case"EXT-X-BYTERANGE":case"EXT-X-DISCONTINUITY":case"EXT-X-KEY":case"EXT-X-MAP":case"EXT-X-PROGRAM-DATE-TIME":case"EXT-X-DATERANGE":case"EXT-X-CUE-OUT":case"EXT-X-CUE-IN":case"EXT-X-CUE-OUT-CONT":case"EXT-X-CUE":case"EXT-OATCLS-SCTE35":case"EXT-X-ASSET":case"EXT-X-SCTE35":case"EXT-X-PART":case"EXT-X-PRELOAD-HINT":return"Segment";case"EXT-X-TARGETDURATION":case"EXT-X-MEDIA-SEQUENCE":case"EXT-X-DISCONTINUITY-SEQUENCE":case"EXT-X-ENDLIST":case"EXT-X-PLAYLIST-TYPE":case"EXT-X-I-FRAMES-ONLY":case"EXT-X-SERVER-CONTROL":case"EXT-X-PART-INF":case"EXT-X-RENDITION-REPORT":case"EXT-X-SKIP":return"MediaPlaylist";case"EXT-X-MEDIA":case"EXT-X-STREAM-INF":case"EXT-X-I-FRAME-STREAM-INF":case"EXT-X-SESSION-DATA":case"EXT-X-SESSION-KEY":return"MasterPlaylist";case"EXT-X-INDEPENDENT-SEGMENTS":case"EXT-X-START":return"MediaorMasterPlaylist";default:return"Unknown"}}(r);if(function(e,t){if("Segment"===e||"MediaPlaylist"===e)return void 0===t.isMasterPlaylist?void(t.isMasterPlaylist=!1):void(t.isMasterPlaylist&&I());if("MasterPlaylist"===e){if(void 0===t.isMasterPlaylist)return void(t.isMasterPlaylist=!0);!1===t.isMasterPlaylist&&I()}}(s,t),"Unknown"===s)return null;"MediaPlaylist"===s&&"EXT-X-RENDITION-REPORT"!==r&&(t.hash[r]&&a.INVALIDPLAYLIST("There MUST NOT be more than one Media Playlist tag of each type in any Media Playlist"),t.hash[r]=!0);var u=i(function(e,t){switch(e){case"EXTM3U":case"EXT-X-DISCONTINUITY":case"EXT-X-ENDLIST":case"EXT-X-I-FRAMES-ONLY":case"EXT-X-INDEPENDENT-SEGMENTS":case"EXT-X-CUE-IN":return[null,null];case"EXT-X-VERSION":case"EXT-X-TARGETDURATION":case"EXT-X-MEDIA-SEQUENCE":case"EXT-X-DISCONTINUITY-SEQUENCE":case"EXT-X-CUE-OUT":return[a.toNumber(t),null];case"EXT-X-KEY":case"EXT-X-MAP":case"EXT-X-DATERANGE":case"EXT-X-MEDIA":case"EXT-X-STREAM-INF":case"EXT-X-I-FRAME-STREAM-INF":case"EXT-X-SESSION-DATA":case"EXT-X-SESSION-KEY":case"EXT-X-START":case"EXT-X-SERVER-CONTROL":case"EXT-X-PART-INF":case"EXT-X-PART":case"EXT-X-PRELOAD-HINT":case"EXT-X-RENDITION-REPORT":case"EXT-X-SKIP":return[null,w(t)];case"EXTINF":return[S(t),null];case"EXT-X-BYTERANGE":return[b(t),null];case"EXT-X-PROGRAM-DATE-TIME":return[new Date(t),null];default:return[t,null]}}(r,o),2);return{name:r,category:s,value:u[0],attributes:u[1]}}function C(e,t){var n;return t.isMasterPlaylist?n=function(e,t){var n,o=new m,s=r(e.entries());try{for(s.s();!(n=s.n()).done;){var u=i(n.value,2),c=u[0],l=u[1],f=l.name,p=l.value,_=l.attributes;if("EXT-X-VERSION"===f)o.version=p;else if("EXT-X-STREAM-INF"===f){var v=e[c+1];("string"!=typeof v||v.startsWith("#EXT"))&&a.INVALIDPLAYLIST("EXT-X-STREAM-INF must be followed by a URI line");var g=k(e,_,v,!1,t);g&&o.variants.push(g)}else if("EXT-X-I-FRAME-STREAM-INF"===f){var y=k(e,_,_.URI,!0,t);y&&o.variants.push(y)}else"EXT-X-SESSION-DATA"===f?function(){var e=new d({id:_["DATA-ID"],value:_.VALUE,uri:_.URI,language:_.LANGUAGE});o.sessionDataList.find((function(t){return t.id===e.id&&t.language===e.language}))&&a.INVALIDPLAYLIST("A Playlist MUST NOT contain more than one EXT-X-SESSION-DATA tag with the same DATA-ID attribute and the same LANGUAGE attribute."),o.sessionDataList.push(e)}():"EXT-X-SESSION-KEY"===f?function(){"NONE"===_.METHOD&&a.INVALIDPLAYLIST("EXT-X-SESSION-KEY: The value of the METHOD attribute MUST NOT be NONE");var e=new h({method:_.METHOD,uri:_.URI,iv:_.IV,format:_.KEYFORMAT,formatVersion:_.KEYFORMATVERSIONS});o.sessionKeyList.find((function(t){return P(t,e)}))&&a.INVALIDPLAYLIST("A Master Playlist MUST NOT contain more than one EXT-X-SESSION-KEY tag with the same METHOD, URI, IV, KEYFORMAT, and KEYFORMATVERSIONS attribute values."),A(t,_),o.sessionKeyList.push(e)}():"EXT-X-INDEPENDENT-SEGMENTS"===f?(o.independentSegments&&a.INVALIDPLAYLIST("EXT-X-INDEPENDENT-SEGMENTS tag MUST NOT appear more than once in a Playlist"),o.independentSegments=!0):"EXT-X-START"===f&&(o.start&&a.INVALIDPLAYLIST("EXT-X-START tag MUST NOT appear more than once in a Playlist"),"number"!=typeof _["TIME-OFFSET"]&&a.INVALIDPLAYLIST("EXT-X-START: TIME-OFFSET attribute is REQUIRED"),o.start={offset:_["TIME-OFFSET"],precise:_.PRECISE||!1})}}catch(e){s.e(e)}finally{s.f()}if(t.isClosedCaptionsNone){var E,T=r(o.variants);try{for(T.s();!(E=T.n()).done;)E.value.closedCaptions.length>0&&a.INVALIDPLAYLIST("If there is a variant with CLOSED-CAPTIONS attribute of NONE, all EXT-X-STREAM-INF tags MUST have this attribute with a value of NONE")}catch(e){T.e(e)}finally{T.f()}}return o}(e,t):!(n=function(e,t){var n,o=new v,s=-1,u=0,c=!1,l=0,d=null,h=null,f=!1,p=r(e.entries());try{for(p.s();!(n=p.n()).done;){var _=i(n.value,2),m=_[0],g=_[1],y=g.name,T=g.value,S=g.attributes;if("Segment"!==g.category){if("EXT-X-VERSION"===y)void 0===o.version?o.version=T:a.INVALIDPLAYLIST("A Playlist file MUST NOT contain more than one EXT-X-VERSION tag.");else if("EXT-X-TARGETDURATION"===y)o.targetDuration=t.targetDuration=T;else if("EXT-X-MEDIA-SEQUENCE"===y)o.segments.length>0&&a.INVALIDPLAYLIST("The EXT-X-MEDIA-SEQUENCE tag MUST appear before the first Media Segment in the Playlist."),o.mediaSequenceBase=u=T;else if("EXT-X-DISCONTINUITY-SEQUENCE"===y)o.segments.length>0&&a.INVALIDPLAYLIST("The EXT-X-DISCONTINUITY-SEQUENCE tag MUST appear before the first Media Segment in the Playlist."),c&&a.INVALIDPLAYLIST("The EXT-X-DISCONTINUITY-SEQUENCE tag MUST appear before any EXT-X-DISCONTINUITY tag."),o.discontinuitySequenceBase=l=T;else if("EXT-X-ENDLIST"===y)o.endlist=!0;else if("EXT-X-PLAYLIST-TYPE"===y)o.playlistType=T;else if("EXT-X-I-FRAMES-ONLY"===y)t.compatibleVersion<4&&(t.compatibleVersion=4),o.isIFrame=!0;else if("EXT-X-INDEPENDENT-SEGMENTS"===y)o.independentSegments&&a.INVALIDPLAYLIST("EXT-X-INDEPENDENT-SEGMENTS tag MUST NOT appear more than once in a Playlist"),o.independentSegments=!0;else if("EXT-X-START"===y)o.start&&a.INVALIDPLAYLIST("EXT-X-START tag MUST NOT appear more than once in a Playlist"),"number"!=typeof S["TIME-OFFSET"]&&a.INVALIDPLAYLIST("EXT-X-START: TIME-OFFSET attribute is REQUIRED"),o.start={offset:S["TIME-OFFSET"],precise:S.PRECISE||!1};else if("EXT-X-SERVER-CONTROL"===y)S["CAN-BLOCK-RELOAD"]||a.INVALIDPLAYLIST("EXT-X-SERVER-CONTROL: CAN-BLOCK-RELOAD=YES is mandatory for Low-Latency HLS"),o.lowLatencyCompatibility={canBlockReload:S["CAN-BLOCK-RELOAD"],canSkipUntil:S["CAN-SKIP-UNTIL"],holdBack:S["HOLD-BACK"],partHoldBack:S["PART-HOLD-BACK"]};else if("EXT-X-PART-INF"===y)S["PART-TARGET"]||a.INVALIDPLAYLIST("EXT-X-PART-INF: PART-TARGET attribute is mandatory"),o.partTargetDuration=S["PART-TARGET"];else if("EXT-X-RENDITION-REPORT"===y)S.URI||a.INVALIDPLAYLIST("EXT-X-RENDITION-REPORT: URI attribute is mandatory"),0===S.URI.search(/^[a-z]+:/)&&a.INVALIDPLAYLIST("EXT-X-RENDITION-REPORT: URI must be relative to the playlist uri"),o.renditionReports.push(new E({uri:S.URI,lastMSN:S["LAST-MSN"],lastPart:S["LAST-PART"]}));else if("EXT-X-SKIP"===y)S["SKIPPED-SEGMENTS"]||a.INVALIDPLAYLIST("EXT-X-SKIP: SKIPPED-SEGMENTS attribute is mandatory"),t.compatibleVersion<9&&(t.compatibleVersion=9),o.skip=S["SKIPPED-SEGMENTS"],u+=o.skip;else if("string"==typeof g){-1===s&&a.INVALIDPLAYLIST("A URI line is not preceded by any segment tags"),o.targetDuration||a.INVALIDPLAYLIST("The EXT-X-TARGETDURATION tag is REQUIRED");var b=D(e,g,s,m-1,u++,l,t);if(b){var A=i(O(o,b,l,d,h),3);l=A[0],d=A[1],h=A[2],!f&&b.parts.length>0&&(f=!0)}s=-1}}else-1===s&&(s=m),"EXT-X-DISCONTINUITY"===y&&(c=!0)}}catch(e){p.e(e)}finally{p.f()}if(-1!==s){var w=D(e,"",s,e.length-1,u++,l,t);if(w){var I=w.parts;I.length>0&&!o.endlist&&!I[I.length-1].hint&&a.INVALIDPLAYLIST("If the Playlist contains EXT-X-PART tags and does not contain an EXT-X-ENDLIST tag, the Playlist must contain an EXT-X-PRELOAD-HINT tag with a TYPE=PART attribute"),O(o,w,d,h),!f&&w.parts.length>0&&(f=!0)}}return function(e){for(var t=new Map,n=new Map,i=!1,o=!1,s=e.length-1;s>=0;s--){var u=e[s],c=u.programDateTime,l=u.dateRange;if(c&&(o=!0),l&&l.start){i=!0,l.endOnNext&&(l.end||l.duration)&&a.INVALIDPLAYLIST("An EXT-X-DATERANGE tag with an END-ON-NEXT=YES attribute MUST NOT contain DURATION or END-DATE attributes.");var d=l.start.getTime(),h=l.duration||0;l.end&&l.duration&&d+1e3*h!==l.end.getTime()&&a.INVALIDPLAYLIST("END-DATE MUST be equal to the value of the START-DATE attribute plus the value of the DURATION"),l.endOnNext&&(l.end=t.get(l.classId)),t.set(l.classId,l.start);var f=l.end?l.end.getTime():l.start.getTime()+1e3*(l.duration||0),p=n.get(l.classId);if(p){var _,m=r(p);try{for(m.s();!(_=m.n()).done;){var v=_.value;(v.start<=d&&v.end>d||v.start>=d&&v.start<f)&&a.INVALIDPLAYLIST("DATERANGE tags with the same CLASS should not overlap")}}catch(e){m.e(e)}finally{m.f()}p.push({start:d,end:f})}else n.set(l.classId,[{start:d,end:f}])}}i&&!o&&a.INVALIDPLAYLIST("If a Playlist contains an EXT-X-DATERANGE tag, it MUST also contain at least one EXT-X-PROGRAM-DATE-TIME tag.")}(o.segments),o.lowLatencyCompatibility&&function(e,t){var n=e.lowLatencyCompatibility,o=e.targetDuration,s=e.partTargetDuration,u=e.segments,c=e.renditionReports,l=n.canSkipUntil,d=n.holdBack,h=n.partHoldBack;if(l<6*o&&a.INVALIDPLAYLIST("The Skip Boundary must be at least six times the EXT-X-TARGETDURATION."),d<3*o&&a.INVALIDPLAYLIST("HOLD-BACK must be at least three times the EXT-X-TARGETDURATION."),t){void 0===s&&a.INVALIDPLAYLIST("EXT-X-PART-INF is required if a Playlist contains one or more EXT-X-PART tags"),void 0===h&&a.INVALIDPLAYLIST("EXT-X-PART: PART-HOLD-BACK attribute is mandatory"),h<s&&a.INVALIDPLAYLIST("PART-HOLD-BACK must be at least PART-TARGET");var f,p=r(u.entries());try{for(p.s();!(f=p.n()).done;){var _=i(f.value,2),m=_[0],v=_[1].parts;v.length>0&&m<u.length-3&&a.INVALIDPLAYLIST("Remove EXT-X-PART tags from the Playlist after they are greater than three target durations from the end of the Playlist.");var g,y=r(v.entries());try{for(y.s();!(g=y.n()).done;){var E=i(g.value,2),T=E[0],S=E[1].duration;void 0!==S&&(S>s&&a.INVALIDPLAYLIST("PART-TARGET is the maximum duration of any Partial Segment"),T<v.length-1&&S<.85*s&&a.INVALIDPLAYLIST("All Partial Segments except the last part of a segment must have a duration of at least 85% of PART-TARGET"))}}catch(e){y.e(e)}finally{y.f()}}}catch(e){p.e(e)}finally{p.f()}}var b,A=r(c);try{for(A.s();!(b=A.n()).done;){var w=b.value,I=u[u.length-1];w.lastMSN||(w.lastMSN=I.mediaSequenceNumber),!w.lastPart&&I.parts.length>0&&(w.lastPart=I.parts.length-1)}}catch(e){A.e(e)}finally{A.f()}}(o,f),o}(e,t)).isIFrame&&t.hasMap&&t.compatibleVersion<6&&(t.compatibleVersion=6),t.compatibleVersion>1&&(!n.version||n.version<t.compatibleVersion)&&a.INVALIDPLAYLIST("EXT-X-VERSION needs to be ".concat(t.compatibleVersion," or higher.")),n}e.exports=function(e){var t={version:void 0,isMasterPlaylist:void 0,hasMap:!1,targetDuration:0,compatibleVersion:1,isClosedCaptionsNone:!1,hash:{}},n=C(function(e,t){var n=[];return e.split("\n").forEach((function(e){var r=e.trim();if(r)if(r.startsWith("#")){if(r.startsWith("#EXT")){var i=L(r,t);return void(i&&n.push(i))}}else n.push(r)})),0!==n.length&&"EXTM3U"===n[0].name||a.INVALIDPLAYLIST("The EXTM3U tag MUST be the first line."),n}(e,t),t);return n.source=e,n}},367:(e,t,n)=>{function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function i(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e)){var n=[],r=!0,i=!1,o=void 0;try{for(var s,a=e[Symbol.iterator]();!(r=(s=a.next()).done)&&(n.push(s.value),!t||n.length!==t);r=!0);}catch(e){i=!0,o=e}finally{try{r||null==a.return||a.return()}finally{if(i)throw o}}return n}}(e,t)||s(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function o(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=s(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,u=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return a=e.done,e},e:function(e){u=!0,o=e},f:function(){try{a||null==n.return||n.return()}finally{if(u)throw o}}}}function s(e,t){if(e){if("string"==typeof e)return a(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?a(e,t):void 0}}function a(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function u(e,t,n){return(u="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=p(e)););return e}(e,t);if(r){var i=Object.getOwnPropertyDescriptor(r,t);return i.get?i.get.call(n):i.value}})(e,t,n||e)}function c(e,t){return!t||"object"!==r(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function l(e){var t="function"==typeof Map?new Map:void 0;return(l=function(e){if(null===e||(n=e,-1===Function.toString.call(n).indexOf("[native code]")))return e;var n;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(void 0!==t){if(t.has(e))return t.get(e);t.set(e,r)}function r(){return d(e,arguments,p(this).constructor)}return r.prototype=Object.create(e.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),f(r,e)})(e)}function d(e,t,n){return(d=h()?Reflect.construct:function(e,t,n){var r=[null];r.push.apply(r,t);var i=new(Function.bind.apply(e,r));return n&&f(i,n.prototype),i}).apply(null,arguments)}function h(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}function f(e,t){return(f=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function p(e){return(p=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var _=n(771),m=["#EXTINF","#EXT-X-BYTERANGE","#EXT-X-DISCONTINUITY","#EXT-X-STREAM-INF","#EXT-X-CUE-OUT","#EXT-X-CUE-IN","#EXT-X-KEY","#EXT-X-MAP"],v=["#EXT-X-MEDIA"],g=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&f(e,t)}(o,e);var t,n,r,i=(t=o,n=h(),function(){var e,r=p(t);if(n){var i=p(this).constructor;e=Reflect.construct(r,arguments,i)}else e=r.apply(this,arguments);return c(this,e)});function o(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(t=i.call(this)).baseUri=e,t}return(r=[{key:"push",value:function(){for(var e=this,t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];for(var i=function(){var t=a[s];if(!t.startsWith("#"))return u(p(o.prototype),"push",e).call(e,t),"continue";if(m.some((function(e){return t.startsWith(e)})))return u(p(o.prototype),"push",e).call(e,t),"continue";if(e.includes(t)){if(v.some((function(e){return t.startsWith(e)})))return"continue";_.INVALIDPLAYLIST("Redundant item (".concat(t,")"))}u(p(o.prototype),"push",e).call(e,t)},s=0,a=n;s<a.length;s++)i()}}])&&function(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}(o.prototype,r),o}(l(Array));function y(e,t){var n=1e3;t&&(n=Math.pow(10,t));var r=Math.round(e*n)/n;return t?r.toFixed(t):r}function E(e){var t=['DATA-ID="'.concat(e.id,'"')];return e.language&&t.push('LANGUAGE="'.concat(e.language,'"')),e.value?t.push('VALUE="'.concat(e.value,'"')):e.uri&&t.push('URI="'.concat(e.uri,'"')),"#EXT-X-SESSION-DATA:".concat(t.join(","))}function T(e,t){var n=t?"#EXT-X-SESSION-KEY":"#EXT-X-KEY",r=["METHOD=".concat(e.method)];return e.uri&&r.push('URI="'.concat(e.uri,'"')),e.iv&&(16!==e.iv.length&&_.INVALIDPLAYLIST("IV must be a 128-bit unsigned integer"),r.push("IV=".concat(_.byteSequenceToHex(e.iv)))),e.format&&r.push('KEYFORMAT="'.concat(e.format,'"')),e.formatVersion&&r.push('KEYFORMATVERSIONS="'.concat(e.formatVersion,'"')),"".concat(n,":").concat(r.join(","))}function S(e,t){var n=t.isIFrameOnly?"#EXT-X-I-FRAME-STREAM-INF":"#EXT-X-STREAM-INF",r=["BANDWIDTH=".concat(t.bandwidth)];if(t.averageBandwidth&&r.push("AVERAGE-BANDWIDTH=".concat(t.averageBandwidth)),t.isIFrameOnly&&r.push('URI="'.concat(t.uri,'"')),t.codecs&&r.push('CODECS="'.concat(t.codecs,'"')),t.resolution&&r.push("RESOLUTION=".concat(t.resolution.width,"x").concat(t.resolution.height)),t.frameRate&&r.push("FRAME-RATE=".concat(y(t.frameRate,3))),t.hdcpLevel&&r.push("HDCP-LEVEL=".concat(t.hdcpLevel)),t.audio.length>0){r.push('AUDIO="'.concat(t.audio[0].groupId,'"'));var i,s=o(t.audio);try{for(s.s();!(i=s.n()).done;){var a=i.value;e.push(b(a))}}catch(e){s.e(e)}finally{s.f()}}if(t.video.length>0){r.push('VIDEO="'.concat(t.video[0].groupId,'"'));var u,c=o(t.video);try{for(c.s();!(u=c.n()).done;){var l=u.value;e.push(b(l))}}catch(e){c.e(e)}finally{c.f()}}if(t.subtitles.length>0){r.push('SUBTITLES="'.concat(t.subtitles[0].groupId,'"'));var d,h=o(t.subtitles);try{for(h.s();!(d=h.n()).done;){var f=d.value;e.push(b(f))}}catch(e){h.e(e)}finally{h.f()}}if(_.getOptions().allowClosedCaptionsNone&&0===t.closedCaptions.length)r.push("CLOSED-CAPTIONS=NONE");else if(t.closedCaptions.length>0){r.push('CLOSED-CAPTIONS="'.concat(t.closedCaptions[0].groupId,'"'));var p,m=o(t.closedCaptions);try{for(m.s();!(p=m.n()).done;){var v=p.value;e.push(b(v))}}catch(e){m.e(e)}finally{m.f()}}e.push("".concat(n,":").concat(r.join(","))),t.isIFrameOnly||e.push("".concat(t.uri))}function b(e){var t=["TYPE=".concat(e.type),'GROUP-ID="'.concat(e.groupId,'"'),'NAME="'.concat(e.name,'"')];return void 0!==e.isDefault&&t.push("DEFAULT=".concat(e.isDefault?"YES":"NO")),void 0!==e.autoselect&&t.push("AUTOSELECT=".concat(e.autoselect?"YES":"NO")),void 0!==e.forced&&t.push("FORCED=".concat(e.forced?"YES":"NO")),e.language&&t.push('LANGUAGE="'.concat(e.language,'"')),e.assocLanguage&&t.push('ASSOC-LANGUAGE="'.concat(e.assocLanguage,'"')),e.instreamId&&t.push('INSTREAM-ID="'.concat(e.instreamId,'"')),e.characteristics&&t.push('CHARACTERISTICS="'.concat(e.characteristics,'"')),e.channels&&t.push('CHANNELS="'.concat(e.channels,'"')),e.uri&&t.push('URI="'.concat(e.uri,'"')),"#EXT-X-MEDIA:".concat(t.join(","))}function A(e,t,n,r){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1,o=!1;if(t.byterange&&e.push("#EXT-X-BYTERANGE:".concat(w(t.byterange))),t.discontinuity&&e.push("#EXT-X-DISCONTINUITY"),t.key){var s=T(t.key);s!==n&&(e.push(s),n=s)}if(t.map){var a=function(e){var t=['URI="'.concat(e.uri,'"')];return e.byterange&&t.push('BYTERANGE="'.concat(w(e.byterange),'"')),"#EXT-X-MAP:".concat(t.join(","))}(t.map);a!==r&&(e.push(a),r=a)}if(t.programDateTime&&e.push("#EXT-X-PROGRAM-DATE-TIME:".concat(_.formatDate(t.programDateTime))),t.dateRange&&e.push(function(e){var t=['ID="'.concat(e.id,'"')];return e.start&&t.push('START-DATE="'.concat(_.formatDate(e.start),'"')),e.end&&t.push('END-DATE="'.concat(e.end,'"')),e.duration&&t.push("DURATION=".concat(e.duration)),e.plannedDuration&&t.push("PLANNED-DURATION=".concat(e.plannedDuration)),e.classId&&t.push('CLASS="'.concat(e.classId,'"')),e.endOnNext&&t.push("END-ON-NEXT=YES"),Object.keys(e.attributes).forEach((function(n){n.startsWith("X-")?"number"==typeof e.attributes[n]?t.push("".concat(n,"=").concat(e.attributes[n])):t.push("".concat(n,'="').concat(e.attributes[n],'"')):n.startsWith("SCTE35-")&&t.push("".concat(n,"=").concat(_.byteSequenceToHex(e.attributes[n])))})),"#EXT-X-DATERANGE:".concat(t.join(","))}(t.dateRange)),t.markers.length>0&&I(e,t.markers),t.parts.length>0&&(o=R(e,t.parts)),o)return[n,r];var u=i<3?Math.round(t.duration):y(t.duration,function(e){var t=e.toString(10),n=t.indexOf(".");return-1===n?0:t.length-n-1}(t.duration));return e.push("#EXTINF:".concat(u,",").concat(unescape(encodeURIComponent(t.title||"")))),Array.prototype.push.call(e,"".concat(t.uri)),[n,r]}function w(e){var t=e.offset,n=e.length;return"".concat(n,"@").concat(t)}function I(e,t){var n,r=o(t);try{for(r.s();!(n=r.n()).done;){var i=n.value;if("OUT"===i.type)e.push("#EXT-X-CUE-OUT:".concat(i.duration));else if("IN"===i.type)e.push("#EXT-X-CUE-IN");else if("RAW"===i.type){var s=i.value?":".concat(i.value):"";e.push("#".concat(i.tagName).concat(s))}}}catch(e){r.e(e)}finally{r.f()}}function R(e,t){var n,r=!1,i=o(t);try{for(i.s();!(n=i.n()).done;){var s=n.value;if(s.hint){var a=[];if(a.push("TYPE=PART"),a.push('URI="'.concat(s.uri,'"')),s.byterange){var u=s.byterange,c=u.offset,l=u.length;a.push("BYTERANGE-START=".concat(c)),l&&a.push("BYTERANGE-LENGTH=".concat(l))}e.push("#EXT-X-PRELOAD-HINT:".concat(a.join(","))),r=!0}else{var d=[];d.push("DURATION=".concat(s.duration)),d.push('URI="'.concat(s.uri,'"')),s.byterange&&d.push("BYTERANGE=".concat(w(s.byterange))),s.independent&&d.push("INDEPENDENT=YES"),s.gap&&d.push("GAP=YES"),e.push("#EXT-X-PART:".concat(d.join(",")))}}}catch(e){i.e(e)}finally{i.f()}return r}e.exports=function(e){_.PARAMCHECK(e),_.ASSERT("Not a playlist","playlist"===e.type);var t=new g(e.uri);return t.push("#EXTM3U"),e.version&&t.push("#EXT-X-VERSION:".concat(e.version)),e.independentSegments&&t.push("#EXT-X-INDEPENDENT-SEGMENTS"),e.start&&t.push("#EXT-X-START:TIME-OFFSET=".concat(y(e.start.offset)).concat(e.start.precise?",PRECISE=YES":"")),e.isMasterPlaylist?function(e,t){var n,r=o(t.sessionDataList);try{for(r.s();!(n=r.n()).done;){var i=n.value;e.push(E(i))}}catch(e){r.e(e)}finally{r.f()}var s,a=o(t.sessionKeyList);try{for(a.s();!(s=a.n()).done;){var u=s.value;e.push(T(u,!0))}}catch(e){a.e(e)}finally{a.f()}var c,l=o(t.variants);try{for(l.s();!(c=l.n()).done;)S(e,c.value)}catch(e){l.e(e)}finally{l.f()}}(t,e):function(e,t){var n="",r="";if(t.targetDuration&&e.push("#EXT-X-TARGETDURATION:".concat(t.targetDuration)),t.lowLatencyCompatibility){var s=t.lowLatencyCompatibility,a=s.canBlockReload,u=s.canSkipUntil,c=s.holdBack,l=s.partHoldBack,d=[];d.push("CAN-BLOCK-RELOAD=".concat(a?"YES":"NO")),void 0!==u&&d.push("CAN-SKIP-UNTIL=".concat(u)),void 0!==c&&d.push("HOLD-BACK=".concat(c)),void 0!==l&&d.push("PART-HOLD-BACK=".concat(l)),e.push("#EXT-X-SERVER-CONTROL:".concat(d.join(",")))}t.partTargetDuration&&e.push("#EXT-X-PART-INF:PART-TARGET=".concat(t.partTargetDuration)),t.mediaSequenceBase&&e.push("#EXT-X-MEDIA-SEQUENCE:".concat(t.mediaSequenceBase)),t.discontinuitySequenceBase&&e.push("#EXT-X-DISCONTINUITY-SEQUENCE:".concat(t.discontinuitySequenceBase)),t.playlistType&&e.push("#EXT-X-PLAYLIST-TYPE:".concat(t.playlistType)),t.isIFrame&&e.push("#EXT-X-I-FRAMES-ONLY"),t.skip>0&&e.push("#EXT-X-SKIP:SKIPPED-SEGMENTS=".concat(t.skip));var h,f=o(t.segments);try{for(f.s();!(h=f.n()).done;){var p=i(A(e,h.value,n,r,t.version),2);n=p[0],r=p[1]}}catch(e){f.e(e)}finally{f.f()}t.endlist&&e.push("#EXT-X-ENDLIST");var _,m=o(t.renditionReports);try{for(m.s();!(_=m.n()).done;){var v=_.value,g=[];g.push('URI="'.concat(v.uri,'"')),g.push("LAST-MSN=".concat(v.lastMSN)),void 0!==v.lastPart&&g.push("LAST-PART=".concat(v.lastPart)),e.push("#EXT-X-RENDITION-REPORT:".concat(g.join(",")))}}catch(e){m.e(e)}finally{m.f()}}(t,e),t.join("\n")}},890:(e,t,n)=>{function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&o(e,t)}function o(e,t){return(o=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function s(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=u(e);if(t){var i=u(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return a(this,n)}}function a(e,t){return!t||"object"!==r(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function u(e){return(u=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function c(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var l=n(771),d=function e(t){c(this,e),l.PARAMCHECK(t),this.type=t},h=function(e){i(n,e);var t=s(n);function n(e){var r,i=e.isMasterPlaylist,o=e.uri,s=e.version,a=e.independentSegments,u=void 0!==a&&a,d=e.start,h=e.source;return c(this,n),r=t.call(this,"playlist"),l.PARAMCHECK(i),r.isMasterPlaylist=i,r.uri=o,r.version=s,r.independentSegments=u,r.start=d,r.source=h,r}return n}(d),f=function(e){i(n,e);var t=s(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};c(this,n),r.isMasterPlaylist=!0,e=t.call(this,r);var i=r.variants,o=void 0===i?[]:i,s=r.currentVariant,a=r.sessionDataList,u=void 0===a?[]:a,l=r.sessionKeyList,d=void 0===l?[]:l;return e.variants=o,e.currentVariant=s,e.sessionDataList=u,e.sessionKeyList=d,e}return n}(h),p=function(e){i(n,e);var t=s(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};c(this,n),r.isMasterPlaylist=!1,e=t.call(this,r);var i=r.targetDuration,o=r.mediaSequenceBase,s=void 0===o?0:o,a=r.discontinuitySequenceBase,u=void 0===a?0:a,l=r.endlist,d=void 0!==l&&l,h=r.playlistType,f=r.isIFrame,p=r.segments,_=void 0===p?[]:p,m=r.lowLatencyCompatibility,v=r.partTargetDuration,g=r.renditionReports,y=void 0===g?[]:g,E=r.skip,T=void 0===E?0:E,S=r.hash;return e.targetDuration=i,e.mediaSequenceBase=s,e.discontinuitySequenceBase=u,e.endlist=d,e.playlistType=h,e.isIFrame=f,e.segments=_,e.lowLatencyCompatibility=m,e.partTargetDuration=v,e.renditionReports=y,e.skip=T,e.hash=S,e}return n}(h),_=function(e){i(n,e);var t=s(n);function n(e){var r,i=e.uri,o=e.mimeType,s=e.data,a=e.duration,u=e.title,l=e.byterange,d=e.discontinuity,h=e.mediaSequenceNumber,f=void 0===h?0:h,p=e.discontinuitySequence,_=void 0===p?0:p,m=e.key,v=e.map,g=e.programDateTime,y=e.dateRange,E=e.markers,T=void 0===E?[]:E,S=e.parts,b=void 0===S?[]:S;return c(this,n),(r=t.call(this,"segment")).uri=i,r.mimeType=o,r.data=s,r.duration=a,r.title=u,r.byterange=l,r.discontinuity=d,r.mediaSequenceNumber=f,r.discontinuitySequence=_,r.key=m,r.map=v,r.programDateTime=g,r.dateRange=y,r.markers=T,r.parts=b,r}return n}(d),m=function(e){i(n,e);var t=s(n);function n(e){var r,i=e.hint,o=void 0!==i&&i,s=e.uri,a=e.duration,u=e.independent,d=e.byterange,h=e.gap;return c(this,n),r=t.call(this,"part"),l.PARAMCHECK(s),r.hint=o,r.uri=s,r.duration=a,r.independent=u,r.duration=a,r.byterange=d,r.gap=h,r}return n}(d);e.exports={Rendition:function e(t){var n=t.type,r=t.uri,i=t.groupId,o=t.language,s=t.assocLanguage,a=t.name,u=t.isDefault,d=t.autoselect,h=t.forced,f=t.instreamId,p=t.characteristics,_=t.channels;c(this,e),l.PARAMCHECK(n,i,a),l.CONDITIONALASSERT(["SUBTITLES"===n,r],["CLOSED-CAPTIONS"===n,f],["CLOSED-CAPTIONS"===n,!r],[h,"SUBTITLES"===n]),this.type=n,this.uri=r,this.groupId=i,this.language=o,this.assocLanguage=s,this.name=a,this.isDefault=u,this.autoselect=d,this.forced=h,this.instreamId=f,this.characteristics=p,this.channels=_},Variant:function e(t){var n=t.uri,r=t.isIFrameOnly,i=void 0!==r&&r,o=t.bandwidth,s=t.averageBandwidth,a=t.codecs,u=t.resolution,d=t.frameRate,h=t.hdcpLevel,f=t.audio,p=void 0===f?[]:f,_=t.video,m=void 0===_?[]:_,v=t.subtitles,g=void 0===v?[]:v,y=t.closedCaptions,E=void 0===y?[]:y,T=t.currentRenditions,S=void 0===T?{audio:0,video:0,subtitles:0,closedCaptions:0}:T;c(this,e),l.PARAMCHECK(n,o),this.uri=n,this.isIFrameOnly=i,this.bandwidth=o,this.averageBandwidth=s,this.codecs=a,this.resolution=u,this.frameRate=d,this.hdcpLevel=h,this.audio=p,this.video=m,this.subtitles=g,this.closedCaptions=E,this.currentRenditions=S},SessionData:function e(t){var n=t.id,r=t.value,i=t.uri,o=t.language;c(this,e),l.PARAMCHECK(n,r||i),l.ASSERT("SessionData cannot have both value and uri, shoud be either.",!(r&&i)),this.id=n,this.value=r,this.uri=i,this.language=o},Key:function e(t){var n=t.method,r=t.uri,i=t.iv,o=t.format,s=t.formatVersion;c(this,e),l.PARAMCHECK(n),l.CONDITIONALPARAMCHECK(["NONE"!==n,r]),l.CONDITIONALASSERT(["NONE"===n,!(r||i||o||s)]),this.method=n,this.uri=r,this.iv=i,this.format=o,this.formatVersion=s},MediaInitializationSection:function e(t){var n=t.hint,r=void 0!==n&&n,i=t.uri,o=t.mimeType,s=t.byterange;c(this,e),l.PARAMCHECK(i),this.hint=r,this.uri=i,this.mimeType=o,this.byterange=s},DateRange:function e(t){var n=t.id,r=t.classId,i=t.start,o=t.end,s=t.duration,a=t.plannedDuration,u=t.endOnNext,d=t.attributes,h=void 0===d?{}:d;c(this,e),l.PARAMCHECK(n),l.CONDITIONALPARAMCHECK([!0===u,r]),l.CONDITIONALASSERT([o,i],[o,i<=o],[s,s>=0],[a,a>=0]),this.id=n,this.classId=r,this.start=i,this.end=o,this.duration=s,this.plannedDuration=a,this.endOnNext=u,this.attributes=h},SpliceInfo:function e(t){var n=t.type,r=t.duration,i=t.tagName,o=t.value;c(this,e),l.PARAMCHECK(n),l.CONDITIONALPARAMCHECK(["OUT"===n,r]),l.CONDITIONALPARAMCHECK(["RAW"===n,i]),this.type=n,this.duration=r,this.tagName=i,this.value=o},Playlist:h,MasterPlaylist:f,MediaPlaylist:p,Segment:_,PartialSegment:m,RenditionReport:function e(t){var n=t.uri,r=t.lastMSN,i=t.lastPart;c(this,e),l.PARAMCHECK(n),this.uri=n,this.lastMSN=r,this.lastPart=i}}},771:e=>{function t(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e)){var n=[],r=!0,i=!1,o=void 0;try{for(var s,a=e[Symbol.iterator]();!(r=(s=a.next()).done)&&(n.push(s.value),!t||n.length!==t);r=!0);}catch(e){i=!0,o=e}finally{try{r||null==a.return||a.return()}finally{if(i)throw o}}return n}}(e,t)||r(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function n(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=r(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var i=0,o=function(){};return{s:o,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var s,a=!0,u=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return a=e.done,e},e:function(e){u=!0,s=e},f:function(){try{a||null==n.return||n.return()}finally{if(u)throw s}}}}function r(e,t){if(e){if("string"==typeof e)return i(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?i(e,t):void 0}}function i(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var o={};function s(e){if(o.strictMode)throw e;o.silent}function a(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10;if("number"==typeof e)return e;var n=10===t?Number.parseFloat(e,t):Number.parseInt(e,t);return Number.isNaN(n)?0:n}e.exports={THROW:s,ASSERT:function(e){for(var r=arguments.length,i=new Array(r>1?r-1:0),o=1;o<r;o++)i[o-1]=arguments[o];var a,u=n(i.entries());try{for(u.s();!(a=u.n()).done;){var c=t(a.value,2),l=c[0];c[1]||s(new Error("".concat(e," : Failed at [").concat(l,"]")))}}catch(e){u.e(e)}finally{u.f()}},CONDITIONALASSERT:function(){for(var e=arguments.length,r=new Array(e),i=0;i<e;i++)r[i]=arguments[i];var o,a=n(r.entries());try{for(a.s();!(o=a.n()).done;){var u=t(o.value,2),c=u[0],l=t(u[1],2),d=l[0],h=l[1];d&&(h||s(new Error("Conditional Assert : Failed at [".concat(c,"]"))))}}catch(e){a.e(e)}finally{a.f()}},PARAMCHECK:function(){for(var e=arguments.length,r=new Array(e),i=0;i<e;i++)r[i]=arguments[i];var o,a=n(r.entries());try{for(a.s();!(o=a.n()).done;){var u=t(o.value,2),c=u[0];void 0===u[1]&&s(new Error("Param Check : Failed at [".concat(c,"]")))}}catch(e){a.e(e)}finally{a.f()}},CONDITIONALPARAMCHECK:function(){for(var e=arguments.length,r=new Array(e),i=0;i<e;i++)r[i]=arguments[i];var o,a=n(r.entries());try{for(a.s();!(o=a.n()).done;){var u=t(o.value,2),c=u[0],l=t(u[1],2),d=l[0],h=l[1];d&&void 0===h&&s(new Error("Conditional Param Check : Failed at [".concat(c,"]")))}}catch(e){a.e(e)}finally{a.f()}},INVALIDPLAYLIST:function(e){s(new Error("Invalid Playlist : ".concat(e)))},toNumber:a,hexToByteSequence:function(e){(e.startsWith("0x")||e.startsWith("0X"))&&(e=e.slice(2));for(var t=[],n=0;n<e.length;n+=2)t.push(a(e.slice(n,n+2),16));return Buffer.from(t)},byteSequenceToHex:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e.length;n<=t&&s(new Error("end must be larger than start : start=".concat(t,", end=").concat(n)));for(var r=[],i=t;i<n;i++)r.push("0".concat((255&e[i]).toString(16).toUpperCase()).slice(-2));return"0x".concat(r.join(""))},tryCatch:function(e,t){try{return e()}catch(e){return t(e)}},splitAt:function(e,t){for(var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=-1,i=0,o=0;i<e.length;i++)if(e[i]===t){if(o++===n)return[e.slice(0,i),e.slice(i+1)];r=i}return-1!==r?[e.slice(0,r),e.slice(r+1)]:[e]},trim:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:" ";return e?(e=e.trim()," "===t||(e.startsWith(t)&&(e=e.slice(1)),e.endsWith(t)&&(e=e.slice(0,-1))),e):e},splitByCommaWithPreservingQuotes:function(e){for(var t=[],n=!0,r=0,i=[],o=0;o<e.length;o++){var s=e[o];n&&","===s?(t.push(e.slice(r,o).trim()),r=o+1):'"'!==s&&"'"!==s||(n?(i.push(s),n=!1):s===i[i.length-1]?(i.pop(),n=!0):i.push(s))}return t.push(e.slice(r).trim()),t},camelify:function(e){var t,r=[],i=!1,o=n(e);try{for(o.s();!(t=o.n()).done;){var s=t.value;"-"!==s&&"_"!==s?i?(r.push(s.toUpperCase()),i=!1):r.push(s.toLowerCase()):i=!0}}catch(e){o.e(e)}finally{o.f()}return r.join("")},formatDate:function(e){var t=e.getUTCFullYear(),n=("0"+(e.getUTCMonth()+1)).slice(-2),r=("0"+e.getUTCDate()).slice(-2),i=("0"+e.getUTCHours()).slice(-2),o=("0"+e.getUTCMinutes()).slice(-2),s=("0"+e.getUTCSeconds()).slice(-2),a=("00"+e.getUTCMilliseconds()).slice(-3);return"".concat(t,"-").concat(n,"-").concat(r,"T").concat(i,":").concat(o,":").concat(s,".").concat(a,"Z")},hasOwnProp:function(e,t){return Object.hasOwnProperty.call(e,t)},setOptions:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};o=Object.assign(o,e)},getOptions:function(){return Object.assign({},o)}}}},t={},function n(r){if(t[r])return t[r].exports;var i=t[r]={exports:{}};return e[r](i,i.exports,n),i.exports}(851);var e,t}()}));const Hi={},Xi={variant:0,audio:0,subtitles:0};let Wi=function(e){function t(t,n){var r;return(r=e.call(this,t)||this).type=r.type.toLowerCase(),r.index=Xi[r.type]++,r.id=r.uri,r.label=r.name,r.codecs=$i(n,r.type),r.url=null,r.playlist=null,r}return p(t,e),t.prototype.getSegmentBySN=function(e){return this.playlist.getSegmentBySN(e)},l(t,[{key:"mimeType",get:function(){return this.playlist&&zi(this.playlist.segments[0].uri,this.type)}},{key:"initSegment",get:function(){const e=this;return{get url(){var t;return null==(t=e.playlist)?void 0:t.initSegment.url}}}},{key:"segments",get:function(){var e;return(null==(e=this.playlist)?void 0:e.segments)||[]}},{key:"targetDuration",get:function(){var e;return null==(e=this.playlist)?void 0:e.targetDuration}},{key:"hasProgramDateTime",get:function(){return this.playlist.hasProgramDateTime}},{key:"age",get:function(){var e;return null==(e=this.playlist)?void 0:e.age}},{key:"edge",get:function(){var e;return null==(e=this.playlist)?void 0:e.edge}},{key:"parts",get:function(){var e;return(null==(e=this.playlist)?void 0:e.parts)||[]}},{key:"partTargetDuration",get:function(){var e;return null==(e=this.playlist)?void 0:e.partTargetDuration}},{key:"lowLatencyCompatibility",get:function(){return this.playlist.lowLatencyCompatibility}}])}(Bi.types.Rendition),qi=function(e){function t(t){var n,r,i;return(i=e.call(this,t)||this).audio=i.audio.map((e=>Hi[e.uri]||(Hi[e.uri]=new Wi(e,i.codecs)))),i.subtitles=i.subtitles.map((e=>Hi[e.uri]||(Hi[e.uri]=new Wi(e,i.codecs)))),i.type="video",i.index=Xi.variant++,i.id=i.uri,i.bitrate=i.bandwidth,i.avg_bitrate=i.averageBandwidth,i.framerate=i.frameRate||30,i.height=null==(n=i.resolution)?void 0:n.height,i.width=null==(r=i.resolution)?void 0:r.width,i.codecs=function(e,t=Yi){return e?t:$i(t,"video")}(!i.audio.length,t.codecs),i.url=null,i.playlist=null,i}return p(t,e),t.prototype.getSegmentBySN=function(e){return this.playlist.getSegmentBySN(e)},l(t,[{key:"mimeType",get:function(){return this.playlist&&zi(this.playlist.segments[0].uri,"video")}},{key:"initSegment",get:function(){const e=this;return{get url(){var t;return null==(t=e.playlist)?void 0:t.initSegment.url}}}},{key:"segments",get:function(){var e;return(null==(e=this.playlist)?void 0:e.segments)||[]}},{key:"targetDuration",get:function(){var e;return null==(e=this.playlist)?void 0:e.targetDuration}},{key:"hasProgramDateTime",get:function(){return this.playlist.hasProgramDateTime}},{key:"age",get:function(){var e;return null==(e=this.playlist)?void 0:e.age}},{key:"edge",get:function(){var e;return null==(e=this.playlist)?void 0:e.edge}},{key:"parts",get:function(){var e;return(null==(e=this.playlist)?void 0:e.parts)||[]}},{key:"partTargetDuration",get:function(){var e;return null==(e=this.playlist)?void 0:e.partTargetDuration}},{key:"lowLatencyCompatibility",get:function(){return this.playlist.lowLatencyCompatibility}}])}(Bi.types.Variant),Gi=function(e){function t(t){var n;return(n=e.call(this,t)||this).variants=n.variants.map((e=>new qi(e))),n}return p(t,e),l(t,[{key:"video",get:function(){return this.variants}},{key:"audio",get:function(){return w(I(this.variants,(e=>e.audio)))}},{key:"subtitles",get:function(){return w(I(this.variants,(e=>e.subtitles)))}},{key:"captions",get:function(){return this.subtitles}}])}(Bi.types.MasterPlaylist);const Ki={audio:[/^vorbis$/,/^opus$/,/^flac$/,/^mp4a/,/^[ae]c-3$/],video:[/^avc/,/^hev/,/^hvc/,/^vp0?[89]/,/^av1$/]},Yi="avc1.42E01E,mp4a.40.2";function $i(e=Yi,t){const n=e.split(","),r=Ki[t.toLowerCase()]||[];return n.find((e=>r.some((t=>t.test(e.trim())))))}function zi(e,t){const n=e.split(".").pop().split("?")[0],r={fmp4:"mp4",m4s:"mp4",ts:"mp2t"}[n]||n||"mp4";return`${t.toLowerCase()}/${r}`}const Qi=function(e){return function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];try{return Promise.resolve(e.apply(this,t))}catch(Rp){return Promise.reject(Rp)}}}((function(e){let t=!1;return function(n,r){var i=function(){if(/json=1/.test(e))return function(e,t){return void 0?t?t(e):e:(e&&e.then||(e=Promise.resolve(e)),t?e.then(t):e)}(Se(e).json(),(function(e){const n=e.url;return t=!0,n}))}();return i&&i.then?i.then(r):r(i)}(0,(function(n){return t?n:e}))}));function Ji(e){return e.substr(0,e.lastIndexOf("/")+1)}function Zi(e,t){if(t)return/^https?:\/\//.test(t)?t:e+t}const eo={};let to=function(e){function t(t,{url:n,type:r,index:i}){var o;return(o=e.call(this,t)||this).url=n,o.type=r,o.stream=i,o.advancedDateTime=0,o.misses=0,o.parts=null,o.initSegment=t.segments[0].map||{uri:t.segments[0].uri},o.initSegment.url=Zi(Ji(o.url),o.initSegment.uri),function(e,t){let n=(t.segments[0].mediaSequenceNumber||0)*t.targetDuration,r=-1;e.segments=[],e.parts=[],t.segments.forEach((i=>{var o,s;if(void 0===i.mediaSequenceNumber)throw new Error("No valid segment sequence number found");let a=Zi(Ji(e.url),i.uri);const u=(null==(o=eo[a])?void 0:o.update(i))||new no(g(g({},i),{},{type:e.type,stream:e.stream,targetDuration:t.targetDuration,url:a,start:n}));a&&(eo[a]=u);const c=i.parts.map(((n,r)=>{var i;return a=Zi(Ji(e.url),n.uri),(null==(i=eo[a])?void 0:i.update(n))||(eo[a]=new ro(g(g({},n),{},{type:e.type,stream:e.stream,partTargetDuration:t.partTargetDuration,mediaSequenceNumber:u.mediaSequenceNumber,url:a,part:r})))}));u.parts=c,(s=e.parts).push.apply(s,T(c)),function(e,t){e.programDateTime?e.programDateTime=new Date(e.programDateTime).getTime():null!=t&&t.programDateTime&&(e.programDateTime=t.endProgramDateTime),Number.isFinite(e.programDateTime)||(e.programDateTime=null)}(u,e.segments[e.segments.length-1]),u.programDateTime&&-1===r&&(r=e.segments.length),n+=u.duration||0,e.segments.push(u)})),r>0&&function(e,t){let n=e[t];for(let r=t;r--;){const t=e[r];if(!t)return;t.programDateTime=n.programDateTime-1e3*t.duration,n=t}}(e.segments,r)}(o,t),o}p(t,e);var n=t.prototype;return n.reloaded=function(e){if(!e)return this.advanced=!0,void(this.updated=!0);const t=this.lastPartSn-e.lastPartSn,n=this.lastPartIndex-e.lastPartIndex;this.updated=this.endSN!==e.endSN||!!n||!!t,this.advanced=this.endSN>e.endSN||t>0||0===t&&n>0,this.updated||this.advanced?this.misses=Math.floor(.6*e.misses):this.misses=e.misses+1,this.timeOffset=e.timeOffset},n.getSegmentBySN=function(e){return this.segments.find((t=>t.mediaSequenceNumber===e))},l(t,[{key:"availableParts",get:function(){var e;return null!=(e=this.parts)&&e.length?this.parts.filter((e=>!e.hint)):[]}},{key:"timeOffset",get:function(){return this._timeOffset||0},set:function(e){this._timeOffset=e,this.segments.forEach((t=>{t.timeOffset=e}))}},{key:"segmentEnd",get:function(){var e;return null!=(e=this.segments)&&e.length?this.segments[this.segments.length-1].end:0}},{key:"segmentEndPDT",get:function(){var e;return null!=(e=this.segments)&&e.length?this.segments[this.segments.length-1].programDateTime:0}},{key:"endSN",get:function(){var e;return null!=(e=this.segments)&&e.length?this.segments[this.segments.length-1].mediaSequenceNumber:0}},{key:"hasProgramDateTime",get:function(){return!!this.segments.length&&Number.isFinite(this.segmentEndPDT)}},{key:"age",get:function(){return this.advancedDateTime?Math.max(Date.now()-this.advancedDateTime,0)/1e3:0}},{key:"partEnd",get:function(){var e;return null!=(e=this.parts)&&e.length?this.parts[this.parts.length-1].end:0}},{key:"lastPartIndex",get:function(){var e;return null!=(e=this.parts)&&e.length?this.parts[this.parts.length-1].part:-1}},{key:"lastAvailablePartIndex",get:function(){var e;return null!=(e=this.availableParts)&&e.length?this.availableParts[this.availableParts.length-1].part:-1}},{key:"lastPartSn",get:function(){var e;return null!=(e=this.parts)&&e.length?this.parts[this.parts.length-1].mediaSequenceNumber:this.endSN}},{key:"lastAvailablePartSn",get:function(){var e;return null!=(e=this.availableParts)&&e.length?this.availableParts[this.availableParts.length-1].mediaSequenceNumber:this.endSN}},{key:"edge",get:function(){return this.partEnd||this.segmentEnd}}])}(Bi.types.MediaPlaylist),no=function(e){function t(t){var n;return(n=e.call(this,t)||this).type=t.type,n.stream=t.stream,n.targetDuration=t.targetDuration,n.start=t.start,n.parts=t.parts,n.url=t.url,n}p(t,e);var n=t.prototype;return n.getPart=function(e){return e>=0&&e<this._parts.length?this._parts[e]:null},n._linkParts=function(){var e;if((null==(e=this._parts)?void 0:e.length)>1&&!0===this._parts[0].independent&&!this._parts[1].independent){var t;let e;null==(t=this._parts)||t.forEach((t=>{t.dependentOn=!0===t.independent?null:e,e=t}))}},n._syncPartsWithStart=function(){var e;let t=this._start;null==(e=this._parts)||e.forEach((e=>{e.start=t,t+=e.duration||e.partTargetDuration||0}))},n._syncPartsWithPDT=function(){var e;let t=this.programDateTime;null==(e=this._parts)||e.forEach((e=>{e.programDateTime=t,t+=1e3*(e.duration||e.partTargetDuration||0)}))},n.update=function({uri:e}){return this.uri=e,this},l(t,[{key:"timeOffset",get:function(){return this._timeOffset||0},set:function(e){this._timeOffset=e,this.parts.forEach((t=>{t.timeOffset=e}))}},{key:"start",get:function(){return this._start+this.timeOffset},set:function(e){this._start=e,this._syncPartsWithStart()}},{key:"programDateTime",get:function(){return this._programDateTime},set:function(e){this._programDateTime=e,this._syncPartsWithPDT()}},{key:"parts",get:function(){return this._parts},set:function(e){this._parts=e,this._linkParts(),this._syncPartsWithStart(),this._syncPartsWithPDT()}},{key:"segment",get:function(){return this.mediaSequenceNumber}},{key:"end",get:function(){return this.start+(this.duration||this.targetDuration||0)}},{key:"endProgramDateTime",get:function(){if(null===this.programDateTime)return null;if(!Number.isFinite(this.programDateTime))return null;const e=Number.isFinite(this.duration)?this.duration:0;return this.programDateTime+1e3*e}}])}(Bi.types.Segment),ro=function(e){function t(t){var n;return(n=e.call(this,t)||this).type=t.type,n.stream=t.stream,n.partTargetDuration=t.partTargetDuration,n.start=t.start,n.url=t.url,n.mediaSequenceNumber=t.mediaSequenceNumber,n.part=t.part,n.programDateTime=null,n.timeOffset=0,n.dependentOn=null,n}return p(t,e),t.prototype.update=function({hint:e,duration:t,independent:n}){return this.hint=e,this.duration=t,this.independent=n,this},l(t,[{key:"segment",get:function(){return this.mediaSequenceNumber}},{key:"start",get:function(){return this._start+this.timeOffset},set:function(e){this._start=e}},{key:"end",get:function(){return this.start+(this.duration||this.partTargetDuration||0)}}])}(Bi.types.PartialSegment);function io(e,t,n){return n?t?t(e):e:(e&&e.then||(e=Promise.resolve(e)),t?e.then(t):e)}const oo=ao((function(e){return io(Se(e).json(),(function(e){return Qi(e.url.hls)}))}));function so(e,t){try{var n=e()}catch(Rp){return t(Rp)}return n&&n.then?n.then(void 0,t):n}function ao(e){return function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];try{return Promise.resolve(e.apply(this,t))}catch(Rp){return Promise.reject(Rp)}}}function uo(){}function co(e,t){if(!t)return e&&e.then?e.then(uo):Promise.resolve()}Bi.setOptions({silent:!0});let lo=function(){function t(e,t,n){this.lowLatencyMode=e.lowLatencyMode,this.dvrEnabled=e.dvrEnabled,this.disableDeltaUpdates=e.disableDeltaUpdates,this._masterLoader=e,this._oldPlaylist=null==n?void 0:n._oldPlaylist,this._type=t,this._expirationTime=1/0,this.alive=!0}var n=t.prototype;return n.update=function(t,n,r){try{const i=this;return t&&i.alive?io(so((function(){return io(i._requestPromise,(function(){var o,s,a;t.url=Zi(i.baseUrl,t.uri);const u=new URL(t.url).searchParams;i.dvrEnabled||null!==u.get("max_segments")||(t.url=Q(t.url,{max_segments:10}));const c=(null==(o=t.playlist)||null==(o=o.lowLatencyCompatibility)?void 0:o.canSkipUntil)||0;return(null!==(s=null==(a=t.playlist)?void 0:a.age)&&void 0!==s?s:1/0)<c/2&&!i.disableDeltaUpdates&&(r=g(g({},r),{},{_HLS_skip:"YES"})),i._requestPromise=Se(t.url,{searchParams:r,retryStatus:po,type:e.MANIFEST,retry:3,hooks:{beforeRequest:i._isExpired()?[i._beforeRetry(t)]:[],beforeRetry:[i._beforeRetry(t)]}}),io(i._requestPromise,(function(e){return io(e.text(),(function(r){var o;const s=Bi.parse(r),a=new to(s,t),u=a.skip>0?i._mergeDeltaPlaylistUpdates(t.playlist,a):a;if(t.playlist=u,t.playlist.advancedDateTime=Date.now()-e.perfTimings.duration,t.playlist.reloaded(i._oldPlaylist),i._oldPlaylist=t.playlist,i._masterLoader.fire("1",t,n),i.lowLatencyMode&&null!=(o=t.playlist.lowLatencyCompatibility)&&o.canBlockReload){const e=a.lastAvailablePartIndex,n=-1!==e?a.lastAvailablePartSn:a.endSN+1,r=-1!==e?e+1:void 0;i.update(t,!1,{_HLS_msn:n,_HLS_part:r})}else if(i.alive){clearTimeout(i._timer);const e=function(e,t){return 1e3*(t&&e.partTargetDuration||e.targetDuration)}(t,i.lowLatencyMode);i._timer=setTimeout((()=>i.update(t)),e)}}))}))}))}),(function(e){e instanceof te||i._masterLoader.fire("2",e)}))):io()}catch(Rp){return Promise.reject(Rp)}},n.stop=function(){var e;clearTimeout(this._timer),null==(e=this._requestPromise)||e.abort(),this._requestPromise=null,this.alive=!1},n._isExpired=function(){return this._expirationTime&&this._expirationTime-1e4<=Date.now()},n._beforeRetry=function(e){const t=this;return ao((function(n,r){return io(t._masterLoader.refreshBaseUrl(),(function(r){n.url=Zi(r,e.uri),t._expirationTime=function(e){const t=z(e),n=t&&t.pathname.match(/^\/(exp=)?(\d{10,})/);return n&&1e3*n[2]}(n.url)}))}))},n._mergeDeltaPlaylistUpdates=function(e,t){e.mediaSequenceBase<t.mediaSequenceBase&&(e.segments=e.segments.filter((e=>e.mediaSequenceNumber>=t.mediaSequenceBase)));const n=t.segments.filter((t=>t.mediaSequenceNumber>e.endSN));return t.segments=[].concat(T(e.segments),T(n)),t},l(t,[{key:"baseUrl",get:function(){var e;return null==(e=this._masterLoader)?void 0:e.baseUrl}}])}();const ho={disableDeltaUpdates:!1};let fo=function(t){function n(e=ho){var n;return(n=t.call(this)||this).video=new lo(n,"video"),n.audio=new lo(n,"audio"),n.subtitles=new lo(n,"subtitles"),n._disableDeltaUpdates=e.disableDeltaUpdates,n._activeStreamIndex={},n}p(n,t);var r=n.prototype;return r.start=function(e,t){try{const n=this;return n._refreshUrl=t,io(Qi(e),(function(e){return n._masterPlaylistUrl=e,io(n._fetchMasterPlaylist(n._masterPlaylistUrl),(function(e){return n.manifest=new Gi(Bi.parse(e)),n.manifest}))}))}catch(Rp){return Promise.reject(Rp)}},r.stop=function(){this.video.stop(),this.audio.stop(),this.subtitles.stop(),this.video=new lo(this,"video",this.video),this.audio=new lo(this,"audio",this.audio),this.subtitles=new lo(this,"subtitles",this.subtitles)},r.update=function(e){try{const t=this;return io(t.video.update(t.activeStream("video"),e),(function(){return co(Promise.all([t.audio.update(t.activeStream("audio"),e),t.subtitles.update(t.activeStream("subtitles"),e)]))}))}catch(Rp){return Promise.reject(Rp)}},r.switchTo=function(e,t){try{const n=this;return t===n._activeStreamIndex[e]?io():(n[e].stop(),n[e]=new lo(n,e,n[e]),n._activeStreamIndex[e]=t,io(co(n[e].update(n.activeStream(e),!0))))}catch(Rp){return Promise.reject(Rp)}},r.activeStream=function(e){return this.manifest[e].find((({index:t})=>t===this._activeStreamIndex[e]))},r.activeStreamIndex=function(e){return this._activeStreamIndex[e]},r.refreshBaseUrl=function(){try{const e=this;return io(oo(e._refreshUrl),(function(t){return e._masterPlaylistUrl=t,e.baseUrl}))}catch(Rp){return Promise.reject(Rp)}},r._fetchMasterPlaylist=function(t){try{let n=!1;const r=this;let i;return io(function(e,t){return e&&e.then?e.then(t):t(e)}(so((function(){const n={type:e.MANIFEST,retry:8,retryStatus:po,hooks:{beforeRetry:[r._beforeRetryMasterPlaylist.bind(r)]}};return r.dvrEnabled||(n.searchParams={min_seconds:30}),io(Se(t,n).text(),(function(e){i=e}))}),(function(){throw new Error("Master playlist failed to load. Giving up updating after 8 attempts.")})),(function(e){return n?e:i})))}catch(Rp){return Promise.reject(Rp)}},r._beforeRetryMasterPlaylist=function(e,t,n){try{const t=this;return io(oo(t._refreshUrl),(function(n){t._masterPlaylistUrl=n,e.url=t._masterPlaylistUrl}))}catch(Rp){return Promise.reject(Rp)}},l(n,[{key:"baseUrl",get:function(){return Ji(this._masterPlaylistUrl)}},{key:"lowLatencyMode",get:function(){var e;return!(null==(e=this.video)||!e.lowLatencyMode)},set:function(e){this.video.lowLatencyMode=e,this.audio.lowLatencyMode=e,this.subtitles.lowLatencyMode=e}},{key:"dvrEnabled",get:function(){var e;return!(null==(e=this.video)||!e.dvrEnabled)},set:function(e){this.video.dvrEnabled=e,this.audio.dvrEnabled=e,this.subtitles.dvrEnabled=e}},{key:"disableDeltaUpdates",get:function(){return this._disableDeltaUpdates}}])}(bn);function po(e){return[403,404,410].includes(e)||t.retryStatus(e)}const _o=["width","height","bandwidth","duration","timescale","presentationTimeOffset"];function mo(e){const t={};for(let n=0;n<e.length;n++){const r=e[n].nodeName;let i=e[n].nodeValue;-1!==_o.indexOf(r)&&(i=parseInt(i,10)),"duration"===r&&isNaN(i)&&(i=So(e[n].nodeValue)),t[r]=i}return t}function vo(e,t,n){return Array.prototype.filter.call(e.childNodes,(function(e){return e instanceof Element&&e.localName===n&&e.namespaceURI===t}))}function go(e,t){return e.hasAttribute(t)?e.getAttribute(t):null}function yo(e,t,n){return e.hasAttributeNS(t,n)?e.getAttributeNS(t,n):null}function Eo(e=""){let t,n;return n=(t=e.match(/^(\d+)\/(\d+)$/))?Number(t[1]/t[2]):Number(e),isNaN(n)?null:n}function To(e){return Array.prototype.every.call(e.childNodes,(e=>e.nodeType===Node.TEXT_NODE||e.nodeType===Node.CDATA_SECTION_NODE))?e.textContent.trim():null}function So(e){if(!e)return null;const t=/^([-])?P(([\d.]*)Y)?(([\d.]*)M)?(([\d.]*)D)?T?(([\d.]*)H)?(([\d.]*)M)?(([\d.]*)S)?/.exec(e);let n=31536e3*parseFloat(t[2]||0)+2592e3*parseFloat(t[4]||0)+86400*parseFloat(t[6]||0)+3600*parseFloat(t[8]||0)+60*parseFloat(t[10]||0)+parseFloat(t[12]||0);return void 0!==t[1]&&(n=-n),n}const bo={"urn:uuid:1077efec-c0b2-4d02-ace3-3c1e52e2fb4b":"org.w3.clearkey","urn:uuid:edef8ba9-79d6-4ace-a3c8-27dcd51d21ed":"com.widevine.alpha","urn:uuid:9a04f079-9840-4286-ab92-e65be0885f95":"com.microsoft.playready","urn:uuid:f239e769-efa3-4850-9c16-a903c6932efb":"com.adobe.primetime"};var Ao=Object.freeze({__proto__:null,fetchMasterPlaylistUrl:Qi,PLAYLIST_UPDATE:"1",PLAYLIST_ERROR:"2",M3U8Loader:fo,Rendition:Wi,Variant:qi,M3U8Manifest:Gi,convertTsCodecs:function(e){let t=e.replace(/mp2t/i,"mp4");const n=/avc1\.(66|77|100)\.(\d+)/.exec(t);if(n){let e="avc1.";const r=n[1];e+="66"===r?"4200":"77"===r?"4d00":"6400";const i=Number(n[2]);e+=(i>>4).toString(16),e+=(15&i).toString(16),t=t.replace(n[0],e)}return t},parseMPD:function(e,t,n={}){let r,i,o,s,a,u;function c(e,t){return e.mimeType?0===e.mimeType.indexOf(t):e.representations.find((e=>0===e.mimeType.indexOf(t)))}function l(e,t){let r;return"audio"===t&&n.audioLang&&(r=e[0].adaptationSets.find((e=>e.lang===n.audioLang&&c(e,t)))),r||(r=e[0].adaptationSets.find((e=>c(e,t)))||{}),(r.representations||[]).map((e=>{var t;return g(g({},e),{},{avg_bitrate:e.bandwidth,base_url:"",bitrate:e.bandwidth,duration:o,framerate:Eo(e.frameRate),init_segment_url:e.initSegment,max_segment_duration:s,mime_type:null!==(t=r.mimeType)&&void 0!==t?t:e.mimeType})}))}function d(e,t){const n=[];for(let r=0;r<e.length;r++){const i=mo(e[r].attributes),o=e[r].getElementsByTagName("Representation");i.representations=h(o,t),i.frameRate&&i.representations.forEach((e=>{e.framerate=parseInt(i.frameRate,10)})),1===i.representations.length&&(i.width&&(i.representations[0].width=i.width),i.height&&(i.representations[0].height=i.height)),n.push(i)}return n}function h(e,t){const n=[];for(let r=0;r<e.length;r++){const i=mo(e[r].attributes),o=e[r].getElementsByTagName("SegmentList")[0];let s="";e[r].getElementsByTagName("BaseURL")[0]&&(s=e[r].getElementsByTagName("BaseURL")[0].textContent),o&&Object.assign(i,p(o,s,t));const a=e[r].getElementsByTagName("SegmentTemplate")[0];a&&Object.assign(i,f(a,i)),n.push(i)}return n}function f(e,t){const n=e.getElementsByTagName("S")[0],r=e.getElementsByTagName("S"),i=mo(e.attributes);i.startNumber=parseInt(i.startNumber,10),Number.isNaN(i.startNumber)&&(i.startNumber=1),i.timescale=parseInt(i.timescale,10)||1,i.initSegment=i.initialization.replace("$RepresentationID$",t.id),i.segments=[];let o=go(n,"t")/i.timescale,s=i.startNumber;for(let a=0;a<r.length;a++){const e=r[a],n=go(e,"d")/i.timescale,u=parseInt(go(e,"r")||0,10)+1;for(let r=0;r<u;r++){const e=o+n,r=i.media.replace("$RepresentationID$",t.id).replace("$Time$",o).replace("$Number$",s);i.segments.push({url:r,start:o,end:e,index:s}),o+=n,s+=1}}return i}function p(e,t,n){const r=e.getElementsByTagName("Initialization")[0],i=e.getElementsByTagName("SegmentURL"),o=mo(e.attributes);o.startNumber=parseInt(o.startNumber,10),o.initSegment=t+go(r,"sourceURL"),o.segments=[];let s=0;const a=o.duration/o.timescale;for(let u=0;u<i.length;u++){let e=s+a;if(e>n){if(u!==i.length-1)throw new Error("segment list duration is greater than the period's duraton");e=s+(n-s)}const r=go(i[u],"media");o.segments.push({url:t+r,start:s,end:e}),s+=a}return o}return function(){const n=(new DOMParser).parseFromString(e,"application/xml");r=n.getElementsByTagName("MPD")[0],i=function(){const e=function(e,t){let n=function(e,t){return Array.prototype.filter.call(e.childNodes,(function(e){return e instanceof Element&&e.tagName===t}))}(e,t);return 1!==n.length?null:n[0]}(r,"BaseURL");return e&&To(e)||t.substr(0,t.lastIndexOf("/")+1)}(),o=So(go(r,"mediaPresentationDuration")),s=So(go(r,"maxSegmentDuration"));const c=function(){const e=[],t=r.getElementsByTagName("Period");for(let n=0;n<t.length;n++){const r=mo(t[n].attributes),i=t[n].getElementsByTagName("AdaptationSet");r.adaptationSets=d(i,r.duration),e.push(r)}return e}();return c.length&&(a=l(c,"video"),u=l(c,"audio")),g(g({},function(){const e="urn:mpeg:cenc:2013",t=r.getElementsByTagName("ContentProtection");let n,i=[],o={};for(const r in t){const s=t[r];if(!(s instanceof Element))continue;let a=go(s,"schemeIdUri");a&&bo[a]&&i.push(bo[a]),n||(n=yo(s,e,"default_KID"));const u=vo(s,e,"pssh").map(To);let c=[];try{c=u.map((e=>({initDataType:"cenc",initData:e})))}catch(Rp){throw new Error("Bad pshh encoding")}c.length>0&&(o[bo[a]]=o[bo[a]]||{},o[bo[a]].cenc=c[0]);const l=vo(s,"usn:microsoft:playready","pro").map(To);c=[];try{c=l.map((e=>({initDataType:"mspr",initData:e})))}catch(Rp){throw new Error("Bad pro encoding")}c.length>0&&(o[bo[a]]=o[bo[a]]||{},o[bo[a]].mspr=c[0])}return n?{is_drm:!0,key_info:{cdms:T(new Set(i)),key_id:n,inits:o}}:{}}()),{},{audio:u,video:a,mediaPresentationDuration:o,maxSegmentDuration:s,baseUrl:i,base_url:i,get profiles(){return go(r,"profiles")},get type(){return go(r,"type")},get minimumUpdatePeriod(){return So(go(r,"minimumUpdatePeriod"))},get publishTime(){return go(r,"publishTime")},get availabilityStartTime(){return go(r,"availabilityStartTime")},get timeShiftBufferDepth(){return So(go(r,"timeShiftBufferDepth"))},get suggestedPresentationDelay(){return So(go(r,"suggestedPresentationDelay"))},get minBufferTime(){return So(go(r,"minBufferTime"))}})}()}});function wo(e,t,n){return n?t?t(e):e:(e&&e.then||(e=Promise.resolve(e)),t?e.then(t):e)}let Io=function(e){function t(t){var n;return(n=e.call(this,t)||this)._videoElement=document.createElement("video"),n._videoElement.setAttribute("data-airplay",""),n._videoElement.setAttribute("x-webkit-airplay","allow"),n.addVideoEventListeners(),n}p(t,e);var n=t.prototype;return n.addVideoEventListeners=function(e=this._videoElement){e.addEventListener(Di.LOADED_METADATA,(e=>{this.fire(Di.LOADED_METADATA,e)})),e.addEventListener("webkitplaybacktargetavailabilitychanged",(e=>{switch(e.availability){case"available":this._available||(this._available=!0,this.fire(Ci.AIRPLAY_AVAILABLE));break;case"not-available":this._available&&(this._available=!1,this.fire(Ci.AIRPLAY_UNAVAILABLE))}})),e.addEventListener("webkitcurrentplaybacktargetiswirelesschanged",(e=>{if(e.target.webkitCurrentPlaybackTargetIsWireless)return this._active=!0,void this.fire(Ci.AIRPLAY_ACTIVATED);this._active=!1,this.fire(Ci.AIRPLAY_DEACTIVATED)}))},n.showPicker=function(){this._videoElement.webkitShowPlaybackTargetPicker(),this.loadMetadata().then((()=>this._videoElement.webkitShowPlaybackTargetPicker())).catch((()=>{}))},n.loadMetadata=function(){try{const e=this;return e._videoElement.readyState>=1?Promise.resolve():wo(new Promise(function(e){return function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];try{return Promise.resolve(e.apply(this,t))}catch(Rp){return Promise.reject(Rp)}}}((function(t){return e._videoElement.addEventListener(Di.LOADED_METADATA,(()=>{t()})),wo(Qi(e.getFile().src),(function(t){e._videoElement.src=t}))}))))}catch(Rp){return Promise.reject(Rp)}},l(t,[{key:"element",get:function(){return this._videoElement},set:function(e){if(!(e instanceof HTMLVideoElement))throw new TypeError("The element for AirPlay must be a <video>.");e!==this._videoElement&&(this.addVideoEventListeners(e),this._videoElement=e,this._videoElement.setAttribute("x-webkit-airplay","allow"))}}],[{key:"displayName",get:function(){return"AirPlayExternalDisplay"}},{key:"supported",get:function(){return"WebKitPlaybackTargetAvailabilityEvent"in window}},{key:"supportedVideoTypes",get:function(){return["application/vnd.apple.mpegurl","video/mp4"]}}])}(Pi);(()=>{const e=navigator.userAgent.match(/Chrom(?:e|ium)\/([0-9]+)\.([0-9]+)\./);e&&(parseInt(e[1],10),parseInt(e[2],10))})();const Ro=function(e){for(let t=0,n=this.length;t<n;t++)if(this[t].id===`${e}`)return this[t];return null};function ko(e=[]){return e.item=function(e){return this[e]},e.getTrackById=Ro,e}function Po(e){const t=window.atob(e),n=t.length,r=new Uint8Array(n);for(let i=0;i<n;i++)r[i]=t.charCodeAt(i);return r}function Do(e,t,n,r){let i=0,o=0,s=0,a=0;const u=e,c=t,l=n/r;return u/c>=l?(o=c,i=(l*c).toFixed(2)):(i=u,o=(u/l).toFixed(2)),s=Math.max((u-i)/2,0),a=Math.max((c-o)/2,0),{width:i,height:o,left:s,top:a}}function Oo(e){if(function(e){return"webkitDisplayingFullscreen"in e&&e.webkitDisplayingFullscreen}(e))return!0;const t=[document.fullscreenElement,document.webkitFullscreenElement,document.webkitCurrentFullScreenElement,document.mozFullScreenElement,document.msFullscreenElement].find((e=>void 0!==e));return Boolean(t)}function Lo(e,t){let n=e;return t&&(n+=`;codecs="${t}"`),n}function Co(e,t=3){if(e=parseFloat(e),isNaN(e))return 0;const n=Math.pow(10,t);return Math.round(e*n)/n}let No=function(e,t){this.name=e,this.message=t,Object.freeze(this)};const Mo=new WeakMap;let xo=function(){function e(e,t={}){const n=parseFloat(e);if(isNaN(n))throw new TypeError("Time must be a number.");if(n<0)throw new TypeError("Time must be a positive number.");this.time=e,this.data=t,this.id=Z();try{const n="undefined"==typeof VTTCue?TextTrackCue:VTTCue;this.vttCue=new n(e,e+.25,JSON.stringify(t)),this.vttCue.id=this.id}catch(Rp){throw new No("CuePointsNotSupported","Cue points are not supported in this browser.")}Mo.set(this.vttCue,this),Object.freeze(this)}return e.fromVTTCue=function(t){if(Mo.has(t))return Mo.get(t);let n={};try{n=JSON.parse(t.text)}catch(Rp){}return new e(t.startTime,n)},e}();function Uo(e,t,n){let r;try{document.removeChild({})}catch(Rp){r=Object.create(Object.getPrototypeOf(Rp),{name:{value:t,configurable:!0,writable:!0},code:{value:e,configurable:!0,writable:!0},message:{value:n,configurable:!0,writable:!0},toString:{value:()=>`${t}: DOM Exception ${e}`,configurable:!0,writable:!0}})}return Object.freeze(r)}const Fo=(e,t)=>{if(!e||void 0===e[t])throw Uo(1,"INDEX_SIZE_ERR");return e[t]};function jo(e=[],t=[]){return Object.freeze({get length(){return e.length},start:t=>Fo(e,t),end:e=>Fo(t,e),[Symbol.iterator]:()=>function(e,t){let n=0;return{[Symbol.iterator](){return this},next:()=>n<e.length?{done:!1,value:t?[e[n],t[n++]]:e[n++]}:{done:!0}}}(e,t)})}jo.from=function(e){if(!(e instanceof TimeRanges))throw new TypeError("Can only create a TelecineTimeRange from a TimeRanges object.");const t=[],n=[];for(let r=0,i=e.length;r<i;r++)t.push(e.start(r)),n.push(e.end(r));return jo(t,n)};const Vo="DRMFailure",Bo="MediaUnknownError",Ho="MediaUrlBadRequest",Xo="PlayInterrupted",Wo="TextTracksNotSupported",qo="inline",Go="picture-in-picture";function Ko(){}const Yo=document.createElement("video"),$o={"application/vnd.apple.mpegurl":"application/vnd.apple.mpegurl","video/mp4":'video/mp4; codecs="avc1.64001E"',"video/webm":'video/webm; codecs="vp8, vorbis"',"video/x-flv":'video/x-flv; codecs="vp6"'},zo=function(){const e="undefined"==typeof TextTrack?{}:TextTrack;return{disabled:"DISABLED"in e?e.DISABLED:"disabled",hidden:"HIDDEN"in e?e.HIDDEN:"hidden",showing:"SHOWING"in e?e.SHOWING:"showing"}}();function Qo(e,t,n){return n?t?t(e):e:(e&&e.then||(e=Promise.resolve(e)),t?e.then(t):e)}const Jo=function(){const e=document.createElement("track");return"track"in e&&"oncuechange"in e.track}(),Zo=new WeakMap;let es=function(e){function t(t,n={}){var r;(r=e.call(this)||this)._element=t,r._options=n,r._telecineVideo=null,r._currentFile=null,r._externalDisplays=[];let i=t.querySelector("video");return i||(i=document.createElement("video"),i.preload="none",r._element.appendChild(i)),i.setAttribute("tabindex","-1"),r._video=i,n.playRequest&&(r._playRequest=n.playRequest,r._playRequest.video=i),n.htmlScanner&&n.htmlScanner.controls&&(r._video.controls=!0),r._boundHandleVideoEvent=r.handleVideoEvent.bind(r),r._boundHandleAudioEvent=r.handleAudioEvent.bind(r),r.addVideoEventListeners(),r.addAudioEventListeners(),r._preload="none",r._externalDisplayActivated=!1,r._inFullscreen=!1,r._lastCurrentTime=-1,r._switchingVideo=!1,r}p(t,e),t.supported=function(){return t.supportedVideoTypes.length>0};var n=t.prototype;return n.deactivate=function(){this._telecineVideo&&(this._telecineVideo.off(Ni.FILE_SRC_UPDATE),this._telecineVideo.off("texttracksrcupdate")),this.removeVideoEventListeners(),this.removeAudioEventListeners(),this._switchingVideo||this.removeSnapshot(),this._video.style.display="none"},n.reactivate=function(){this.addVideoEventListeners(),this.addAudioEventListeners(),this._video.style.display=""},n.addVideoEventListeners=function(e=this._video){Object.keys(Di).forEach((t=>{const n=Di[t];e.addEventListener(n,this._boundHandleVideoEvent)}))},n.addAudioEventListeners=function(e=this._video){var t;null!=e&&e.audioTracks&&"function"==typeof(null==(t=e.audioTracks)?void 0:t.addEventListener)&&(e.audioTracks.addEventListener(Oi.ADD_TRACK,this._boundHandleAudioEvent),e.audioTracks.addEventListener(Oi.REMOVE_TRACK,this._boundHandleAudioEvent),e.audioTracks.addEventListener(Oi.CHANGE,this._boundHandleAudioEvent))},n.removeVideoEventListeners=function(e=this._video){Object.keys(Di).forEach((t=>{const n=Di[t];e.removeEventListener(n,this._boundHandleVideoEvent)}))},n.removeAudioEventListeners=function(e=this._video){var t;null!=e&&e.audioTracks&&"function"==typeof(null==(t=e.audioTracks)?void 0:t.removeEventListener)&&(e.audioTracks.removeEventListener(Oi.ADD_TRACK,this._boundHandleAudioEvent),e.audioTracks.removeEventListener(Oi.REMOVE_TRACK,this._boundHandleAudioEvent),e.audioTracks.removeEventListener(Oi.CHANGE,this._boundHandleAudioEvent))},n.play=function(e){return this._playRequest.start(e).catch((e=>{var t;if("sd-fallback"!==(null==(t=this._telecineVideo.drmHandler)?void 0:t.state)||"AbortError"!==e.name)throw this._onPlayError(e),e}))},n._onPlayError=function(e){this.fire(Di.ERROR,new No(null==e?void 0:e.name,null==e?void 0:e.message))},n.pause=function(){this._playRequest.cancel(),this._video.pause()},n.onpause=function(){},n.ontimeupdate=function(){this._lastCurrentTime=this.currentTime},n.addTextTrack=function(e){let t,n;return e.src?(t=document.createElement("track"),t.kind=e.kind,t.src=e.src,t.id=`telecine-track-${e.id}`,t.srclang=e.language,t.label=e.label,this._video.appendChild(t),n=t.track):(n=this._video.addTextTrack(e.kind,e.label,e.language),this._textTracks=this._textTracks||{},this._textTracks[`telecine-track-${e.id}`]=n),this._addTextTrackListeners(e,n,t),n},n._addTextTrackListeners=function(e,t,n){t.addEventListener("cuechange",(()=>e.dispatchEvent("cuechange"))),this._video.addEventListener("timeupdate",(()=>{Oo(this._video)&&(e.mode=t.mode)}));const r=()=>{const n=ze.iOS&&Oo(this._video);!e._modeHasBeenSet||n?e.mode=t.mode:t.mode=zo[e.mode]},i=[];if(n?n.addEventListener("load",r):r(),["loadeddata","seeking"].forEach((e=>{this._video.addEventListener(e,r),i.push([e,r])})),e._modeHasBeenSet&&(t.mode=zo[e.mode]),!Jo){let n=[];const r=()=>{if(t&&"disabled"!==zo[t.mode]){if(n.length!==t.activeCues.length)return e.dispatchEvent("cuechange"),void(n=Array.from(t.activeCues));for(let r=0,i=t.activeCues.length;r<i;r++)if(t.activeCues[r].startTime!==n[r].startTime)return e.dispatchEvent("cuechange"),void(n=Array.from(e.activeCues))}};this._video.addEventListener("timeupdate",r),i.push(["timeupdate",r])}return Zo.set(e,i),t},n.removeTextTrack=function(e){const t=this._video.querySelector(`#telecine-track-${e.id}`);t&&this._video.removeChild(t);const n=Zo.get(e);Array.isArray(n)&&n.forEach((([e,t])=>{this._video.removeEventListener(e,t)}))},n.getCuesForTrack=function(e){const t=this.getTrackById(`telecine-track-${e.id}`);return t?Array.from(t.cues):[]},n.getActiveCuesForTrack=function(e){const t=this.getTrackById(`telecine-track-${e.id}`);return t&&t.activeCues?Array.from(t.activeCues):[]},n.setModeForTrack=function(e,t){const n=this.getTrackById(`telecine-track-${e.id}`);return n&&n.mode!==zo[t]&&(n.mode=zo[t],Jo||"disabled"===t||e.dispatchEvent("cuechange")),this},n.setSrcForTrack=function(e,t){const n=this._video.querySelector(`#telecine-track-${e.id}`);return n&&null===n.track.cues&&(n.src=t),this},n.enableAudioTrack=function(e){if(!this.constructor.supportsVideoElementAudioTracks||!this.audioTracks)return null;if(!e)return null;if(!this.audioTracks.getTrackById(e))return null;let t=null;for(let n=0;n<this.audioTracks.length;n++){const r=this.audioTracks[n].id===e;this.audioTracks[n].enabled=r,r&&(t=this.audioTracks[n])}return t},n._createChapterCue=function(e,t,n=null){let r;this._chaptersTrack||(this._chaptersTrack=this._video.addTextTrack("chapters"),this._chaptersTrack.mode="hidden");const i=e.timecode,o=n?n.timecode:t,s=window.VTTCue||window.TextTrackCue;try{r=new s(i,o,e.title)}catch(Rp){throw new No("ChaptersNotSupported","Chapters are not supported in this browser.")}r.size=(o-i)/t,r.id=i,this._chaptersTrack.addCue(r)},n.addChapter=function(e,t){const n=this.video.chapters,r={timecode:e,title:t};n.push(r),n.sort(((e,t)=>e.timecode-t.timecode));const i=n[n.indexOf(r)+1];this._createChapterCue(r,this.video.duration,i),this._updateChapterCues(this._chaptersTrack,this.video.duration)},n.removeChapter=function(e){try{this._chaptersTrack.removeCue(e)}catch(Rp){throw new No("ChaptersNotSupported","Chapters are not supported in this browser.")}const t=this.video.chapters.find((t=>t.timecode===e.timecode));this.video.chapters.splice(t,1),this._updateChapterCues(this._chaptersTrack,this.video.duration)},n._updateChapterCues=function(e,t){for(let n=0;n<e.cues.length;n++){let r=e.cues[n],i=e.cues[n+1];const o=i?i.startTime:t;r.endTime=o,r.size=(o-r.startTime)/t}this.fire(Ni.CHAPTER_CUES_UPDATED)},n.addChapters=function(e,t){0!==e.length&&t&&(e=e.filter((e=>this._isValidChapter(e,t)))).sort(((e,t)=>e.timecode-t.timecode)).forEach(((n,r)=>this._createChapterCue(n,t,e[r+1])))},n.addCuePoint=function(e,t={}){if(this._cuePointTrack||(this._cuePointTrack=this._video.addTextTrack("metadata"),this._cuePointTrack.mode="hidden",this._cuePointTrack.addEventListener("cuechange",(e=>{Array.from(e.target.activeCues).forEach((e=>{this.fire(Ni.CUE_POINT,xo.fromVTTCue(e))}))})),this._video.addEventListener("canplay",(e=>{this._cuePointTrack.mode="hidden"}))),e=parseFloat(e),isNaN(e))throw new TypeError("Time must be a number.");if(e<0||e>=this.duration)throw new TypeError("Time must be a positive number less than the duration of the video.");const n=new xo(e,t);return this._cuePointTrack.addCue(n.vttCue),n},n.removeCuePoint=function(e){if(!e)throw new No("InvalidCuePoint","The specified cue point is not valid.");return this._cuePointTrack.removeCue(e.vttCue),!0},n.removeAllCuePoints=function(){return this._cuePointTrack&&this._cuePointTrack.length&&Array.from(this._cuePointTrack.cues).forEach((e=>{this._cuePointTrack.removeCue(e)})),!0},n.requestPictureInPicture=function(){try{const e=this;return Qo(function(t,n){var r=function(){if(e._video.readyState<1)return function(e){if(!void 0)return e&&e.then?e.then(Ko):Promise.resolve()}(e._initPreload())}();return r&&r.then?r.then(n):n()}(0,(function(){switch(ze.pictureInPictureSupportType){case"pip-api":return e._video.requestPictureInPicture();case"webkit-presentation-mode":return e._video.webkitSetPresentationMode(Go);default:throw new Error("Picture-in-picture is not supported by this browser")}})))}catch(Rp){return Promise.reject(Rp)}},n._initPreload=function(){return this.preload="auto",new Promise((e=>{this.once(Di.LOADED_METADATA,e)}))},n.exitPictureInPicture=function(){try{const e=this;switch(ze.pictureInPictureSupportType){case"pip-api":return Qo(document.exitPictureInPicture());case"webkit-presentation-mode":return Qo(e._video.webkitSetPresentationMode(qo));default:throw new Error("Picture-in-picture is not supported by this browser")}}catch(Rp){return Promise.reject(Rp)}},n.onerror=function(){if(!this._video.error)return!1;switch(this._video.error.code){case this._video.error.MEDIA_ERR_SRC_NOT_SUPPORTED:return this._fireVideoError("MediaSrcNotSupportedError","The media was not suitable."),this._switchToNextFile(),!1;case this._video.error.MEDIA_ERR_DECODE:return-1!==this._lastCurrentTime&&ze.iOS?(this._video.load(),this.currentTime=this._lastCurrentTime,this._lastCurrentTime=-1,!1):(this._fireVideoError("MediaDecodeError","The media could not be decoded."),this._switchToNextFile(),!1);case this._video.error.MEDIA_ERR_NETWORK:return this._fireVideoError("MediaNetworkError","A network error ocurred while fetching the media."),!1;case this._video.error.MEDIA_ERR_ABORTED:return this._fireVideoError("MediaAbortedError","The user agent aborted the fetching of the media."),!1;default:return this._fireVideoError(Bo,"An unknown error occurred."),!1}},n._fireVideoError=function(e,t){this.fire(Di.ERROR,new No(e,t))},n.onended=function(){if(this._video.paused||this._video.pause(),this.currentTime<this._video.duration)return!1},n.onwaiting=function(){return!1},n.onwebkitbeginfullscreen=function(){this._inFullscreen=!0},n.onwebkitendfullscreen=function(){this._video.webkitPresentationMode===qo&&!0===this._video.controls&&(this._video.controls=!1),this._inFullscreen=!1},n.onwebkitpresentationmodechanged=function(){this.fire(this.pictureInPictureActive?Di.ENTER_PICTURE_IN_PICTURE:Di.LEAVE_PICTURE_IN_PICTURE)},n.shouldHandleVideoEvent=function(e){return!0},n.handleVideoEvent=function(e){e.target===this._video&&!1!==this.shouldHandleVideoEvent(e)&&("function"==typeof this[`on${e.type}`]&&!1===this[`on${e.type}`](e)||this.fire(e.type))},n.handleAudioEvent=function(){this.fire(Ni.AUDIO_TRACK_CHANGED)},n.swapVideo=function(e,t){const n=e.paused;this.removeVideoEventListeners(e),this.removeAudioEventListeners(e),e.parentElement.replaceChild(t,e),e.pause(),t.currentTime=e.currentTime,n||t.play(),this.addVideoEventListeners(t),this.addAudioEventListeners(t),this._video=t},n.onexternaldisplayactivated=function(e){this._externalDisplayActivated||(this._video!==e.element&&(this._originalVideo=this._video,this.swapVideo(this._video,e.element)),this._externalDisplayActivated=!0)},n.onexternaldisplaydeactivated=function(e){this._externalDisplayActivated&&(this._originalVideo&&(this.swapVideo(e.element,this._originalVideo),this._originalVideo=null),this._externalDisplayActivated=!1)},n.setVideoSrc=function(e){this._video.src=e},n.canSeekTo=function(e){const t=this.duration;if(t&&e>t&&(e=t),this._video.seekable.length>0)for(let n=0,r=this._video.seekable.length;n<r;n++)if(this._video.seekable.start(n)<=e&&this._video.seekable.end(n)>=e)return!0;return!1},n.seekToTime=function(e){return this.canSeekTo(e)?(this._video.currentTime=e,Promise.resolve(this._video.currentTime)):new Promise((t=>{const n=()=>{this.canSeekTo(e)&&(Object.keys(Di).forEach((e=>{const t=Di[e];this._video.removeEventListener(t,n)})),this._video.currentTime=e,t(this._video.currentTime))};Object.keys(Di).forEach((e=>{const t=Di[e];this._video.addEventListener(t,n)}))}))},n.takeSnapshot=function(){let e=this._element.querySelector("[telecine-snapshot]");e||(e=document.createElement("canvas"),e.setAttribute("telecine-snapshot",""),this._element.appendChild(e)),e.setAttribute("width",`${this._element.clientWidth}px`),e.setAttribute("height",`${this._element.clientHeight}px`),e.style.display="";const{width:t,height:n,left:r,top:i}=Do(this._video.clientWidth,this._video.clientHeight,this._video.videoWidth,this._video.videoHeight);e.style.cssText=`position:absolute;width:${t}px;height:${n}px;left:${r}px;top:${i}px`;const o=e.getContext("2d");e.width>0&&e.height>0&&o.drawImage(this._video,0,0,e.width,e.height)},n.removeSnapshot=function(){const e=this._element.querySelector("[telecine-snapshot]");e&&(e.style.display="none")},n.getTrackById=function(e){if(this._textTracks&&this._textTracks[e])return this._textTracks[e];if("function"==typeof this._video.textTracks.getTrackById)return this._video.textTracks.getTrackById(e);const t=document.getElementById(e);return t?t.track:null},n.initDrm=function(){const e=this._telecineVideo.drmHandler;e&&e.init(this)},n.showExternalDisplayPicker=function(e){if(!this._externalDisplays.length)throw new No("ExternalDisplayUnvailable","No external displays are available.");if(!e)return void this._externalDisplays[0].showPicker();const t=this._externalDisplays.filter((t=>t.constructor.displayName.replace("ExternalDisplay","")===e))[0];if(!t)throw new No("InvalidExternalDisplay","The specified external display is not available.");t.showPicker()},n.setCaptionsShouldDisplay=function(e){},n.setCaptionsShouldLoad=function(e){},n._pickFile=function(){if(this._files.length<1)return null;const e=this._files.slice(0).sort(((e,t)=>e.priority-t.priority));return e[0]},n._updateCurrentFile=function(){const e=this._pickFile();e?this.currentFile=e:this.fire(Ni.SCANNER_ERROR,{reason:"all files failed"})},n._isValidChapter=function(e,t){return void 0!==e.timecode&&e.timecode>=0&&e.timecode<=t&&void 0!==e.title},n._switchToNextFile=function(){const e=this._files.indexOf(this._currentFile);this._files.splice(e,1),this._updateCurrentFile()},l(t,[{key:"audioTracks",get:function(){return this._video.audioTracks}},{key:"chaptersTrack",get:function(){return this._chaptersTrack}},{key:"manifest",get:function(){return this._manifest}},{key:"manifestLoaded",get:function(){return!!this._manifest}},{key:"buffered",get:function(){return jo.from(this._video.buffered)}},{key:"cuePoints",get:function(){var e,t;return null!=(e=this._cuePointTrack)&&e.cues&&"function"==typeof(null==(t=this._cuePointTrack)?void 0:t.cues[Symbol.iterator])?Array.from(this._cuePointTrack.cues).map((e=>xo.fromVTTCue(e))):[]}},{key:"currentFile",get:function(){return this._currentFile},set:function(e){const n=!this._video.paused,r=this.currentTime,i=!this._currentFile||e.video.id!==this._currentFile.video.id;if(i||this.takeSnapshot(),this._currentFile=e,i&&(this._video.preload=this._preload),this.constructor===t&&this._video.readyState>0&&(this._video.currentTime=0),(ze.iOS||ze.android)&&this._currentFile.video.title){let e=this._currentFile.video.title;this._currentFile.video.subtitle&&(e=`${e} ${this._currentFile.video.subtitle}`),this._video.setAttribute("title",e)}else this._video.removeAttribute("title");this.setVideoSrc(this._currentFile.src,i),this.fire(Ni.CURRENT_FILE_CHANGE,e),ze.iOS&&!i&&this.play().catch(this._onPlayError.bind(this)),this.constructor!==t||i?n&&this.play().catch(this._onPlayError.bind(this)):(this.seekToTime(r).then((e=>(n&&this.play().catch(this._onPlayError.bind(this)),e))).catch((()=>{})),this.once("canplay",(()=>this.removeSnapshot())),this.once("playing",(()=>this.removeSnapshot())))}},{key:"currentTime",get:function(){return this._video.currentTime},set:function(e){this.seekToTime(e)}},{key:"duration",get:function(){return this._video.duration}},{key:"ended",get:function(){return this._video.ended}},{key:"externalDisplayAvailable",get:function(){return this._externalDisplays.some((e=>e.available))}},{key:"externalDisplayActive",get:function(){return this._externalDisplays.some((e=>e.active))}},{key:"loop",get:function(){return this._video.loop},set:function(e){this._video.loop=e}},{key:"isLowerProfileAvailable",get:function(){return null}},{key:"muted",get:function(){return this._video.muted},set:function(e){this._video.muted=e}},{key:"playsinline",get:function(){return this._video.playsinline},set:function(e){this._video.playsinline=e,e?this._video.setAttribute("playsinline",""):this._video.removeAttribute("playsinline")}},{key:"paused",get:function(){return this._video.paused}},{key:"defaultPlaybackRate",get:function(){return this._video.defaultPlaybackRate},set:function(e){this._video.defaultPlaybackRate=e}},{key:"playbackRate",get:function(){return this._video.playbackRate},set:function(e){this._video.playbackRate=e}},{key:"played",get:function(){return this._video.played}},{key:"seekable",get:function(){return this._video.seekable}},{key:"seeking",get:function(){return this._video.seeking}},{key:"preload",get:function(){return this._preload},set:function(e){this._video.preload=e,this._preload=e}},{key:"autoPictureInPicture",get:function(){return this._video.autoPictureInPicture},set:function(e){this._video.autoPictureInPicture=e}},{key:"disablePictureInPicture",get:function(){return this._video.disablePictureInPicture},set:function(e){this._video.disablePictureInPicture=e}},{key:"pictureInPictureActive",get:function(){return this._video.webkitPresentationMode===Go||!!document.pictureInPictureElement}},{key:"isPlayRequestActive",get:function(){var e,t;return null!==(e=null==(t=this._playRequest)?void 0:t.active)&&void 0!==e&&e}},{key:"pictureInPictureEnabled",get:function(){if(this.disablePictureInPicture)return!1;switch(ze.pictureInPictureSupportType){case"pip-api":return document.pictureInPictureEnabled;case"webkit-presentation-mode":return!0;default:return!1}}},{key:"video",get:function(){return this._telecineVideo},set:function(e){if(this.reactivate(),this._telecineVideo!==e){if(this._telecineVideo&&(this._telecineVideo.off(Ni.FILE_SRC_UPDATE),this._telecineVideo.off("texttracksrcupdate")),this.removeAllCuePoints(),this._telecineVideo=e,this._files=e.files.filter((e=>-1!==this.constructor.supportedVideoTypes.indexOf(e.mime))),this._telecineVideo.on(Ni.FILE_SRC_UPDATE,(e=>{e===this._currentFile&&this._updateCurrentFile()})),this._telecineVideo.on("texttracksrcupdate",(e=>{this.video.currentScanner&&this.video.currentScanner.setSrcForTrack(e,e.src)})),this._options.externalDisplays&&this._options.externalDisplays.length){this._externalDisplays=[];let t=this.constructor.supportedExternalDisplays;Array.isArray(t)||(t=[]);const n=t.map((e=>e.displayName));this._options.externalDisplays.filter((e=>e.supported&&-1!==n.indexOf(e.displayName))).forEach((t=>{const n=new t(e),r=t.displayName.replace("ExternalDisplay","");n.on(Di.LOADED_METADATA,(e=>this.fire(Di.LOADED_METADATA,e))),n.on("available",(()=>this.fire(Li.AVAILABLE,{type:r}))),n.on("unavailable",(()=>this.fire(Li.UNAVAILABLE,{type:r}))),n.on("activated",(()=>{"function"==typeof this.onexternaldisplayactivated&&this.onexternaldisplayactivated(n),this.fire(Li.ACTIVATED,{type:r})})),n.on("deactivated",(()=>{"function"==typeof this.onexternaldisplaydeactivated&&this.onexternaldisplaydeactivated(n),this.fire(Li.DEACTIVATED,{type:r})})),this._externalDisplays.push(n)}))}this._updateCurrentFile(),ze.iOS&&this._externalDisplays.forEach((e=>{"AirPlay"===e.constructor.displayName&&(e.element=this._video)})),this.initDrm()}}},{key:"videoElement",get:function(){return this._video}},{key:"videoWidth",get:function(){return this._video.videoWidth}},{key:"videoHeight",get:function(){return this._video.videoHeight}},{key:"volume",get:function(){return M(this._video.volume)},set:function(e){this._video.volume=N(e)}},{key:"readyState",get:function(){return this._video.readyState}}],[{key:"displayName",get:function(){return"HTMLScanner"}},{key:"supportedVideoTypes",get:function(){const e=[];if("function"!=typeof Yo.canPlayType)return e;for(const t in $o){const n=$o[t];ze.android&&"application/vnd.apple.mpegurl"===t||(ze.android&&!ze.mobileAndroid&&"video/mp4"===t&&ze.android instanceof String?parseInt(ze.android.split(".")[0],10)>3&&e.push(t):Yo.canPlayType(n).replace(/^no$/,"")&&e.push(t))}return e}},{key:"supportedAudioTypes",get:function(){return[]}},{key:"supportedExternalDisplays",get:function(){return[Io]}},{key:"supportsVideoElementAudioTracks",get:function(){return void 0!==Yo.audioTracks&&this.supportedVideoTypes.includes("application/vnd.apple.mpegurl")}}])}(bn);function ts(e,t=[]){if(0===e.length)return 0;let n=0,r=0;for(let i=0;i<e.length;i++){const o=t[i]||1;r+=o,n+=e[i]*o}return n/r}function ns(e){const t=T(e).sort(((e,t)=>e-t)),n=Math.floor(t.length/2);return t.length%2?t[n]:(t[n-1]+t[n])/2}let rs=function(e){function t(){return e.apply(this,arguments)||this}return p(t,e),t}(A(Error));function is(e,t,n){return n?t?t(e):e:(e&&e.then||(e=Promise.resolve(e)),t?e.then(t):e)}const os=ss((function(e,t){const n=this;return function(e,t){var i=function(){if(!o(ys,n))return is(r(Rs,n,Vs).call(n),(function(e){a(ys,n,new e({keepOriginalTimestamps:!0}))}))}();return i&&i.then?i.then(t):t()}(0,(function(){return new Promise((r=>{o(ys,n).on("data",(t=>{o(ys,n).off("data");let i=new Uint8Array(t.initSegment.byteLength+t.data.byteLength);i.set(t.initSegment,0),i.set(t.data,t.initSegment.byteLength),r(e.data.isInitSegmentRequest?t.initSegment:i)})),o(ys,n).push(new Uint8Array(t)),o(ys,n).flush()}))}))}));function ss(e){return function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];try{return Promise.resolve(e.apply(this,t))}catch(Rp){return Promise.reject(Rp)}}}const as=ss((function(){const e=this;return function(){var t=function(){if(o(Es,e))return function(e){if(!void 0)return e&&e.then?e.then(us):Promise.resolve()}(o(Es,e))}();if(t&&t.then)return t.then(us)}()}));function us(){}var cs=new WeakMap,ls=new WeakMap,ds=new WeakMap,hs=new WeakMap,fs=new WeakMap,ps=new WeakMap,_s=new WeakMap,ms=new WeakMap,vs=new WeakMap,gs=new WeakMap,ys=new WeakMap,Es=new WeakMap,Ts=new WeakMap,Ss=new WeakMap,bs=new WeakMap,As=new WeakMap,ws=new WeakMap,Is=new WeakMap,Rs=new WeakSet;let ks=function(e){function t(t={}){var n;u(n=e.call(this)||this,Rs),s(n,cs,void 0),s(n,ls,void 0),s(n,ds,void 0),s(n,hs,100),s(n,fs,void 0),s(n,ps,void 0),s(n,_s,void 0),s(n,ms,new Set),s(n,vs,void 0),s(n,gs,!1),s(n,ys,void 0),s(n,Es,void 0),s(n,Ts,!1),s(n,Ss,[]),s(n,bs,[]),s(n,As,[]),s(n,ws,[]),s(n,Is,[]),a(ls,n,x("Fetcher","color: #586e75"));const{includeWithSpeeds:i=!0,parallel:o=1,retryAbortErrors:c=!0,retryCount:l=3,timeout:d=0}=t;return a(cs,n,i),a(ds,n,o),a(fs,n,c),a(ps,n,l),a(_s,n,d),r(Rs,n,Ds).call(n),n}p(t,e);var n=t.prototype;return n.getPercentileSpeed=function(e=5,t=.8){return function(e,t){if(0===e.length)return 0;const n=T(e).sort(((e,t)=>e-t));if(t<=0)return n[0];if(t>=1)return n[n.length-1];const r=n.length*t,i=Math.floor(r),o=i+1,s=r%1;return o>=n.length?n[i]:n[i]*(1-s)+n[o]*s}(o(Is,this).slice(-e),t)},n.getAverageSpeed=function(e=5,t=[]){return ts(o(Is,this).slice(-e),t)},n.getHarmonicAverageSpeed=function(e=5){return function(e){if(0===e.length)return 0;let t=0;for(let n=0;n<e.length;n++)t+=1/e[n];return e.length/t}(o(Is,this).slice(-e))},n.getMedianSpeed=function(e=5){return ns(o(Is,this).slice(-e))},n.getResponseSpeeds=function(){return o(Is,this)},n.getProgressSpeeds=function(){return o(ws,this)},n.getFailedSegments=function(){return o(bs,this)},n.getSuccessfulSegments=function(){return o(As,this)},n.resetResponseSpeeds=function(){o(Is,this).length=0},n.add=function(e){return new Promise(((t,n)=>{const i=r(Rs,this,Cs).call(this,e,t,n);r(Rs,this,Os).call(this,i),o(gs,this)&&!o(Ts,this)&&r(Rs,this,Ls).call(this)}))},n.abort=function(e=null){o(Ss,this).filter((t=>!e||e===t.stream)).forEach((e=>{e.reject(new rs("Stream manually aborted")),this.fire("downloadabort",e.identifier)})),a(Ss,this,o(Ss,this).filter((t=>e&&e!==t.stream))),o(ms,this).forEach((t=>{e&&e!==t.stream||t.request.abort()}))},n.start=function(){o(gs,this)||(a(gs,this,!0),r(Rs,this,Ls).call(this))},n.stop=function(){a(gs,this,!1)},n.saveResponseSpeeds=function(e,t,n){const r=t/1e3,i=e.perfTimings;if(o(cs,this)&&e.includeWithBandwidthChecks){const t=8*n,s=i&&n<=16e3;let a=t/r;if(e.excludeConnectTime&&n>16e3&&n<=2e5){const e=(50*Math.max(0,1-t/16e5)+150)/1e3;a=t/Math.max(.1,r-e)}else if(s){const e=i.fetchStart||i.workerStart||i.requestStart||0;a=t/(r-Math.max(0,i.responseStart-e)/1e3)}o(Is,this).push(a)}o(Is,this).length>100&&o(Is,this).shift()},l(t,[{key:"pendingFetches",get:function(){const e=[];return o(ms,this).forEach((t=>{const n=o(vs,this).get(t);n&&(n.elapsedTime=X()-t.data.requestSendTime,e.push(n))})),e}}])}(bn);function Ps(e){let t=0;for(;t<o(Ss,this).length&&!(o(Ss,this)[t].priority>e.priority);t++);o(Ss,this).splice(t,0,e)}function Ds(){a(vs,this,new WeakMap),window.addEventListener("online",(()=>{this.start(),o(Es,this)&&(o(Es,this).resolve(),a(Es,this,null))})),window.addEventListener("offline",(()=>{this.stop(),this.abort(),a(Es,this,V())}))}function Os(e){e.hasOwnProperty("priority")?r(Rs,this,Ps).call(this,e):o(Ss,this).push(e)}function Ls(){if(!o(gs,this))return;a(Ts,this,!0);const e=o(ds,this)-o(ms,this).size;for(let t=0;t<e;t++)r(Rs,this,Ms).call(this)}function Cs(e,t,n){let r=e;return"object"==typeof e&&e.id&&(r=e.id),Object.assign({},e,{identifier:r,resolve:t,reject:n})}function Ns(){0!==o(ms,this).size||0!==o(Ss,this).length?o(ms,this).size<o(ds,this)&&r(Rs,this,Ls).call(this):a(Ts,this,!1)}function Ms(){if(0===o(Ss,this).length)return void a(Ts,this,!1);const t=o(Ss,this).shift(),{url:n,byteRange:i,isInitSegmentRequest:s,identifier:u,stream:c,timeout:l}=t,d={stream:c,data:{url:n,isInitSegmentRequest:s,requestSendTime:X(),uuid:Z()}};let h=o(_s,this);"number"==typeof l&&l>=0&&(h=l);const f={url:n,type:e.SEGMENT,responseType:De.ARRAY_BUFFER,retry:o(ps,this),hooks:{beforeRetry:[r(Rs,this,as).bind(this)]},onDownloadProgress:r(Rs,this,xs).call(this,u,d),headers:i&&{Range:`bytes=${i}`},retryAbortErrors:o(fs,this),timeout:h};this.fire("downloadstart",u),d.request=Se(f).then(r(Rs,this,Us).call(this,d,t)).catch(r(Rs,this,js).call(this,d,t)),o(ms,this).add(d)}function xs(e,t){let n=0,r=0,i=X();return s=>{if(s.lengthComputable){const a=8*(s.loaded-r),u=X(),c=u-i,l={startTime:i,length:c,bitrate:a/(c/1e3),index:n};n>0&&(o(ws,this).length>=o(hs,this)&&o(ws,this).shift(),o(ws,this).push(l)),i=u,r=s.loaded,n+=1,o(vs,this).set(t,{bytesTotal:s.total,bytesLoaded:s.loaded,percent:s.loaded/s.total,identifier:e}),this.fire("progress",e)}}}function Us(e,t){const n=this,i=X(),{identifier:s,resolve:a}=t;return ss((function(u){let c=X()-i;return is(u.arrayBuffer(),(function(i){return Object.prototype.hasOwnProperty.call(u,"perfTimings")&&Object.prototype.hasOwnProperty.call(u.perfTimings,"responseStart")&&(t.perfTimings=u.perfTimings),e.data.duration=X()-e.data.requestSendTime,o(ms,n).delete(e),o(vs,n).delete(e),n.saveResponseSpeeds(t,c,i.byteLength),n.fire("downloadend",s,{request:e,response:u}),o(As,n).push({url:e.data.url,status:200,duration:e.data.duration}),is(r(Rs,n,Fs).call(n,e,i),(function(e){a(i=e),r(Rs,n,Ns).call(n)}))}))}))}function Fs(e,t){return e.data.url&&e.data.url.match(".ts$")?r(Rs,this,os).call(this,e,t):Promise.resolve(new Uint8Array(t))}function js(e,t){const{identifier:n,reject:i,size:s}=t;return t=>{const a=X()-e.data.requestSendTime;if(e.data.duration=a,t instanceof te)o(bs,this).push({url:e.data.url,status:"abort",duration:a}),this.fire("downloadabort",n);else if(t instanceof ne){const r=t.response.status;o(bs,this).push({url:e.data.url,status:r,duration:a}),this.fire("downloaderror",n,r)}else if(t instanceof ie){if(o(bs,this).push({url:e.data.url,status:"timeout",duration:a}),"number"==typeof s&&s>0&&t.timeoutMs>0){let e=8*s/(t.timeoutMs/1e3);e*=.5,o(ls,this).call(this,"Adding degraded speed of",e,"after timeout of",t.timeoutMs,"ms"),o(Is,this).push(e)}this.fire("downloadtimeout",n,{timeoutMs:t.timeoutMs})}o(vs,this).delete(e),o(ms,this).delete(e),i(t),r(Rs,this,Ns).call(this)}}function Vs(){return import("./mux-mp4.module.js").then((({default:e})=>e))}var Bs=new WeakMap,Hs=new WeakMap,Xs=new WeakMap,Ws=new WeakMap,qs=new WeakMap,Gs=new WeakMap,Ks=new WeakMap,Ys=new WeakMap,$s=new WeakMap,zs=new WeakMap,Qs=new WeakMap,Js=new WeakMap,Zs=new WeakMap,ea=new WeakMap,ta=new WeakMap,na=new WeakMap,ra=new WeakMap,ia=new WeakMap,oa=new WeakMap,sa=new WeakMap,aa=new WeakMap,ua=new WeakMap,ca=new WeakMap,la=new WeakSet;let da=function(e){function t(t,n){var i;return u(i=e.call(this)||this,la),s(i,Bs,void 0),s(i,Hs,void 0),s(i,Xs,void 0),s(i,Ws,void 0),s(i,qs,void 0),s(i,Gs,void 0),s(i,Ks,-1),s(i,Ys,!1),s(i,$s,!1),s(i,zs,{}),s(i,Qs,void 0),s(i,Js,!0),s(i,Zs,null),s(i,ea,!0),s(i,ta,!1),s(i,na,!1),s(i,ra,void 0),s(i,ia,null),s(i,oa,void 0),s(i,sa,null),s(i,aa,[]),s(i,ua,void 0),s(i,ca,[]),a(Gs,i,x("Buffer","color: #586e75")),a(qs,i,n),a(oa,i,t),a(Bs,i,r(la,i,fa).bind(i)),a(Hs,i,r(la,i,ga).bind(i)),a(Xs,i,r(la,i,va).bind(i)),a(Ws,i,r(la,i,Sa).bind(i)),o(oa,i).on("durationset",o(Bs,i)),i}p(t,e);var n=t.prototype;return n.addStream=function(e){e.on("segmentadd",o(Ws,this));const t=o(aa,this).push(e)-1;e.index=t,-1===o(Ks,this)&&(r(la,this,ma).call(this,t),a(ta,this,!0))},n.getBufferState=function(){return o(zs,this)},n.setBufferState=function(e){a(zs,this,e)},n.streamIndexAtTime=function(e){if(o(zs,this)[void 0])return this.activeStreamIndex;const t=r(la,this,ha).call(this,e)-1,n=o(zs,this)[t];return(null==n?void 0:n.stream)||-1},n.switchTo=function(e,t=!0,n={}){let i;i="number"==typeof e?e:e.index;let s=o(Ks,this)!==i;const u=s;if(!s&&o(ta,this)&&(s=!0),s){a(ta,this,!1);const e=o(Ks,this),n=o(aa,this)[e];this.fire("streamchangestart",e,i),n&&u&&t&&n.abort(),a(ua,this,i),r(la,this,ma).call(this,i)}return r(la,this,Sa).call(this),new Promise((e=>{s?a(ia,this,(()=>{o(ua,this)===i&&(a(ia,this,null),e(),this.fire("streamchange",i,n))})):e()}))},n.isTimeInBuffer=function(e){if(!o(sa,this))return o(Gs,this).warn("SourceBuffer is not set."),!1;for(let t=0;t<o(sa,this).buffered.length;t++){const n=o(sa,this).buffered.start(t),r=o(sa,this).buffered.end(t);if(n<=e&&r>=e)return!0}return!1},n.hasAppendedFinalSegment=function(){return void 0!==o(Qs,this)&&this.isTimeInBuffer(o(Qs,this))},n.clear=function(){o(aa,this).forEach((e=>e.clear()))},n.remove=function(e,t=o(oa,this).mediaSource.duration){return new Promise((n=>{o(ca,this).push([e,t,n]),r(la,this,Sa).call(this)}))},n.removeEventListeners=function(){o(sa,this)&&(o(sa,this).removeEventListener("updateend",o(Xs,this)),r(la,this,_a).call(this,o(sa,this))&&o(sa,this).removeEventListener("bufferedchange",o(Hs,this)))},n.removeSorcerer=function(){o(oa,this).off("durationset",o(Bs,this)),a(oa,this,null)},l(t,[{key:"activeStream",get:function(){return o(aa,this)[o(Ks,this)]||null}},{key:"activeStreamIndex",get:function(){return o(Ks,this)}},{key:"endTime",get:function(){if(!o(sa,this))return void o(Gs,this).warn("SourceBuffer is not set.");const e=o(sa,this).buffered;return e.length>0?e.end(e.length-1):void 0}},{key:"sourceBuffer",get:function(){return o(sa,this)},set:function(e){a(sa,this,e),r(la,this,pa).call(this),this.fire("sourcebufferattach")}},{key:"streams",get:function(){return o(aa,this)}}])}(bn);function ha(e){let t=Math.floor(e/6);return e>6&&e%6>=2?t+=1:e<8&&(t=1),t}function fa(){const e=o(oa,this).mediaSource.duration,t=r(la,this,ha).call(this,e);for(let n=0;n<t;n++)o(zs,this)[n]={segment:n,stream:null,type:o(qs,this)}}function pa(){o(sa,this)?(o(sa,this).addEventListener("updateend",o(Xs,this)),r(la,this,_a).call(this,o(sa,this))&&o(sa,this).addEventListener("bufferedchange",o(Hs,this))):o(Gs,this).warn("SourceBuffer is not set.")}function _a(e){return"undefined"!=typeof ManagedSourceBuffer&&e instanceof ManagedSourceBuffer}function ma(e){a(ea,this,!0),a(Ks,this,e),o(oa,this).setStreamIndex(e)}function va(){r(la,this,Ea).call(this),r(la,this,Ta).call(this),r(la,this,Sa).call(this)}function ga(e){var t;(null==(t=e.removedRanges)?void 0:t.length)>0&&o(Gs,this).call(this,"Browser removed %s buffer:",o(qs,this),(e=>{const t=[];for(let n=0;n<e.length;n++)t.push(`${e.start(n)}-${e.end(n)}`);return t.join(", ")})(e.removedRanges))}function ya(){if(o(sa,this))try{const e=o(sa,this).buffered,t=o(oa,this)._video.buffered;if(e.length&&t.length){const n=e.start(0),r=t.start(0);n<r&&o(oa,this).removeBuffer(0,r)}}catch(e){o(Gs,this).error("Error failed to handle mismatch between video and sourceBuffer.")}else o(Gs,this).warn("SourceBuffer is not set.")}function Ea(){if(o($s,this)&&this.endTime)return a($s,this,!1),a(Qs,this,this.endTime),o(oa,this).checkEndOfStream(),void r(la,this,ya).call(this);this.activeStream&&!this.activeStream.hasNextSegment()&&void 0!==o(Qs,this)&&o(Qs,this)>0&&"open"===o(oa,this).readyState&&o(oa,this).checkEndOfStream()}function Ta(){o(Zs,this)&&(this.fire("appendbufferend",o(Zs,this)),a(Zs,this,null),o(ia,this)&&o(ia,this).call(this))}function Sa(){if(!o(sa,this))return o(Gs,this).warn("SourceBuffer is not set. Waiting for sourcebufferattach event."),void this.on("sourcebufferattach",o(Ws,this));this.activeStream&&"closed"!==o(oa,this).readyState&&(o(sa,this).updating||(o(ca,this).length?r(la,this,ba).call(this):o(na,this)||o(Ys,this)||(o(ea,this)?r(la,this,Aa).call(this):r(la,this,wa).call(this))))}function ba(){const e=o(sa,this),t=o(ca,this).shift();if(!t||!e)return void o(Gs,this).warn("No entries to remove or sourceBuffer is not set.");const[n,i,s]=t,u=()=>{e.removeEventListener("updateend",u),s(),void 0!==o(ra,this)&&clearTimeout(o(ra,this)),a(ra,this,setTimeout((()=>{a(na,this,!1),r(la,this,Sa).call(this)}),5e3))};e.addEventListener("updateend",u),e.remove(n,i)}function Aa(){a(ea,this,!1),a(Ys,this,!0),this.activeStream?this.activeStream.getInitSegment().then((e=>(a(Zs,this,null),o(sa,this)&&e&&o(sa,this).appendBuffer(e),a(Ys,this,!1),e))).catch((e=>{o(Gs,this).error("Error appending init segment to the buffer:",e),a(ea,this,!0),a(Ys,this,!1)})):o(Gs,this).error("No active stream to append init segment.")}function wa(){if(!this.activeStream||!o(sa,this))return void o(Gs,this).error("No active stream or sourceBuffer to append segment.");const e=this.activeStream.getNextSegment();if(!e)return;const t=this.activeStream.getIdForSegment(e);this.activeStream.isFinal(e)&&a($s,this,!0),a(Zs,this,t),this.fire("appendbufferstart",t);try{o(sa,this).appendBuffer(e),o(zs,this)[t.segment]=t,o(Js,this)&&(a(Js,this,!1),this.fire("initialbufferstart"))}catch(n){if("QuotaExceededError"===n.name){a(na,this,!0),this.fire("quotaexceedederror",o(sa,this).buffered),o(Gs,this).error("Error QuotaExceededError.");const t=6;if(o(oa,this)._video.currentTime>t){const e=0,n=o(oa,this)._video.currentTime-t;o(Gs,this).call(this,`Removing buffer from ${e} to ${n}…`),o(oa,this).removeBuffer(e,n)}this.activeStream.dequeueSegment(e)}}}function Ia(){}var Ra=new WeakMap,ka=new WeakMap,Pa=new WeakMap,Da=new WeakMap,Oa=new WeakMap,La=new WeakMap,Ca=new WeakMap;let Na=function(e){function t(t,n="",r=new ks){var i;return h(i=e.call(this)||this,"codec",void 0),h(i,"index",NaN),s(i,Ra,void 0),s(i,ka,new WeakMap),s(i,Pa,void 0),s(i,Da,void 0),s(i,Oa,!0),s(i,La,[]),s(i,Ca,{}),a(Ra,i,x("Stream","color: #586e75")),a(Da,i,t),i.codec=n,a(Pa,i,r),o(Pa,i).start(),i}p(t,e),t.isValidSegmentUrl=function(e){return"string"==typeof e||"object"==typeof e&&"url"in e&&"byteRange"in e&&"string"==typeof e.url&&"string"==typeof e.byteRange};var n=t.prototype;return n.getIdForSegment=function(e){return t.isValidSegmentUrl(e)?o(Ca,this)[e]:o(ka,this).get(e).id},n.getSegmentUrl=function(e){return"object"==typeof e&&"url"in e?e.url:e},n.getSegmentByteRange=function(e){return"object"==typeof e&&"byteRange"in e?e.byteRange:void 0},n.isFinal=function(e){return o(ka,this).get(e).final},n.addSegment=function(e,{identifier:n=null,isFinalSegment:r=!1,loadOnly:i=!1,priority:s=0,includeWithBandwidthChecks:a=!0,excludeConnectTime:u=!1,timeout:c=null,size:l=null}={}){if(o(Oa,this)&&this.getInitSegment(),t.isValidSegmentUrl(e)){o(Ca,this)[e]=n||e;const t=this.getIdForSegment(e);return this.fire("queued",t),o(Pa,this).add({byteRange:this.getSegmentByteRange(e),excludeConnectTime:u,id:t,includeWithBandwidthChecks:a,isInitSegmentRequest:!1,priority:s,size:l,stream:this,timeout:c,url:this.getSegmentUrl(e)}).then((s=>{o(ka,this).set(s,{id:n||e,final:r}),o(La,this).push(s),this.fire("bufferqueueadd",t),i||this.fire("segmentadd")}))}return o(ka,this).set(e,{id:n,final:r}),o(La,this).push(e),this.fire("bufferqueueadd",n),Promise.resolve()},n.clear=function(){a(La,this,[])},n.abort=function(){try{const e=this;return function(e){return e&&e.then||(e=Promise.resolve(e)),e}(function(t,n){var r=function(){if(o(Oa,e))return function(e){if(e&&e.then)return e.then(Ia)}(function(e,t){try{var n=e()}catch(Rp){return t(Rp)}return n&&n.then?n.then(void 0,t):n}((function(){return function(e){if(!void 0)return e&&e.then?e.then(Ia):Promise.resolve()}(e.getInitSegment())}),(function(t){o(Ra,e).error("Error getting init segment:",t)})))}();return r&&r.then?r.then(n):n()}(0,(function(){o(Pa,e).abort(e)})))}catch(Rp){return Promise.reject(Rp)}},n.hasNextSegment=function(){return o(La,this).length>0},n.getNextSegment=function(){return o(La,this).shift()},n.dequeueSegment=function(e){o(La,this).unshift(e)},n.getInitSegment=function(){const e=this.getSegmentUrl(o(Da,this));return e?(a(Oa,this,!1),t.isValidSegmentUrl(e)?o(Pa,this).add({byteRange:this.getSegmentByteRange(o(Da,this)),id:null,isInitSegmentRequest:!0,priority:0,stream:this,url:e}).then((e=>(a(Da,this,e),o(Da,this)))):Promise.resolve(o(Da,this))):Promise.resolve(null)},l(t,[{key:"pendingFetches",get:function(){return o(Pa,this).pendingFetches}}])}(bn);var Ma=new WeakMap,xa=new WeakMap,Ua=new WeakMap,Fa=new WeakMap,ja=new WeakMap,Va=new WeakMap,Ba=new WeakMap,Ha=new WeakMap,Xa=new WeakMap,Wa=new WeakMap,qa=new WeakMap,Ga=new WeakSet;let Ka=function(){function e(e,t=-1){u(this,Ga),h(this,"streamIndex",void 0),s(this,Ma,void 0),s(this,xa,void 0),s(this,Ua,void 0),s(this,Fa,void 0),s(this,ja,!1),s(this,Va,void 0),s(this,Ba,{}),s(this,Ha,{}),s(this,Xa,0),s(this,Wa,0),s(this,qa,!1),a(Fa,this,e),this.streamIndex=t,a(Ma,this,this.start.bind(this)),a(xa,this,this.stop.bind(this)),a(Ua,this,r(Ga,this,Qa).bind(this))}var t=e.prototype;return t.init=function(){r(Ga,this,Ya).call(this)},t.start=function(){a(ja,this,!0),r(Ga,this,za).call(this)},t.stop=function(){a(ja,this,!1)},t.destroy=function(){this.stop(),r(Ga,this,$a).call(this)},t.getDroppedFrameRate=function(e,t=-1,n="average"){const r=o(Ba,this)[t];if(!r||r.length<e)return 0;const i=r.slice(-e);return"median"===n?ns(i):ts(i)},t.getDroppedFrameTotal=function(){return{dropped:r(Ga,this,Ja).call(this),total:r(Ga,this,Za).call(this)}},e}();function Ya(){o(qa,this)||(o(Fa,this).addEventListener("playing",o(Ma,this)),o(Fa,this).addEventListener("pause",o(xa,this)),o(Fa,this).addEventListener("ended",o(xa,this)),document.addEventListener("visibilitychange",o(Ua,this)),a(qa,this,!0))}function $a(){o(Fa,this).removeEventListener("playing",o(Ma,this)),o(Fa,this).removeEventListener("pause",o(xa,this)),o(Fa,this).removeEventListener("ended",o(xa,this)),document.removeEventListener("visibilitychange",o(Ua,this)),a(qa,this,!1)}function za(){if(!o(ja,this)||-1===this.streamIndex)return;if(ze.browser.safari&&(document.hidden||"hidden"===document.visibilityState))return;void 0!==o(Va,this)&&clearTimeout(o(Va,this));const e=r(Ga,this,Ja).call(this),t=e-o(Xa,this);a(Xa,this,e);const n=r(Ga,this,eu).call(this),i=n-o(Wa,this);a(Wa,this,n),o(Ba,this)[this.streamIndex]||(o(Ba,this)[this.streamIndex]=[]),o(Ha,this)[this.streamIndex]||(o(Ha,this)[this.streamIndex]=[]),o(Ba,this)[this.streamIndex].length>100&&o(Ba,this)[this.streamIndex].shift(),o(Ha,this)[this.streamIndex].length>100&&o(Ha,this)[this.streamIndex].shift(),o(Ba,this)[this.streamIndex].push(t),o(Ha,this)[this.streamIndex].push(i),a(Va,this,setTimeout((()=>{r(Ga,this,za).call(this)}),1e3))}function Qa(){!ze.browser.safari||document.hidden&&"hidden"===document.visibilityState||r(Ga,this,za).call(this)}function Ja(){return"function"==typeof o(Fa,this).getVideoPlaybackQuality?o(Fa,this).getVideoPlaybackQuality().droppedVideoFrames:o(Fa,this).webkitDroppedFrameCount||0}function Za(){return"function"==typeof o(Fa,this).getVideoPlaybackQuality?o(Fa,this).getVideoPlaybackQuality().totalVideoFrames:o(Fa,this).webkitDecodedFrameCount||0}function eu(){if("function"==typeof o(Fa,this).getVideoPlaybackQuality){const e=o(Fa,this).getVideoPlaybackQuality();return e.totalVideoFrames-e.droppedVideoFrames}return o(Fa,this).webkitDecodedFrameCount||0}var tu=new WeakMap,nu=new WeakMap,ru=new WeakMap,iu=new WeakMap,ou=new WeakMap,su=new WeakMap,au=new WeakMap,uu=new WeakMap,cu=new WeakMap,lu=new WeakMap,du=new WeakMap;let hu=function(e){function t(t,n={}){var r;h(r=e.call(this)||this,"_video",void 0),h(r,"allowSegmentRequests",void 0),s(r,tu,void 0),s(r,nu,void 0),s(r,ru,void 0),s(r,iu,void 0),s(r,ou,void 0),s(r,su,void 0),s(r,au,void 0),s(r,uu,void 0),s(r,cu,void 0),s(r,lu,void 0),s(r,du,void 0),h(r,"isInstanceofManagedMediaSource",(e=>"undefined"!=typeof ManagedMediaSource&&e instanceof ManagedMediaSource)),a(su,r,x("MediaSorcerer","color: #586e75")),r._video=t,a(uu,r,n),r.allowSegmentRequests=!0;const i=o(uu,r).disableMMS;a(au,r,new(F(i))),o(su,r).log("Media Source API: "+r._mediaSourceAPIName(o(au,r)));const{fetcherTimeout:u=0,fetcherRetryAbortErrors:c=!0}=o(uu,r);return a(cu,r,new Ka(t)),a(ou,r,new ks({parallel:1,timeout:u,retryAbortErrors:c})),a(tu,r,r._onMSSourceClose.bind(r)),a(nu,r,r._onMSSourceOpen.bind(r)),a(iu,r,{audio:null,video:null}),a(ru,r,[]),a(du,r,null),r._attachEvents(),r}p(t,e);var n=t.prototype;return n.setStreamIndex=function(e){o(cu,this).streamIndex=e},n.getCurrentSpeed=function({type:e="average",howMany:t=10,weights:n=[],percentile:r}={}){return"harmonicAverage"===e?o(ou,this).getHarmonicAverageSpeed(t):"average"===e?o(ou,this).getAverageSpeed(t,n):"median"===e?o(ou,this).getMedianSpeed(t):o(ou,this).getPercentileSpeed(t,r)},n.getResponseSpeeds=function(){return o(ou,this).getResponseSpeeds()},n.getFailedSegments=function(){return o(ou,this).getFailedSegments()},n.getSuccessfulSegments=function(){return o(ou,this).getSuccessfulSegments()},n.getDroppedFrameRate=function(e,t=this.activeStreamIndex,n="average"){return o(cu,this).getDroppedFrameRate(e,t,n)},n.getDroppedFrameTotal=function(){return o(cu,this).getDroppedFrameTotal()},n.clear=function(){o(ru,this).forEach((e=>e.clear()))},n.initFrameDropper=function(){o(cu,this).init()},n.streamIndexAtTime=function(e,t){const n=o(iu,this)[t];return n?n.streamIndexAtTime(e):-1},n.removeBuffer=function(e=0,t=this._video.duration){if(e>=(t=t||0))return Promise.resolve();const n=o(ru,this).map((n=>n.remove(e,t)));return Promise.all(n)},n.setLiveSeekableRange=function(e,t){var n;"open"===(null==(n=o(au,this))?void 0:n.readyState)&&o(au,this).setLiveSeekableRange(e,t)},n.addStream=function(e,t){const n=this._getCodecType(e);if(!o(iu,this)[n]){const t=new da(this,n);o(iu,this)[n]=t,o(ru,this).push(t),o(lu,this).then((()=>{let r;try{r=o(au,this).addSourceBuffer(e)}catch(i){if(22!==i.code)return o(su,this).error(i),void this.fire("srcnotsupported",i);r=o(iu,this)[n]}if(o(uu,this).duration){const e=.1;r.appendWindowEnd=o(uu,this).duration+e}t.sourceBuffer=r})).catch((e=>{o(su,this).error(e)})),["appendbufferstart","appendbufferend","streamchange","streamchangestart","initialbufferstart","quotaexceedederror"].forEach((e=>{t.on(e,((...t)=>{this.fire.apply(this,[e].concat(t))}))}))}const r=new Na(t,e,o(ou,this));["queued","bufferqueueadd"].forEach((e=>{r.on(e,(t=>{this.fire(e,t)}))}));const i=o(iu,this)[n];return i&&i.addStream(r),r},n.checkEndOfStream=function(){if(!o(ru,this).every((e=>e.hasAppendedFinalSegment())))return;const e=()=>{this._video.removeEventListener("timeupdate",e),this.endOfStream()};this._video.addEventListener("timeupdate",e)},n.abortFetches=function(){o(ou,this).abort()},n.endOfStream=function(){if(!o(ru,this).every((e=>e.isTimeInBuffer(this._video.currentTime)))){const e=1;if(!(ze.browser.firefox&&this._video.currentTime<e))return}"open"===o(au,this).readyState&&(this._sourceBuffersAreUpdating()||(o(su,this).log("Firing MediaSource.endOfStream()"),o(au,this).endOfStream(),this.fire("endofstream")))},n.destroy=function(){this.clear(),this._removeEventListeners(),this.off(),o(cu,this).destroy(),o(ou,this).abort();const e=this._video.querySelectorAll("source");(this._video.src||e.length>0)&&(this._video.removeAttribute("src"),e.forEach((e=>{this._video.removeChild(e)})),this._video.load())},n._mediaSourceAPIName=function(e){return this.isInstanceofManagedMediaSource(e)?"ManagedMediaSource":"MediaSource"},n._attachEvents=function(){a(lu,this,new Promise((e=>{a(du,this,e),o(au,this).addEventListener("sourceopen",o(nu,this)),o(au,this).addEventListener("sourceclose",o(tu,this))}))),["downloadstart","downloadend","downloadabort","downloaderror","downloadtimeout","progress"].forEach((e=>{o(ou,this).on(e,((...t)=>{this.fire.apply(this,[e].concat(t))}))})),this.isInstanceofManagedMediaSource(o(au,this))&&(o(au,this).addEventListener("startstreaming",(()=>{o(su,this).log("startstreaming event fired"),this.allowSegmentRequests=!0})),o(au,this).addEventListener("endstreaming",(()=>{o(su,this).log("endstreaming event fired"),this.allowSegmentRequests=!1})))},n._sourceBuffersAreUpdating=function(){for(let e=0;e<o(au,this).sourceBuffers.length;e++)if(o(au,this).sourceBuffers[e].updating)return!0;return!1},n._onMSSourceOpen=function(){o(su,this).log("MediaSource open"),o(au,this).removeEventListener("sourceopen",o(nu,this)),URL.revokeObjectURL(this._video.src),this._video.querySelectorAll("source").forEach((e=>{var t;0===(null==(t=e.src)?void 0:t.indexOf("blob"))&&URL.revokeObjectURL(e.src)})),o(uu,this).duration&&(o(au,this).duration=o(uu,this).duration,this.fire("durationset")),o(du,this)&&o(du,this).call(this)},n._onMSSourceClose=function(){o(su,this).log("MediaSource closed"),o(au,this).removeEventListener("sourceclose",o(tu,this)),this.fire("sourceclose")},n._removeEventListeners=function(){o(ru,this).forEach((e=>e.removeEventListeners()))},n._getCodecType=function(e){return 0===e.indexOf("audio")?"audio":"video"},l(t,[{key:"activeStreamIndex",get:function(){return 1===o(ru,this).length&&this.video?this.video.activeStreamIndex:(o(su,this).warn("The activeStreamIndex property on MediaSorcerer only works with single streams"),-1)}},{key:"mediaSource",get:function(){return o(au,this)}},{key:"pendingFetches",get:function(){return o(ou,this).pendingFetches}},{key:"readyState",get:function(){return o(au,this).readyState}},{key:"streams",get:function(){return 1===o(ru,this).length&&this.video?this.video.streams:(o(su,this).warn("The streams property on MediaSorcerer only works with single streams"),!1)}},{key:"audio",get:function(){return o(iu,this).audio?o(iu,this).audio:(o(su,this).warn("No audio streams have been added to MediaSorcerer"),!1)}},{key:"video",get:function(){return o(iu,this).video?o(iu,this).video:(o(su,this).warn("No video streams have been added to MediaSorcerer"),!1)}}])}(bn),fu=function(e){function t(t,n={}){var r;return(r=e.call(this,t)||this)._options=n,r.blacklisted=[],r.whitelisted=[],r.MAX_LOADABLE_SEGMENTS_AUTO=3,r.MAX_LOADABLE_SEGMENTS_LOCKED=15,r.SEGMENT_DURATION=6,r}p(t,e);var n=t.prototype;return n.isTimeInBuffer=function(e,t,n){return this._timesAreInRange(e,e,t,n,1)},n.getDistanceFromBuffer=function(e,t){let n=e;for(let r=0;r<t.length;r++)if(t.start(r)<=e&&t.end(r)>=e){n=t.end(r);break}return n-e},n.blacklist=function(e){this.blacklisted[e]=1},n.lock=function(e=[]){this.whitelisted=e},n.filterStreams=function(e,t,n,r=null){const i=[];let o,s=!1;for(let a=0;a<e.length;a++)if(o&&o[0]===e[a].width&&o[1]===e[a].height)i.push(e[a]);else{if(s)break;this.blacklisted[a]&&-1===this.whitelisted.indexOf(a)||this.whitelisted.length&&-1===this.whitelisted.indexOf(a)||(this.whitelisted.length?i.push(e[a]):(this._getScaleFromDimensions(t,n,e[a].width,e[a].height,r)>=(n<1e3/(window.devicePixelRatio||1)?1.75:1)&&(s=!0),i.push(e[a]),o=[e[a].width,e[a].height]))}return i},n.getCurrentSpeed=function(){let e="average",t=3,n=[1,2,5];return this._options.tests&&this._options.tests.harmonic_average&&this._options.tests.harmonic_average.group&&(e="harmonicAverage",t=this._getMaxLoadableSegmentsAuto(),n=[]),this.scanner.sorcerer.getCurrentSpeed({type:e,howMany:t,weights:n})},n.shouldUseSurroundSound=function(e,t){return"240p"!==e[t].quality},n.getAudioIndexFromVideo=function(e,t,n){if(0===t.length)return!1;if(!e[n])return 0;const r=t.filter((({channels:e})=>e>2));if(r.length>0&&this.shouldUseSurroundSound(e,n)){const e=r[r.length-1];return t.indexOf(e)}return t.length>1&&0===n&&e[n].height<=360&&e.length>1?"mp4a.40.2"===t[0].codecs&&t[0].bitrate<8e4&&"240p"!==e[n].quality?1:0:t.length-1},n._getVisibleDimensions=function(e,t,n,r){const i=n/r,o=e-t*i,s=t-e/i;let a=e-o,u=t-s;return o>0&&(u=t),s>0&&(a=e),[a,u]},n._getScaleFromDimensions=function(e,t,n,r,i=null){const o=this._getVisibleDimensions(e,t,n,r);let s=n*r;i&&(s*=i);const a=window.devicePixelRatio||1;return s/(o[0]*o[1]*a*a)},n._getMaxLoadableSegmentsAuto=function(){const e=function(e,t){return e&&e.tests&&e.tests[t]?e.tests[t]:null}(this._options,"lookahead_count");return e&&e.group&&e.data.count?e.data.count:e&&e.data.segment_lookahead_count?e.data.segment_lookahead_count:this.MAX_LOADABLE_SEGMENTS_AUTO},n._getSecondsToLoadAhead=function(e,t,n){const r=n&&n.bitrate>11e6;return 1===this.whitelisted.length?r?30:this.MAX_LOADABLE_SEGMENTS_LOCKED*this.SEGMENT_DURATION:this._getMaxLoadableSegmentsAuto()*this.SEGMENT_DURATION},n._timesAreInRange=function(e,t,n,r,i=0){if(!n)return!1;t=Math.min(t,r);for(let o=0;o<n.length;o++){const r=n.start(o),s=n.end(o),a=Co(r)-i,u=Co(s)+i;if(a<=e&&u>=t){if(t<r||e>s)continue;return!0}}return!1},n._hasSeparateStreams=function(e){return e.video.length>0&&e.audio.length>0},n._isSegmentInBuffer=function(e,t,n,r){let i=1;return this._hasSeparateStreams(r)&&(i=.1),this._timesAreInRange(e.start,e.end,t,n,i)},l(t,[{key:"displayName",get:function(){return"MediaSource"}}])}(function(){function e(e){this.scanner=e,this.STREAM_TYPE_VIDEO="video",this.STREAM_TYPE_AUDIO="audio"}var t=e.prototype;return t.destroy=function(){},t.shouldPowerUp=function(e,t){return!1},t.shouldPowerDown=function(e,t){return!1},t.canPowerUp=function(e,t){return 1!==e.length&&t<e.length-1},t.canPowerDown=function(e,t){return 1!==e.length&&t>0},t.filterStreams=function(e){return e},l(e,[{key:"displayName",get:function(){return"Brain"}}])}());let pu=function(e){function t(t,n={}){var r;return(r=e.call(this,t,n)||this).BANDWIDTH_UPSWITCH_THRESHOLD=.85,r.BANDWIDTH_DOWNSWITCH_THRESHOLD=.9,r.DEFAULT_TIMEOUT=8e3,r.SEGMENT_RELATIVE_TIMEOUT_RATIO=4/3,r.MINIMUM_TIMEOUT=1e3,r.FRAME_DROP_WINDOW_SECONDS=10,r}p(t,e);var n=t.prototype;return n.shouldPowerUp=function(e,t,n){n&&this._options.startingBandwidthThreshold&&(this.BANDWIDTH_UPSWITCH_THRESHOLD=this._options.startingBandwidthThreshold);let r=e.indexOf(t);if(-1===r&&(r=0),!this.canPowerUp(e,r))return Promise.resolve({index:!1,reasonForSwitch:null});const i=this.getCurrentSpeed();if(!i)return Promise.resolve({index:!1,reasonForSwitch:null});const o=this._getStreamFromSpeed(i,this.BANDWIDTH_UPSWITCH_THRESHOLD,e);return o===r||!n&&o>r&&H(this.scanner.currentTime,this.scanner._video.buffered)<1.5*this.SEGMENT_DURATION?Promise.resolve({index:!1,reasonForSwitch:null}):Promise.resolve({index:o,reasonForSwitch:3})},n.shouldPowerDown=function(e,t){const n=e.indexOf(t);if(-1===n){const t=this.isTimeInBuffer(this.scanner._video.duration,this.scanner._video.buffered,this.scanner._video.duration);return this.whitelisted.length||this.blacklisted.length||!t?Promise.resolve({index:e.length-1,reasonForSwitch:6}):Promise.resolve({index:!1,reasonForSwitch:null})}if(!this.canPowerDown(e,n))return Promise.resolve({index:!1,reasonForSwitch:null});const r=this.getCurrentSpeed();if(!r)return Promise.resolve({index:!1,reasonForSwitch:null});if(this.hasTooManyDroppedFrames(n,t,this._options.droppedFrameSwitchPercent))return this.blacklist(n),Promise.resolve({index:n-1,reasonForSwitch:2});const i=this._getStreamFromSpeed(r,this.BANDWIDTH_DOWNSWITCH_THRESHOLD,e);return i===n?Promise.resolve({index:!1,reasonForSwitch:null}):Promise.resolve({index:i,reasonForSwitch:1})},n.hasTooManyDroppedFrames=function(e,t,n){return this.scanner.sorcerer.getDroppedFrameRate(this.FRAME_DROP_WINDOW_SECONDS,e,"median")/t.framerate*100>=n},n.getTimeEstimateToLoad=function(e,t){var n;const r=null==t||null==(n=t.segments)?void 0:n[e];if(!r)return 3;const i=this.getCurrentSpeed(),o=r.end-r.start;return r.size?(8*r.size+t.audioBitrate*o)/i*1.3:o*(t.avg_bitrate+t.audioBitrate)/i*1.3},n.canPlayFromTimeInStream=function(e,t){if(!this.isTimeInBuffer(e,this.scanner._video.buffered,this.scanner._video.duration))return!1;if(!t)return!1;const n=this.getSegmentsToLoad(!1,this.STREAM_TYPE_VIDEO,t);if(0===n.length)return!0;const r=H(e,this.scanner._video.buffered);return this.getTimeEstimateToLoad(n[0],t)<r},n.getSegmentsToLoad=function(e,t=this.STREAM_TYPE_VIDEO,n){const r=this.scanner._video;if(r.webkitCurrentPlaybackTargetIsWireless)return[];const i=this.scanner.currentTime,o=[],s=i+this._getSecondsToLoadAhead(i,r.duration,n),a=this.scanner.sorcerer[t].activeStreamIndex,u=this.scanner._streams[t][a];if(!u)return o;const c=this.scanner.sorcerer[t].sourceBuffer;let l=null;c&&(l=c.buffered);for(let d=0;d<u.segments.length;d++){const t=u.segments[d];if(t.end<i||t.start>s)continue;const n=i>=t.start&&i<t.end,r=this._isSegmentInBuffer(t,l,this.scanner._video.duration,this.scanner._streams);!e&&r||e&&r&&n||(n||s>=t.start)&&o.push(d)}return o},n.getSegmentRelativeTimeout=function(e,t,n){var r;const i=null==t?void 0:t.avg_bitrate,o=null==(r=e[0])?void 0:r.avg_bitrate;if(!i||!o||!n)return this.DEFAULT_TIMEOUT;if(i===o)return this.DEFAULT_TIMEOUT;const s=n*this.SEGMENT_RELATIVE_TIMEOUT_RATIO;return Math.max(this.MINIMUM_TIMEOUT,Math.min(this.DEFAULT_TIMEOUT,s))},n._getStreamFromSpeed=function(e,t,n){let r=0;for(let i=r;i<n.length;i++)e*t>n[i].avg_bitrate+n[i].audioBitrate&&(r=i);return r},l(t,[{key:"displayName",get:function(){return"Skyfire"}}])}(fu),_u=function(){function e(e,t){this._video=e,this._getCurrentStream=t}var t=e.prototype;return t.start=function(){return clearInterval(this._checkGapInterval),this._checkGapInterval=setInterval(this._checkGap.bind(this),200),this._checkGap()},t.stop=function(){clearInterval(this._checkGapInterval)},t.onSegmentAppended=function(){this._checkGap()},t._checkGap=function(){const e=this._video.buffered,t=this._video.currentTime,n=this._getGapIndex(e,t);if(0===this._video.readyState)return!1;if(this._video.paused)return!1;const r=this._video.duration;if(t>=r)return this._video.currentTime=r-.1,!0;if(e.length<=n)return!1;const i=e.start(n);return!(i>=r)&&!(i-t>.5||0!==n||(this.stop(),this._correctFirstSegmentStart("audio",i),this._correctFirstSegmentStart("video",i),this._video.currentTime=i,0))},t._getGapIndex=function(e,t){if(!e||!e.length)return null;let n=0;for(;n<e.length;n++){const r=e.start(n),i=e.end(n);if(r>t&&(0===n||i-t<=.1))break}return n>=0?n:null},t._correctFirstSegmentStart=function(e,t){const n=this._getCurrentStream(0,e);n&&n.segments&&n.segments[0]&&(n.segments[0].start=t)},e}();const mu="br",vu="bl",gu="pr",yu="sid",Eu="cid",Tu="sf",Su="st",bu="ot";let Au=function(){function e(e,t={}){this._scanner=e,this.sessionId=t.sessionId,this.clipId=t.clipId}var t=e.prototype;return t.getLogAsQueryParam=function(e,t){return this._buildCMCDQueryParam(this._getLog(e,t))},t._getLog=function(e,t){let n={};return Object.assign(n,this._getStaticSessionData()),Object.assign(n,this._getDynamicSessionData(e,t)),n},t._buildCMCDQueryParam=function(e){return Y({CMCD:this._getObjectAsAlphabetizedString(e)})},t._getStaticSessionData=function(){return{[yu]:`"${this.sessionId}"`,[Eu]:`"${this.clipId}"`,[Su]:this._getStreamType(),[Tu]:this._getStreamingFormat()}},t._getDynamicSessionData=function(e,t){return{[gu]:this._scanner.playbackRate,[mu]:this._scanner.getBitrateAtTime(this._scanner.currentTime,t,"max")/1e3,[bu]:this._getObjectType(t),[vu]:this._getBufferLength(e)}},t._getObjectType=function(e){switch(e){case"audio":return"a";case"video":return"v";default:return"av"}},t._getBufferLength=function(e){return Math.round(1e3*(parseFloat(e.end)-parseFloat(e.start)))},t._getStreamType=function(){switch(this._scanner.displayName){case"HLSLiveScanner":case"NativeHLSLiveScanner":return"l";default:return"v"}},t._getStreamingFormat=function(){switch(this._scanner.displayName){case"HLSLiveScanner":case"NativeHLSLiveScanner":return'"hls"';default:return'"dash"'}},t._getObjectAsAlphabetizedString=function(e){let t=[],n="";for(var r=0,i=Object.entries(e);r<i.length;r++){const[e,n]=i[r];t.push({key:e,value:n})}return t.sort((function(e,t){return e.key.localeCompare(t.key)})).forEach((({key:e,value:t})=>{n+=`${e}=${t},`})),n.replace(/,\s*$/,"")},e}();function wu(e,t,n){return n?t?t(e):e:(e&&e.then||(e=Promise.resolve(e)),t?e.then(t):e)}const Iu=["supported"];function Ru(e,t){var n=e();return n&&n.then?n.then(t):t(n)}const ku=new Map;function Pu(e){return function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];try{return Promise.resolve(e.apply(this,t))}catch(Rp){return Promise.reject(Rp)}}}const Du=x("MediaCapabilities","color: white; background-color: green"),Ou=Pu((function(e){let t;const n=Nu(e);return ku.get(n)||Ru((function(){if(ze.mediaCapabilities){const r=e.codecs.replace(/,.+/,""),i={type:"media-source",video:{contentType:`${e.mime_type}; codecs=${r}`,width:e.width,height:e.height,bitrate:e.bitrate,framerate:e.framerate}};return wu(navigator.mediaCapabilities.decodingInfo(i),(function(e){t=e,ku.set(n,t)}))}}),(function(){return t}))})),Lu=Pu((function(e=[]){let t=!1,n=e,r=[],i=[];return Ru((function(){if(ze.mediaCapabilities)return function(){if(0!==e.length)return function(o,s){try{var a=wu(Promise.all(e.map((function(e){return wu(Ou(e))}))),(function(o){if(o){if(n=function(e,t){return e.filter(((e,n)=>Iu.every((e=>t[n][e]))||(Du(`Stream ${e.quality} is not supported`,t[n]),!1)))}(e,o),0===n.length)return Du("No compatible streams found. Returning all available streams as safeguard."),t=!0,{compatibleStreams:e,incompatibleStreams:r,incompatibleStreamsAttributes:i};n.length<e.length?(r=e.filter((e=>-1===n.indexOf(e))),i=r.map(Cu),Du("Some streams are not supported. Returning compatible streams.")):Du("All streams are supported.")}}))}catch(Rp){return s(Rp)}return a&&a.then?a.then(void 0,s):a}(0,(function(e){Du("Error checking stream capabilities",e)}));Du("No streams to check for MediaCapabilities support")}();Du("MediaCapabilities API not supported")}),(function(e){return t?e:{compatibleStreams:n,incompatibleStreams:r,incompatibleStreamsAttributes:i}}))}));function Cu(e){const t=Nu(e),n=ku.get(t);return n?Iu.filter((e=>!n[e])):[]}function Nu(e){return`${e.mime_type};${e.codecs};${e.width};${e.height};${e.bitrate};${e.framerate}`}function Mu(){}function xu(e,t){try{var n=e()}catch(Rp){return t(Rp)}return n&&n.then?n.then(void 0,t):n}function Uu(e){return function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];try{return Promise.resolve(e.apply(this,t))}catch(Rp){return Promise.reject(Rp)}}}function Fu(e,t,n){return n?t?t(e):e:(e&&e.then||(e=Promise.resolve(e)),t?e.then(t):e)}const ju=Uu((function(e,t,n,r){const i=function(e){const t=e.audio||[],n=e.video||[];return[{video:"HW_SECURE_ALL",audio:"SW_SECURE_CRYPTO"},{video:"HW_SECURE_DECODE",audio:"SW_SECURE_CRYPTO"},{video:"HW_SECURE_CRYPTO",audio:"SW_SECURE_CRYPTO"},{video:"SW_SECURE_DECODE",audio:"SW_SECURE_CRYPTO"},{video:"SW_SECURE_CRYPTO",audio:"SW_SECURE_CRYPTO"}].map((e=>{const r={persistentState:"optional",sessionTypes:["temporary"],videoCapabilities:[],audioCapabilities:[]};return n.length&&(r.videoCapabilities=n.map((t=>({contentType:t,robustness:e.video})))),t.length&&(r.audioCapabilities=t.map((t=>({contentType:t,robustness:e.audio})))),r}))}(r);return Promise.all(Object.keys(e).map(Uu((function(r){const o=e[r].id;let s=null;if(t||n){const e=t?window.WebKitMediaKeys:window.MSMediaKeys;try{s=new e(o)}catch(Rp){}return{name:o,keySystem:s}}return xu((function(){return Fu(navigator.requestMediaKeySystemAccess(o,i),(function(e){return Fu(e.createMediaKeys(),(function(e){return s=e,{name:o,keySystem:s}}))}))}),(function(e){return{name:o,keySystem:null}}))}))))}));const Vu=Uu((function(e,t){return function(e){if(e&&e.then)return e.then(Mu)}(xu((function(){return function(e){return e&&e.then?e.then(Mu):Promise.resolve()}(t.setServerCertificate(Po(e)))}),(function(e){})))}));function Bu(e,t,n){return n?t?t(e):e:(e&&e.then||(e=Promise.resolve(e)),t?e.then(t):e)}function Hu(e){return function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];try{return Promise.resolve(e.apply(this,t))}catch(Rp){return Promise.reject(Rp)}}}const Xu="video",Wu="audio";let qu=function(t){function n(e,n={}){var r;return(r=t.call(this,e,n)||this).reset(),r.manifestLoadDurations=[],r._preserveCurrentTime=!1,r._preloadStreamIndex=null,r}p(n,t),n.supported=function(e){const t=F(e);return void 0!==t&&t.isTypeSupported};var r=n.prototype;return r.deactivate=function(){t.prototype.deactivate.call(this),this.sorcerer&&this.sorcerer.destroy(),this.reset()},r.reset=function(){this._waitingOnSet=new Set,this._streamsForSegment={},ze.browser.safari&&(this._gapJumper=new _u(this._video,this._getCurrentStream.bind(this))),this.resetBrain(),this._setupCMCDLogger(),this._ready=!1,this._startedPlaying=!1,this._manifest=null,this._streams={},this._streams[Wu]=[],this._streams[Xu]=[],this._audioStreams=[],this._onReady=null,this._baseUrl=null,this._lastTargetStreamId=null,this._timeToSeekTo=null,this._seekInProgressPromise=null,this._resolveSeek=null,this._resolveStartPreload=null,this._reloadingExistingVideo=!1,this._lastStreamIndex=null,this._checkSwitchUp=!1,this._clearBufferAtTime=!1,this._preloadStream=null,this._removeBufferPromise=null,this._ranIntoBuffer=!1,this._restrictedStreamIndexes=[],this._switching={},this._lastDownloadBitrate=0,this._preloadSegmentStreamIndex=null,this._preserveCurrentTime=!1,this._preloadStreamIndex=null,clearInterval(this._loadSegmentsInterval),clearTimeout(this._slowLoadSegmentTimeout)},r.resetBrain=function(){const e=this._options.mediaSourceScanner||{};e.tests=this._options.tests,this._brain&&this._brain.destroy(),this._brain=new pu(this,e)},r.preloadStream=function(){if(this._preloadStream)return this._preloadStream;let e=0,t=1;this._streams.audio.length&&(t=2);let n=this.sorcerer.video.activeStreamIndex;this._restrictedStreamIndexes.length&&(n=this._restrictedStreamIndexes[0]),null!==this._preloadStreamIndex&&(n=this._preloadStreamIndex);let r=0;const i=this._brain.getSegmentsToLoad(!1,Xu,n);i.length>0&&(r=i[0]);let o=()=>{};const s=(e=!1)=>{e&&(n=this.sorcerer.video.activeStreamIndex),this._preloadSegmentStreamIndex=n,this._restartLoadSegmentsIntervalWithBackoff(!0)},a=n=>{e+=1,e<t||(n.segment===r&&1!==this._restrictedStreamIndexes.length&&null===this._preloadStreamIndex?this._getStreamIndexToLoadAndSwitchReason(!0).then((t=>{let{index:r,reasonForSwitch:i}=t,a={reasonForSwitch:i};if(!1!==r&&r>n.stream){if(this.sorcerer.video.switchTo(r,!1,a),this._streams.audio.length){const e=this._brain.getAudioIndexFromVideo(this._streams.video,this._streams.audio,r);this.sorcerer.audio.switchTo(e,!1)}return e=0,void s(!0)}o()})).catch(console.error):o())};return this._preloadStream=new Promise((e=>{o=()=>{const t=this._getCurrentStream(n).segments[0].end,r=this._getDuration(!0);if(this.currentTime>=r&&(this.currentTime=r),this.currentTime>t&&(this.sorcerer.clear(),this._waitingOnSet=new Set),this.sorcerer.video.switchTo(n,!1),this._streams.audio.length){const e=this._brain.getAudioIndexFromVideo(this._streams.video,this._streams.audio,n);this.sorcerer.audio.switchTo(e,!1)}this.sorcerer.off("bufferqueueadd",a),this._preloadSegmentStreamIndex=null,this._ready=!0,e()},this.sorcerer.on("bufferqueueadd",a),s()})),this._preloadStream},r.loadManifest=function(t){try{const n=this;return Bu(n.video.metadata.p2pReady,(function(){const r=Date.now();return ze.browser.ie&&t&&-1!==t.indexOf("archive_playlist")?(setTimeout((()=>{n._fireVideoError(Bo,"An unknown error occurred.")}),250),new Promise((()=>{}))):Se({url:t,timeout:1e4,type:e.MANIFEST}).then((e=>(e.url&&e.url!==t&&-1!==e.url.indexOf("live-archive")&&(n._baseUrl=e.url.split("/").slice(0,-2).join("/")),n.manifestLoadDurations.push({url:t,status:e.status,duration:Date.now()-r}),n.fire(Ni.MANIFEST_LOADED),e.text()))).then(Hu((function(e){let r;return function(i,o){var s=function(){if(-1!==t.indexOf(".mpd"))return Bu(n._loadMediaManifest(),(function({parseMPD:i}){const o=n._telecineVideo.enabledAudioTrack,s={audioLang:null==o?void 0:o.language};r=i(e,t,s)}));r=JSON.parse(e)}();return s&&s.then?s.then(o):o()}(0,(function(){return r}))}))).catch((e=>{if(n.manifestLoadDurations.push({url:t,status:e.response&&e.response.status,duration:Date.now()-r}),n.reset(),e instanceof ne&&410===e.response.status)return n.fire(Ni.MEDIA_URL_EXPIRED),new Promise((()=>{}));throw e instanceof ne&&400===e.response.status?n.fire(Ni.MEDIA_URL_BAD_REQUEST,e.response.url):e instanceof ie&&n.fire(Ni.MANIFEST_TIMEOUT),e}))}))}catch(Rp){return Promise.reject(Rp)}},r.setVideoSrc=function(e,t,n=!0){if(n&&!t&&this._onReady){if(("metadata"===this._preload||"none"===this._preload&&!this.paused)&&!this._ready)return void this._onReady.then((()=>{const t=this.paused;this.setVideoSrc(e,t,!1)})).catch(console.error);const t=this._telecineVideo.drmHandler;if(t&&"sd-fallback"===t.state&&!t.hasFallbackSourceUpdated)return void this._onReady.then((()=>{this.setVideoSrc(e,!0,!1)})).catch(console.error);if("auto"===this._preload)return void this._onReady.then((()=>{this.setVideoSrc(e,!1,!1)})).catch(console.error)}t&&this.reset(),t||!this.paused||this.sorcerer||(t=!0);let r=this._initializeManifest;t&&(r=this._initialize);const i=e.split("/");i.pop();const o=`${i.join("/")}/`;this._reloadingExistingVideo=!t,this._onReady=this._startPreload(e,this._preload).then(this.loadManifest.bind(this)).then((e=>"string"==typeof this._baseUrl&&-1!==this._baseUrl.indexOf("live-archive")?e:(this._baseUrl=o,{manifest:e,isConfigRefresh:!t}))).then(r.bind(this)),t&&"auto"===this._preload&&(this._onReady=this._addCallbackToPromise(this._onReady,this.preloadStream.bind(this),!1)),this._onReady=this._addCatchToPromise(this._onReady)},r.getBitrateAtTime=function(e,t="video",n="average"){if(!this.sorcerer)return 0;const r=this.sorcerer.streamIndexAtTime(e,t),i=this._streams[t][r];var o;return i?null!==(o=i["average"===n?"avg_bitrate":"bitrate"])&&void 0!==o?o:i.bitrate:0},r.lockStreamIndexes=function(){const e=this._restrictedStreamIndexes.map((e=>this._streams[Xu].indexOf(this._streams[Xu][e]))),t=!this.paused;if(t&&(this._ignorePauseEvent=!0,this._video.pause()),this._switching[Xu]=!1,this._brain.lock(e),!this._startedPlaying&&"auto"!==this._preload)return;const n=Math.max(this.currentTime-7,0),r=Math.min(this.currentTime+7,this._video.duration);this.sorcerer.removeBuffer(n,r).then((()=>{!this._startedPlaying&&"auto"===this._preload||this.ended?this._loadSegments():(this.seekToTime(this.currentTime),t&&this.paused&&(this._ignorePlayEvent=!0,this._video.play()))})).catch(console.error)},r.seekToTime=function(e){if(e===this.currentTime)return Promise.resolve();if(null===this._timeToSeekTo||(this._lastSeekReject&&(this._lastSeekReject(),this._lastSeekReject=null),this._seekInProgressPromise=null,this._timeToSeekTo=null,this._resolveSeek=null),this._timeToSeekTo=e,this._handleScrubbing(),this._ready)for(const t in this._streams)if(this._streams[t].length>0){const e=this.sorcerer[t].activeStreamIndex;this.sorcerer[t].streams[e].abort()}return this._seekInProgressPromise=this._getSeekReadyPromiseForTime(e),Promise.all([this._onReady,this._removeBufferPromise]).then((()=>{this._loadSegments()})).catch(console.error),this._paused&&0===e&&this.fire(Di.SEEKING),this._onReady.then((()=>this._seekInProgressPromise)).catch((e=>{}))},r.takeSnapshot=function(){this._switchingVideo&&t.prototype.takeSnapshot.call(this)},r.initDrm=function(){},r.onstalled=function(){return!1},r.onseeked=function(e){this._startedPlaying&&this._restartLoadSegmentsIntervalWithBackoff()},r.onended=function(e){return t.prototype.onended.call(this,e),!0},r.onseeking=function(e){this._startedPlaying},r._handleScrubbing=function(){this._scrubStart(),clearTimeout(this._scrubTimeout),this._scrubTimeout=setTimeout((()=>{this._scrubEnd()}),200)},r._scrubStart=function(){this._scrubbing||(this._scrubbing=!0)},r._scrubEnd=function(){this._scrubbing=!1},r.ontimeupdate=function(e){if(!this.sorcerer)return!1;if(t.prototype.ontimeupdate.call(this),this._gapJumper&&this._gapJumper.stop(),0===this.currentTime)return this._startedPlaying;if(this._timeToSeekTo)return!1;if(this._startedPlaying||(this._startedPlaying=!0),this._clearBufferAtTime&&this.currentTime>=this._clearBufferAtTime){const e=2;this.sorcerer.removeBuffer(0,this._clearBufferAtTime-e),this._clearBufferAtTime=!1}const n=this.sorcerer.getDroppedFrameTotal();this.fire(Ni.DROPPED_FRAMES,n);const r=this.sorcerer.getResponseSpeeds(),i=this._streams[Xu][this.sorcerer.video.activeStreamIndex],o=this._options.tests&&this._options.tests.download_bitrate;if((!o||!o.group)&&i&&this._brain.getCurrentSpeed){const e={speed:this._brain.getCurrentSpeed(),bitrate:i.avg_bitrate,speeds:r};this.fire(Ni.BANDWIDTH,e)}const s=this._video.buffered.length;if(!s)return!0;const a=this._video.buffered.end(s-1);return Math.ceil(a)===Math.ceil(this._video.duration)||(Math.abs(this.currentTime-a)<.2?(this._ranIntoBuffer||(this.fire(Ni.STREAM_BUFFER_START,{hasLowerStreamIndex:this.sorcerer[Xu].activeStreamIndex>0}),this._ranIntoBuffer=!0),!1):void 0)},r._isEnded=function(){return!!this.ended||Math.ceil(this.currentTime)===Math.ceil(this._video.duration)},r._loadSegmentsIntervalTick=function(){if(!this.sorcerer)return!1;if("closed"===this.sorcerer.readyState)return!1;if(this._video.webkitCurrentPlaybackTargetIsWireless)return!1;if(this._isEnded())return!1;if(null!==this._preloadSegmentStreamIndex){try{this._loadPreloadSegments()}catch(Rp){return this._handleLoadSegmentFailures(Rp),!1}return!0}if(0===this.currentTime&&!this._ready)return this._startedPlaying;const e=this._loadSegments();return e&&"function"==typeof e.catch&&e.catch(this._handleLoadSegmentFailures.bind(this)),!0},r._handleLoadSegmentFailures=function(e){e.code===DOMException.INVALID_STATE_ERR?this.fire(Ni.SCANNER_ERROR,{reason:e}):this.fire(Ni.LOAD_SEGMENT_FAILED,new No(`${Ni.LOAD_SEGMENT_FAILED} - ${e.name}`,e.message)),clearInterval(this._loadSegmentsInterval)},r.onprogress=function(){this._brain.canPlayFromTimeInStream(this.currentTime,this._getCurrentStream())&&this._ranIntoBuffer&&(this.fire(Ni.STREAM_BUFFER_END),this._ranIntoBuffer=!1)},r.onwaiting=function(){return!this._gapJumper||!this._gapJumper.start()},r.onerror=function(){return!!this._video.error&&(this._video.error.code===this._video.error.MEDIA_ERR_DECODE?(this.fire(Ni.SCANNER_ERROR,{reason:`encountered media decode error. Message: "${this._video.error.message}"`}),!1):this._video.error.code===this._video.error.MEDIA_ERR_SRC_NOT_SUPPORTED?(this._preserveCurrentTime=!0,this.fire(Ni.SCANNER_ERROR,{reason:`encountered media source not supported error. Message: "${this._video.error.message}"`}),!1):t.prototype.onerror.call(this))},r.pause=function(){t.prototype.pause.call(this)},r.play=function(){return this._restartLoadSegmentsIntervalWithBackoff(),t.prototype.play.call(this,(()=>(this._resolveStartPreload&&this._resolveStartPreload(),this._reloadingExistingVideo||this._ready||"auto"===this._preload||(this._onReady=this._addCallbackToPromise(this._onReady,this.preloadStream.bind(this))),this._onReady.then((()=>Promise.resolve(this._seekInProgressPromise))))))},r.onpause=function(){return this._ignorePauseEvent?(this._ignorePauseEvent=!1,!1):(t.prototype.onpause.call(this),!0)},r.onplay=function(){return!this._ignorePlayEvent||(this._ignorePlayEvent=!1,!1)},r._addCallbackToPromise=function(e,t,n=!0){let r=e.then(t);return n&&(r=this._addCatchToPromise(r)),r},r._addCatchToPromise=function(e){return e.catch((e=>(this.fire(Ni.FILE_ERROR,{reason:e}),new Promise((()=>{})))))},r._handleBufferForSeek=function(){this._ready&&this._streams[Xu][this.sorcerer.video.activeStreamIndex].bitrate/1e3>12e3&&(this._removeBufferPromise=this.sorcerer.removeBuffer())},r._startPreload=function(e,t){return new Promise((n=>{var r;"none"!==t||this._reloadingExistingVideo&&!this.paused||"sd-fallback"===(null==(r=this._telecineVideo.drmHandler)?void 0:r.state)?n(e):this._resolveStartPreload=()=>{n(e),this._resolveStartPreload=null}}))},r._getSeekReadyPromiseForTime=function(e=this._timeToSeekTo){return new Promise((t=>{const n=this._startedPlaying&&0===e,r=this._brain.canPlayFromTimeInStream(e,this._getCurrentStream());n||r?t(e):(this._handleBufferForSeek(),this._resolveSeek=t)})).then((e=>{this._timeToSeekTo=null,this._seekInProgressPromise=null;const t=new Promise(((e,t)=>{this._lastSeekReject=t;const n=()=>{e(this._video.currentTime),this._video.removeEventListener("seeked",n)};this._video.addEventListener("seeked",n)}));return this._video.currentTime=e,t}))},r._handlePreloadChanged=function(e,t){"auto"!==e&&"auto"===t&&(this._onReady=this._addCallbackToPromise(this._onReady,this.preloadStream.bind(this))),e!==t&&"none"!==t&&this._resolveStartPreload&&this._resolveStartPreload()},r._avDurationDifference=function(e){const t=e.audio.reduce(((e,t)=>e+t.duration),0),n=e.video.reduce(((e,t)=>e+t.duration),0),r=t/e.audio.length,i=n/e.video.length;return r+4<i?i-r:0},r._manifestContainsSegmentSizes=function(e){return e.video.every((e=>e.segments.every((e=>"size"in e))))},r._initializeManifest=function(e){const t=this;return new Promise(Hu((function(n,r){const{manifest:i,isConfigRefresh:o}=e;if(t._manifest=i,t._streams[Xu]=t._sortVideoStreams(i.video),i.audio){const e=t._avDurationDifference(i);e>0&&(t._hasAudioVideoMismatch=!0,t.fire(Ni.AV_DURATION_MISMATCH,e),t._audioDuration=i.audio.reduce(((e,t)=>Math.max(e,t.duration)),0));const n=i.audio.filter((e=>"opus"===e.codecs)),r=i.audio.filter((e=>"opus"!==e.codecs)),o=ze.browser.safari||ze.iOS||ze.iPadOS||!F().isTypeSupported('audio/mp4; codecs="opus"')||!n.length?r:n;t._streams[Wu]=t._sortAudioStreams(o)}for(let e=0;e<t._streams[Xu].length;e++){let n=0;if(i.audio){const r=t._brain.getAudioIndexFromVideo(t._streams.video,t._streams.audio,e),i=t._streams[Wu][r];i&&(n=i.avg_bitrate)}t._streams[Xu][e].audioBitrate=n}return o||t._initDrm(t._streams[Xu],t._streams[Wu],t._manifest.key_info),t._manifestContainsSegmentSizes(i)||t.resetBrain(),t.fire(Ni.STREAMS_LOADED,t._streams),Bu(Lu(t._streams[Xu]),(function({compatibleStreams:e,incompatibleStreams:r,incompatibleStreamsAttributes:i}){t._streams[Xu]=e,r.length&&(t.fire(Ni.AVAILABLE_STREAMS_CHANGED),t.fire(Ni.MEDIA_CAPABILITY_STREAMS_UNSUPPORTED,{incompatibleStreams:r,incompatibleStreamsAttributes:i})),n()}))})))},r._setUpSorcerer=function(e,t){if(this.sorcerer&&this.sorcerer.destroy(),this.sorcerer=new hu(e,t),this.sorcerer.isInstanceofManagedMediaSource(this.sorcerer.mediaSource)){const t=document.createElement("source");t.type="video/mp4",t.src=URL.createObjectURL(this.sorcerer.mediaSource),e.appendChild(t);const{src:n,mime:r}=this._telecineVideo.externalDisplayFiles.AirPlay,i=document.createElement("source");i.type=r,i.src=n,e.appendChild(i)}else e.src=URL.createObjectURL(this.sorcerer.mediaSource);this.successfulSegments=this.sorcerer.getSuccessfulSegments(),this.failedSegments=this.sorcerer.getFailedSegments(),this._restartLoadSegmentsIntervalWithBackoff()},r._restartLoadSegmentsIntervalWithBackoff=function(e=!1){this._restartLoadSegmentsInterval(500),clearTimeout(this._slowLoadSegmentTimeout),this._slowLoadSegmentTimeout=setTimeout((()=>{this._restartLoadSegmentsInterval(5e3)}),6e4),e&&this._loadSegmentsIntervalTick()},r._restartLoadSegmentsInterval=function(e){clearInterval(this._loadSegmentsInterval),this._loadSegmentsInterval=setInterval((()=>{this._loadSegmentsIntervalTick()}),e)},r._getDuration=function(e=!1){let t=e?1/0:0;for(const n in this._streams)this._streams[n].length&&(t=Math[e?"min":"max"](t,this._streams[n][0].duration));return t},r._initialize=function(e){return this._initializeManifest(e).then((()=>{let e=this._streams[Xu][0];this._restrictedStreamIndexes.length&&(e=this._streams[Xu][this._restrictedStreamIndexes[0]]),null!==this._preloadStreamIndex&&(e=this._streams[Xu][this._preloadStreamIndex]),this._setUpSorcerer(this._video,{duration:this._getDuration(),fetcherTimeout:8e3,fetcherRetryAbortErrors:!1,disableMMS:this._options.disableMMS}),this.sorcerer.on("srcnotsupported",(()=>{this.fire(Ni.SCANNER_ERROR,{reason:"this codec is not supported for mediasource playback"})})),this._video.addEventListener("webkitcurrentplaybacktargetiswirelesschanged",(e=>{const t=!this._video.webkitCurrentPlaybackTargetIsWireless,n="closed"===this.sorcerer.readyState;t&&n&&this.fire(Ni.SCANNER_ERROR,{reason:"MediaSource was closed during AirPlay, falling back to Native HLS playback."})}));const t=this._streams[Xu].indexOf(e);for(const n in this._streams)this._streams[n].forEach(((e,t)=>{let r=this._getSegmentUrl(t,"init",n);this._useRangeRequests(t,n)&&this._streams[n][t].init_segment_range&&(r={url:r,byteRange:this._getRangeForSegment(t,"init",n)}),this.sorcerer.addStream(`${e.mime_type}; codecs="${this._streams[n][t].codecs}"`,r)}));this.sorcerer.video.switchTo(t,!0,{reasonForSwitch:7}),this.sorcerer.on("queued",this._handleQueued.bind(this)),this.sorcerer.on("downloadabort",this._handleAborted.bind(this)),this.sorcerer.on("appendbufferend",this._handleAppendBufferEnd.bind(this)),this.sorcerer.on("downloadstart",this._handleDownloadStart.bind(this)),this.sorcerer.on("downloadend",this._handleDownloadEnd.bind(this)),this.sorcerer.on("downloaderror",this._handleDownloadError.bind(this)),this.sorcerer.on("downloadtimeout",this._handleDownloadTimeout.bind(this)),this.sorcerer.on("quotaexceedederror",this._handleQuotaExceededError.bind(this)),this.sorcerer.video.on("streamchange",this._handleStreamChange.bind(this)),this.sorcerer.video.on("streamchangestart",this._handleStreamChangeStart.bind(this)),this.sorcerer.mediaSource.addEventListener("sourceended",(()=>{this.fire(Di.PROGRESS)}))}))},r._sortVideoStreams=function(e){const t=e.slice(0);return t.sort((function(e,t){const n=e.width*e.height*e.avg_bitrate,r=t.width*t.height*t.avg_bitrate;return e.width===t.width&&e.height===t.height?e.framerate-t.framerate:n-r})),t},r._sortAudioStreams=function(e){const t=e.slice(0);return t.sort((function(e,t){return e.avg_bitrate*e.channels-t.avg_bitrate*t.channels})),t},r._useRangeRequests=function(e,t){return!!this._streams[t][e].segments[0].range},r._getRangeForSegment=function(e,t,n){return"init"===t?this._streams[n][e].init_segment_range:this._streams[n][e].segments[t].range},r._getSegmentPriority=function(e,t,n=Xu){return"init"===t?0:this._streams[n][e].segments[t].start},r._getSegmentUrl=function(e,t,n=Xu,r=!1){if("init"===t&&!this._streams[n][e].init_segment_url)return function(e){return Po(e).buffer}(this._streams[n][e].init_segment);let i=this._baseUrl;const o=this._manifest.base_url&&-1!==this._manifest.base_url.indexOf("//");if(o&&(i=this._manifest.base_url),this._manifest.base_url&&!o&&(i+=this._manifest.base_url),this._streams[n][e].base_url&&(i+=this._streams[n][e].base_url),this._useRangeRequests(e,n))return i;if("init"===t)return i+=this._streams[n][e].init_segment_url,i;const s=this._streams[n][e].segments[t];s.url&&(i+=s.url);const a=-1!==i.indexOf("akamaized"),u=-1===i.indexOf("?")?"?":"&";return r&&this.CMCDLogger&&a&&(i+=`${u}${this.CMCDLogger.getLogAsQueryParam(s,n)}`),i},r._key=function(e,t,n){return`${e}:${t}:${n}`},r._isFinalSegment=function(e,t,n){return t===this._streams[n][e].segments.length-1},r._getCurrentlyLoadingStreamsForSegment=function(e,t){const n=[],r=this._streamsForSegment[e];if(!r)return n;for(let i=0;i<r.length;i++)this._waitingOnSet.has(this._key(r[i],e,t))&&n.push(r[i]);return n},r.getCurrentStream=function(e="video"){return this._getCurrentStream(0,e)},r._getCurrentStream=function(e=0,t=Xu){return void 0!==this.sorcerer&&(e=this.sorcerer[t].activeStreamIndex),this._streams[t][e]},r._getStreamIndexToLoadAndSwitchReason=function(e){let t=this._streams[Xu];const n=this.video&&this.video.metadata.percentShown?this.video.metadata.percentShown:null;if(t=this._brain.filterStreams(t,this._video.clientWidth,this._video.clientHeight,n),0===t.length)return Promise.resolve({index:!1,reasonForSwitch:null});if(this._switching[Xu])return Promise.resolve({index:!1,reasonForSwitch:null});const r=t[t.length-1];if(r.id!==this._lastTargetStreamId){this._lastTargetStreamId=r.id;const e={index:this._streams[Xu].indexOf(r),streams:this._streams[Xu]};this.fire(Ni.STREAM_TARGET_CHANGE,e)}const i=this._getCurrentStream();return this._brain.shouldPowerUp(t,i,e).then((e=>!1===e.index?this._brain.shouldPowerDown(t,i).then((e=>!1===e.index?{index:e.index,reasonForSwitch:e.reasonForSwitch}:{index:this._streams[Xu].indexOf(t[e.index]),reasonForSwitch:e.reasonForSwitch})):{index:this._streams[Xu].indexOf(t[e.index]),reasonForSwitch:e.reasonForSwitch}))},r._loadSegmentsForType=function(e=Xu){return this.sorcerer.allowSegmentRequests?this._getStreamIndexToLoadAndSwitchReason(!1).then((t=>{let{index:n,reasonForSwitch:r}=t,i={reasonForSwitch:r};e===Wu&&(!1===n&&(n=this.sorcerer[Xu].activeStreamIndex),n=this._brain.getAudioIndexFromVideo(this._streams.video,this._streams.audio,n),this.sorcerer[Wu].activeStreamIndex===n&&(n=!1));let o=!1;!1!==n&&(o=n>this.sorcerer[e].activeStreamIndex,this._switching[e]=!0,this.sorcerer[e].switchTo(n,!0,i).then((()=>{this._switching[e]=!1})).catch(console.error));let s=o;const a=this._brain.getSegmentsToLoad(s,e,this._getCurrentStream()),u=this.sorcerer[e].activeStreamIndex;for(let c=0;c<a.length;c++){const t=this._getSegmentUrl(u,a[c],e,!0),n=this._getCurrentlyLoadingStreamsForSegment(a[c],e);if(n.length>1)continue;if(1===n.length&&u<=n[0])continue;const r=this._isFinalSegment(u,a[c],e),i={stream:u,segment:a[c],type:e},o=this.sorcerer[e].streams[u];let s=t;this._useRangeRequests(u,e)&&(s={url:s,byteRange:this._getRangeForSegment(u,a[c],e)});const l=this._getSegmentPriority(u,a[c],e),d=e===Xu;let h=null;0===u&&e===Xu&&(h=16e3);let f=null;try{f=this._streams[e][u].segments[a[c]].size}catch(Rp){}o.addSegment(s,{identifier:i,isFinalSegment:r,priority:l,includeWithBandwidthChecks:d,timeout:h,size:f}).catch((e=>{}))}})).catch((e=>{throw e})):Promise.resolve()},r._loadPreloadSegments=function(){for(const e in this._streams){if(0===this._streams[e].length)continue;let t=0;const n=this._brain.getSegmentsToLoad(!1,e,this._getCurrentStream());n.length>0&&(t=n[0]);let r=this._preloadSegmentStreamIndex;e===Wu&&(r=this._brain.getAudioIndexFromVideo(this._streams.video,this._streams.audio,this._preloadSegmentStreamIndex));const i=this._key(r,t,e);if(this._waitingOnSet.has(i))continue;const o=this._getSegmentUrl(r,t,e),s=this._isFinalSegment(r,t,e),a=this.sorcerer[e].streams[r],u={stream:r,segment:t,type:e},c=!0;let l=o;this._useRangeRequests(r,e)&&(l={url:l,byteRange:this._getRangeForSegment(r,t,e)}),a.addSegment(l,{identifier:u,isFinalSegment:s,loadOnly:c,priority:0}).catch((e=>{}))}},r._loadSegments=function(){const e=this._video.webkitCurrentPlaybackTargetIsWireless,t="closed"===this.sorcerer.readyState;return e||t?Promise.resolve():this._onReady&&this._onReady.then((()=>{const e=[];for(const t in this._streams)this._streams[t].length>0&&e.push(this._loadSegmentsForType(t));return Promise.all(e)}))},r._handleQueued=function(e){this._waitingOnSet.add(this._key(e.stream,e.segment,e.type)),this._streamsForSegment[e.segment]||(this._streamsForSegment[e.segment]=[]),-1===this._streamsForSegment[e.segment].indexOf(e.stream)&&this._streamsForSegment[e.segment].push(e.stream)},r._clearWaitingOn=function(e){(this._streamsForSegment[e.segment]||[]).forEach((t=>{this._waitingOnSet.delete(this._key(t,e.segment,e.type))}))},r._handleAborted=function(e){this._streamsForSegment[e.segment]&&this._clearWaitingOn(e)},r._handleAppendBufferEnd=function(e){this.fire(Ni.APPEND_BUFFER_END,{identifier:e}),this.preloadStreamIndex=null,this._restartLoadSegmentsIntervalWithBackoff(),this._checkSwitchUp&&e.stream===this._lastStreamIndex&&(this._checkSwitchUp=!1,this._clearBufferAtTime=this._streams[Xu][e.stream].segments[e.segment].start),this._streamsForSegment[e.segment]&&this._clearWaitingOn(e);const t=this._brain.canPlayFromTimeInStream(this._timeToSeekTo,this._getCurrentStream());null!==this._timeToSeekTo&&this._resolveSeek&&t&&(this._resolveSeek(this._timeToSeekTo),this._resolveSeek=null),this._gapJumper&&this._gapJumper.onSegmentAppended()},r._handleDownloadStart=function(e){this.fire(Ni.DOWNLOAD_START,{identifier:e})},r._handleDownloadEnd=function(e,t){this.fire(Ni.DOWNLOAD_END,{identifier:e,data:t})},r._handleDownloadError=function(e,t){this._clearWaitingOn(e);let n=Ni.DOWNLOAD_ERROR;410===t&&(n=Ni.MEDIA_URL_EXPIRED),502===t&&this.video.metadata.drm&&(n=Ni.DRM_FAILURE),this.fire(n,{identifier:e,status:t})},r._handleDownloadTimeout=function(e,t){this.fire(Ni.DOWNLOAD_TIMEOUT,{identifier:e,data:t}),this._streamsForSegment[e.segment]&&this._clearWaitingOn(e),e.type===Xu?this._switching[Xu]=!1:e.type===Wu&&(this._switching[Wu]=!1)},r._handleQuotaExceededError=function(e){this.fire(Ni.QUOTA_EXCEEDED_ERROR,{buffered:e})},r._handleStreamChangeStart=function(e,t){const n={previousStreamIndex:this._manifest.video.indexOf(this._streams[Xu][e]),index:this._manifest.video.indexOf(this._streams[Xu][t]),streams:this._manifest.video};this.fire(Ni.STREAM_CHANGE_START,n)},r._handleStreamChange=function(e,t){var n;if(null==(n=this._manifest)||!n.video)return;e>this._lastStreamIndex&&this.currentTime>0&&(this._checkSwitchUp=!0),this._lastStreamIndex=e;const r={index:this._manifest.video.indexOf(this._streams[Xu][e]),streams:this._manifest.video,metadata:t};this.fire(Ni.STREAM_CHANGE,r)},r._initDrm=function(e=[],t=[],n={}){const r=this._telecineVideo.drmHandler;if(!r)return;const i=function(e,t){const n={audio:e.map((e=>`${e.mime_type};codecs="${e.codecs}"`)),video:[]};for(let r=0;r<t.length;r++){const[e,i]=t[r].codecs.split(",");n.video[r]=`${t[r].mime_type};codecs="${e}"`,i&&n.audio.push(`audio/mp4;codecs="${i}"`)}return n}(t,e);r.init(this,i,n),r.setFallbackCallback((()=>{this.paused||(this._video.pause(),this.once(Ni.CURRENT_FILE_CHANGE,(()=>{this.play()})))}))},r._setupCMCDLogger=function(){var e;null!=(e=this._options.tests)&&null!=(e=e.cmcd)&&e.group&&(this.CMCDLogger=new Au(this,this._options.sessionMetadata))},r._loadMediaManifest=function(){return Promise.resolve().then((function(){return Ao}))},l(n,[{key:"preload",get:function(){return this._preload},set:function(e){this._handlePreloadChanged(this._preload,e),this._preload=e}},{key:"videoElement",get:function(){return this._video}},{key:"videoWidth",get:function(){const e=this._getCurrentStream();return e?e.width:this._video.videoWidth}},{key:"videoHeight",get:function(){const e=this._getCurrentStream();return e?e.height:this._video.videoHeight}},{key:"restrictedStreamIndexes",get:function(){return this._restrictedStreamIndexes},set:function(e){this._restrictedStreamIndexes.join(",")!==e.join(",")&&(this._restrictedStreamIndexes=e,this._onReady.then((()=>this.lockStreamIndexes())).catch(console.error))}},{key:"preloadStreamIndex",get:function(){return this._preloadStreamIndex},set:function(e){this._preloadStreamIndex=e;const t=null!==e?[this._preloadStreamIndex]:this._restrictedStreamIndexes;this._brain.lock(t)}},{key:"currentTime",get:function(){return null!==this._timeToSeekTo?this._timeToSeekTo:this._video.currentTime},set:function(e){(this._startedPlaying||0!==e)&&(this._hasAudioVideoMismatch&&this._audioDuration&&e>this._audioDuration-1&&!this._brain.isTimeInBuffer(e,this._video.buffered,this._video.duration)&&(e=this._audioDuration-1),this.seekToTime(e))}},{key:"downloadSpeed",get:function(){return this._lastDownloadBitrate}},{key:"brainDebug",get:function(){const e=this.sorcerer&&this._brain&&this._brain.getCurrentSpeed?this._brain.getCurrentSpeed():null;let t=this.sorcerer&&this.sorcerer.getResponseSpeeds?this.sorcerer.getResponseSpeeds():null;return t=t?t.slice(-20):[],{currentSpeed:e,responseSpeeds:t}}},{key:"isLowerProfileAvailable",get:function(){return this.sorcerer?this.sorcerer[Xu].activeStreamIndex>0:null}},{key:"videoStreams",get:function(){return this._streams[Xu]}}],[{key:"displayName",get:function(){return"MediaSourceScanner"}},{key:"supportedVideoTypes",get:function(){return["application/vnd.vimeo.dash+json","video/vnd.mpeg.dash.mpd"]}}])}(es),Gu=function(){function e(e){this._scanner=e,this._currentTime=0,this._latencyInterval=setInterval(this._onLatencyInterval.bind(this),500)}var t=e.prototype;return t.destroy=function(){clearInterval(this._latencyInterval)},t._onLatencyInterval=function(){const e=this._scanner.videoElement,t=this._scanner.getCurrentStream();if(!e||!t)return;this._currentTime=e.currentTime;const n=this._computeLatency();null!==n&&(this._latency=n,this._scanner.fire(Mi.LATENCY_UPDATED,n),this._scanner.lowLatencyMode&&(ze.browser.ie||ze.browser.safari||null!==this._scanner.presentationDelay&&(e.playbackRate=1)))},t._estimateLiveEdge=function(){const e=this._scanner.getCurrentStream();return e?e.edge+e.age:null},t._computeLatency=function(){const e=this._estimateLiveEdge();return null===e||0===this._currentTime?null:e-this._currentTime},t._getForwardBufferLength=function(){const e=this._scanner.videoElement,t=this._scanner.getCurrentStream();if(!e||!t)return 0;const n=e.buffered.length;return n?e.buffered.end(n-1):t.edge-this._currentTime},l(e,[{key:"latency",get:function(){return this._latency}},{key:"liveSyncPosition",get:function(){const e=this._estimateLiveEdge(),t=this._scanner.presentationDelay,n=this._scanner.getCurrentStream();return null===e||null===t||null===n?0:e-t-this.edgeStalled}},{key:"edgeStalled",get:function(){const e=this._scanner.getCurrentStream();if(!e)return 0;const t=3*(this._scanner.lowLatencyMode&&e.partTargetDuration||e.targetDuration);return Math.max(e.age-t,0)}}])}();const Ku=[1,2,5];let Yu=function(e){function t(t,n={}){var r;return(r=e.call(this,t,n)||this)._UPSHIFT_BANDWIDTH_THRESHOLD=.4,r._DOWNSHIFT_BANDWIDTH_THRESHOLD=.6,r.consecutiveStreamIndex={},r.isNewPlayback=!0,r}p(t,e);var n=t.prototype;return n.optimalStream=function(e,t){var n,r;this.isNewPlayback&&((null==(r=this.scanner.sorcerer)?void 0:r.getResponseSpeeds().length)>=2&&(this.isNewPlayback=!1));if(1===e.length)return{index:0,reasonForSwitch:6};if(this.isNewPlayback){let t=0,n=0,r=this.scanner.videoElement.clientHeight,i=[];for(let o=0;o<e.length;o++){let s=e[o].height;i.push(s),s<r&&s>n&&(t=o,n=e[o].height)}return t=Math.max(0,t-1),{index:t,reasonForSwitch:4}}const i=this.getCurrentSpeed();let o=t,s=t;for(let f=0;f<e.length;f++)i*this._UPSHIFT_BANDWIDTH_THRESHOLD>e[f].bandwidth&&(o=f),i*this._DOWNSHIFT_BANDWIDTH_THRESHOLD>e[f].bandwidth&&(s=f);const a=t<o?o:s;this._clearConsecutiveStreamIndexes(a),this.consecutiveStreamIndex[a]++;const u=this.scanner.lowLatencyMode?.5:1.5,c=this.scanner.segmentLength*u,l=this.scanner.videoElement,d=l.buffered,h=null==(n=this._options.mediaSourceScanner)?void 0:n.droppedFrameSwitchPercent;return d&&0!==d.length?d.end(d.length-1)-l.currentTime<c?{index:0!==t?t-1:0,reasonForSwitch:1}:t>0&&!isNaN(h)&&this.hasTooManyDroppedFrames(t,this.scanner.getCurrentStream(),h)?(this.blacklist(t),this.scanner.fire(Ni.DROPPED_FRAME_PERCENT_EXCEEDED),{index:t-1,reasonForSwitch:2}):this.consecutiveStreamIndex[a]>2&&a!==t?{index:a,reasonForSwitch:3}:{index:t,reasonForSwitch:null}:{index:0,reasonForSwitch:5}},n.getCurrentSpeed=function(){var e;return null==(e=this.scanner.sorcerer)?void 0:e.getCurrentSpeed({type:"average",howMany:5,weights:Ku})},n._clearConsecutiveStreamIndexes=function(e){this.consecutiveStreamIndex[e]||(this.consecutiveStreamIndex[e]=0);for(const t in this.consecutiveStreamIndex)this.consecutiveStreamIndex.hasOwnProperty(t)&&parseInt(t,10)!==e&&(this.consecutiveStreamIndex[t]=0)},n.getAvailabilityStart=function(e,t){return this._getSegmentAvailabilityStart(e,t.edge)},n.getAvailabilityEnd=function(e,t){return this._getSegmentAvailabilityEnd(e,t.edge)},n.canPlayFromTimeInStream=function(e,t){return!!t&&this.isTimeInBuffer(e,this.scanner._video.buffered,this.scanner._video.duration)},n.getSegmentsToLoad=function(e,t,n){var r,i,o;const{currentTime:s,liveTailTime:a,sorcerer:u,bufferTarget:c,atLiveEdge:l}=this.scanner,d=null==(r=u[t])||null==(r=r.sourceBuffer)?void 0:r.buffered,h=null!=d&&d.length?d.start(d.length-1):0,f=B(Math.max(s,h),d);if(!e&&f>=c)return[];const p=Math.max(s,a),_=l?n.edge:p,m=this._getSegmentAvailabilityStart(_,n.edge),v=this._getSegmentAvailabilityEnd(_,n.edge),g=this.scanner.lowLatencyMode&&(null==(i=n.parts)?void 0:i.length),y=[].concat(T(n.segments),T(null!==(o=n.parts)&&void 0!==o?o:[])),E=(g?n.parts:y).filter((t=>!!t.uri&&(e||!this.scanner.isSegmentAdded(t))&&!(t.end<m||t.start>v)));return g&&E.forEach(((e,t)=>{for(;e=e.dependentOn;)E.includes(e)||this.scanner.isStreamSegmentAdded(e)||E.splice(t,0,e)})),u[t].activeStreamIndex,E},n._getSegmentAvailabilityStart=function(e,t){const n=t-this._getPresentationDelay();return Math.max(0,Math.min(e,n))},n._getSegmentAvailabilityEnd=function(e,t){const n=e+this.scanner.bufferTarget;return Math.min(n,t)},n._getPresentationDelay=function(){return this.scanner.presentationDelay||this.scanner.manifest.presentationDelay},l(t,[{key:"displayName",get:function(){return"Live"}}])}(pu);const $u=["disabled","hidden","showing"],zu=["subtitles","captions","descriptions","chapters","metadata"],Qu=["ar","fa","he","iw","ku","ps","sd","ur","yi"],Ju=new WeakMap,Zu=new WeakMap;let ec=function(e){function t({kind:t,src:n=null,label:r="",language:i="",id:o=Z(),provenance:s=""},a){var u;if(u=e.call(this)||this,-1===zu.indexOf(t))throw Uo(12,"SYNTAX_ERR","Syntax Error");return Object.defineProperties(u,{kind:{value:t,enumerable:!0},label:{value:r,enumerable:!0},language:{value:i,enumerable:!0},id:{value:`${o}`,enumerable:!0},rtl:{value:-1!==Qu.indexOf(i.substr(0,2)),enumerable:!0},provenance:{value:s,enumerable:!0}}),u.video=a,u.src=n,u._modeHasBeenSet=!1,Ju.set(u,"disabled"),u}return p(t,e),t.prototype.dispatchEvent=function(e){this.fire(e,{target:this})},l(t,[{key:"mode",get:function(){return Ju.get(this)},set:function(e){if($u.indexOf(e)>-1){if(this._modeHasBeenSet=!0,Ju.get(this)===e)return;Ju.set(this,e),this.video.currentScanner&&this.video.currentScanner.setModeForTrack(this,e),this.dispatchEvent("modechange")}}},{key:"src",get:function(){return Zu.get(this)},set:function(e){Zu.set(this,e),this.video.fire(Ni.TEXT_SRC_UPDATE,this)}},{key:"cues",get:function(){return this.video.currentScanner?this.video.currentScanner.getCuesForTrack(this):[]}},{key:"activeCues",get:function(){return this.video.currentScanner?this.video.currentScanner.getActiveCuesForTrack(this):[]}},{key:"trackElement",get:function(){return document.getElementById(`telecine-track-${this.id}`)}}])}(bn);function tc(e){var t=/^(?:(\d{2,}):)?(\d{2}):(\d{2})[,.](\d{3})$/.exec(e);if(!t)return-1;var n=parseInt(t[4],10)/1e3;return n+=parseInt(t[3],10),t[2]&&(n+=60*parseInt(t[2],10)),t[1]&&(n+=60*parseInt(t[1],10)*60),n}function nc(e){var t=0,n=e.split(/(?:(?:\r\n|\n){2,})/),r=[],i=null;do{0===t&&/^\uFEFF?WEBVTT(?: .*)?/.test(n[t])&&t++,(i=/^(?:(.*)(?:\r\n|\n))?([\d:,.]+) --> ([\d:,.]+)(.*)?(?:\r\n|\n)([\s\S]*)/.exec(n[t]))&&r.push({startTime:tc(i[2]),endTime:tc(i[3]),text:i[5]}),t++}while(t<n.length);return r}function rc(e,t,n){return n?t?t(e):e:(e&&e.then||(e=Promise.resolve(e)),t?e.then(t):e)}function ic(e,t){try{var n=e()}catch(Rp){return t(Rp)}return n&&n.then?n.then(void 0,t):n}function oc(e,t){return e&&e.then?e.then(t):t(e)}function sc(){}function ac(e,t){var n=e();return n&&n.then?n.then(t):t(n)}function uc(e){return function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];try{return Promise.resolve(e.apply(this,t))}catch(Rp){return Promise.reject(Rp)}}}function cc(e,t){if(!t)return e&&e.then?e.then(sc):Promise.resolve()}const lc=ze.browser.ie||ze.browser.edge?.5:.2,dc=8e3;let hc=function(e){function t(t,n={}){var r,i,o,s,a,u,c;return(c=e.call(this,t,n)||this)._playInitiated=!1,c._captionsVisible=!1,c._captionsLoading=!1,c._atLiveEdge=!0,c._atLiveTail=!1,c._STREAM_SWITCH_CHECK_INTERVAL=2e3,c._DOWN_SHIFT_CHECK_INTERVAL=1e4,c.reset(),c.defaultPresentationDelay=null!==(r=n.presentationDelay)&&void 0!==r?r:n.lowLatencyMode?3:12,c.defaultBufferTarget=n.lowLatencyMode?3:12,c.bufferTarget=c.defaultBufferTarget,c.presentationDelay=c.defaultPresentationDelay,c.lowLatencyMode=null!==(i=n.lowLatencyMode)&&void 0!==i&&i,c.disableDeltaUpdates=null!==(o=n.disableDeltaUpdates)&&void 0!==o&&o,c._preloadStreamIndex=null,Object.defineProperty(c,"eventIsLowLatency",{value:null!==(s=n.lowLatencyMode)&&void 0!==s&&s,writable:!1}),Object.defineProperty(c,"eventHasDVREnabled",{value:null!==(a=n.dvrEnabled)&&void 0!==a&&a,writable:!1}),c._timeoutTest=null==(u=c._options.tests)||null==(u=u.llhls_timeout)?void 0:u.group,window.addEventListener("online",(()=>{c.play()})),c}p(t,e),t.supported=function(e){const t=F(e);return void 0!==t&&t.isTypeSupported};var n=t.prototype;return n.deactivate=function(){e.prototype.deactivate.call(this),this.reset()},n.reset=function(){var e,t,n;null==(e=this._sorcerer)||e.destroy(),null==(t=this._manifestLoader)||t.stop(),null==(n=this._latencyController)||n.destroy(),this._videoReady=V(),this._sorcerer=null,this._streams={},this._streams.video=[],this._streams.audio=[],this._lastStreamIndex=0,this._isOnline=!1,this._hasLiveEventEnded=!1,this._timeSinceLastStreamSwitchCheck=0,this._timeSinceLastDownShift=Number.NEGATIVE_INFINITY,this._lastStallCurrentTime=-1,this._timeToSeekTo=null,this._resolveSeek=null,this._abr=new Yu(this,this._options),this._latencyController=new Gu(this),this._restrictedStreamIndexes=[],this._preloadStreamIndex=null,this._switching={},this._segmentsAdded={},this._captionsAddedToTextTrack={},this._captionsAddedToTranscript={},this._fetchedCues={}},n.endLive=function(){var t;this._isOnline=!1,this._hasLiveEventEnded=!0,this.eventHasDVREnabled&&!this.atLiveEdge||(null==(t=this._manifestLoader)||t.stop(),this._sorcerer&&(this._sorcerer.abortFetches(),this._sorcerer.endOfStream()),this.eventHasDVREnabled||e.prototype.deactivate.call(this),this.fire(Di.ENDED))},n._signalOnline=function(){this._isOnline||(this._isOnline=!0,this.fire(Mi.STREAM_ONLINE))},n._signalOffline=function(){this._isOnline&&(this._isOnline=!1,this.fire(Mi.STREAM_OFFLINE))},n._toggleConnection=function(e){e?this._signalOnline():this._signalOffline()},n._loadManifest=function(e){try{const t=this;if(t._hasLiveEventEnded)return rc();t._manifestLoader&&(t._manifestLoader.stop(),t._manifestLoader.off());let n=[t._loadMediaManifest()];return t.video.metadata.p2pReady&&n.push(t.video.metadata.p2pReady),rc(Promise.allSettled(n),(function([n]){const{M3U8Loader:r,PLAYLIST_UPDATE:i,PLAYLIST_ERROR:o,convertTsCodecs:s}=n.value;return t._manifestLoader=new r({disableDeltaUpdates:t.disableDeltaUpdates}),t._manifestLoader.lowLatencyMode=t.lowLatencyMode,t._manifestLoader.dvrEnabled=t.eventHasDVREnabled,t._manifestLoader.on(i,t._onPlaylistUpdate.bind(t)),t._manifestLoader.on(o,(e=>{t._signalOffline()})),oc(ic((function(){const n=t.video.metadata.playlistRefreshUrl;return rc(t._manifestLoader.start(e,n),(function(e){t._manifest=e,t._signalOnline()}))}),(function(e){throw t._signalOffline(),t.endLive(),e})),(function(e){t._streams.video=fc(function(e){return e.filter((t=>t.codecs.split(".")[0]===e[0].codecs.split(".")[0]))}(function(e){const t=e.slice(0);return t.sort((function(e,t){const n=e.width*e.height*e.avg_bitrate,r=t.width*t.height*t.avg_bitrate;return e.width===t.width&&e.height===t.height?e.framerate-t.framerate:n-r})),t}(t._manifest.video))),t._streams.audio=fc(w(I(t._streams.video,(({audio:e})=>e))));const{index:n,reasonForSwitch:r}=t._getStream("video",!0);let i={reasonForSwitch:r};return rc(t._manifestLoader.switchTo("video",n),(function(){let e,r=[];if(t._streams.audio.length){let{index:n}=t._getStream("audio",!0);e=n,r.push(t._manifestLoader.switchTo("audio",e))}if(t.manifest.captions&&t.manifest.captions.length>0){const{index:e}=t._getStream("subtitles",!0);r.push(t._manifestLoader.switchTo("subtitles",e))}return rc(Promise.all(r),(function(){var r,o;null==(r=t._sorcerer)||r.destroy(),t._sorcerer=new hu(t._video,{fetcherRetryAbortErrors:!1,fetcherTimeout:dc,disableMMS:t._options.disableMMS}),t._sorcerer.initFrameDropper(),t._streams.video.forEach((e=>{t._sorcerer.addStream(s(Lo(t._manifestLoader.activeStream("video").mimeType,e.codecs)),e.initSegment)})),t._streams.audio.forEach((e=>{t._sorcerer.addStream(s(Lo(t._manifestLoader.activeStream("audio").mimeType,e.codecs)),e.initSegment)})),t.fire(Ni.STREAMS_LOADED,t._streams),t.manifest.captions&&t.manifest.captions.length>0&&(t.manifest.captions.forEach(t._loadTextTrack.bind(t)),t.fire(Ni.TEXT_TRACKS_AVAILABLE)),t._setUpMediaSorcererEvents(),t._sorcerer.video.switchTo(n,!1,i),t._streams.audio.length&&(null==(o=t._sorcerer.audio)||o.switchTo(e,!1))}))}))}))}))}catch(Rp){return Promise.reject(Rp)}},n._refreshManifest=function(){try{const e=this;return rc(function(e){if(e&&e.then)return e.then(sc)}(ic((function(){return rc(e._manifestLoader.update(),(function(){e._signalOnline()}))}),(function(){e._signalOffline()}))))}catch(Rp){return Promise.reject(Rp)}},n._setUpMediaSorcererEvents=function(){this._sorcerer.video.on("streamchange",this._handleStreamChange.bind(this)),this._sorcerer.video.on("streamchangestart",this._handleStreamChangeStart.bind(this)),this._sorcerer.on("downloadend",this._handleDownloadEnd.bind(this)),this._sorcerer.on("downloadtimeout",this._handleDownloadTimeout.bind(this)),this._sorcerer.on("downloadabort",this._handleDownloadAbort.bind(this)),this._sorcerer.on("appendbufferend",this._handleBufferAppend.bind(this))},n._handleDownloadEnd=function(e,t){if(e&&e.isInitSegmentRequest)return;const n=this._getCurrentStream();t.extraContext={liveAvail:{start:this._abr.getAvailabilityStart(this.currentTime,n),end:this._abr.getAvailabilityEnd(this.currentTime,n)}},this.fire(Ni.DOWNLOAD_END,{identifier:e,data:t})},n._handleDownloadTimeout=function(e,t){e&&e.isInitSegmentRequest||(this._key(e),this._clearSegment(e),this._switching[e.type]=!1,this.fire(Ni.DOWNLOAD_TIMEOUT,{identifier:e,data:t}))},n._handleDownloadAbort=function(e){e&&e.isInitSegmentRequest||(this._key(e),this._clearSegment(e))},n._handleStreamChangeStart=function(e,t){const n={previousStreamIndex:this._streams.video.indexOf(this._streams.video[e]),index:this._streams.video.indexOf(this._streams.video[t]),streams:this._streams.video};this.fire(Ni.STREAM_CHANGE_START,n)},n._handleStreamChange=function(e,t={}){this.fire(Ni.STREAM_CHANGE,{index:e,streams:this._streams.video,metadata:t})},n._firstBufferAheadIndex=function(e,t){for(let n=0;n<(null==t?void 0:t.length);n++)if(t.start(n)>e)return n},n._handleBufferAppend=function(e){var t;const{type:n,stream:r}=e,i=this.sorcerer[n].sourceBuffer.buffered,o=this._getSegmentById(e);if(o&&i.length&&(this._streams[n][r].playlist.timeOffset=i.end(i.length-1)-(o.end-o.timeOffset)),null===this._timeToSeekTo||!this._resolveSeek)return;const s=this._firstBufferAheadIndex(this.currentTime,i),a=null!==(t=null==i?void 0:i.start(s))&&void 0!==t?t:0,u=B(a,i);if(void 0!==s&&u>this.bufferTarget)return Number((a-this.currentTime).toFixed(3)),void(this.currentTime=a);this._timeToSeekTo<this.liveTailTime&&(this._timeToSeekTo=this.liveTailTime),this._abr.canPlayFromTimeInStream(this._timeToSeekTo,this._getCurrentStream())&&(this._resolveSeek(this._timeToSeekTo),this._resolveSeek=null)},n._key=function({type:e,segment:t,part:n}){return`${e}_${t}_${n}`},n._getSegmentById=function({type:e,stream:t,segment:n,part:r}){const i=this._streams[e][t].getSegmentBySN(n);return(null==i?void 0:i.getPart(r))||i},n._clearSegment=function(e){if(e.part>0){const t=g(g({},e),{},{part:e.part-1});this._clearSegment(t)}const t=this._key(e);delete this._segmentsAdded[t]},n.isSegmentAdded=function(e){return!!this._segmentsAdded[this._key(e)]},n.isStreamSegmentAdded=function(e){const t=this._key(e),n=this._sorcerer[e.type].activeStreamIndex;return!!this._segmentsAdded[t]&&this._segmentsAdded[t].stream===n},n._onPlaylistUpdate=function(e,t){try{const i=this,{type:o}=e;var n,r;return i.eventHasDVREnabled&&(null==(n=i._sorcerer)||n.setLiveSeekableRange(i.liveTailTime,i.liveEdgeTime)),i.fire(Ni.STREAM_UPDATED,e),"subtitles"===o?((i._captionsVisible||i._captionsLoading)&&(null==(r=i.manifest.captions)?void 0:r.length)>0&&i._addTextTrackCue(),rc()):(t||i._loadSegmentsForType(o),i._toggleConnection(i._hasNewSegments(o)||!i._atDurationEnd()),i._checkForPlaybackGap(),(i.lowLatencyMode||i.video.metadata.p2pReady)&&i._checkForPlaybackStall(),rc())}catch(Rp){return Promise.reject(Rp)}},n._loadTextTrack=function({label:e,language:t},n){if(!this._captionsTrack){const r=new ec({label:e,id:n,kind:"captions",language:t},this._telecineVideo);this._telecineVideo.textTracks=ko([r]),this._captionsTrack=this.addTextTrack(r)}},n._getSegmentIdentifier=function(e){return`${e.type}_${e.mediaSequenceNumber}`},n._getVideoTimeOffset=function(){return this._getCurrentStream("video").playlist.timeOffset},n._shouldAddSegmentCuesToTextTrack=function(e){const t=this._getSegmentIdentifier(e),n=this._captionsAddedToTextTrack[t],r=this._getVideoTimeOffset(),i=e.end+r>=this.currentTime&&e.start+r<=this.currentTime+this.bufferTarget;return this._captionsVisible&&!n&&i},n._shouldAddSegmentCuesToTranscript=function(e){const t=this._getSegmentIdentifier(e),n=this._captionsAddedToTranscript[t],r=this._getVideoTimeOffset(),i=e.end+r>=this.liveEdgeTime-e.duration&&e.start+r<=this.liveEdgeTime+this.bufferTarget;return this._captionsLoading&&!n&&i},n._getSegmentCues=function(e){try{const t=this,n=t._getSegmentIdentifier(e);return rc(ac((function(){if(!t._fetchedCues[n])return rc(Se(e.url).text(),(function(e){const r=nc(e),i=function(e){const t=e.match(/=MPEGTS:(\d+),/);return(t&&t[1]||0)/9e4}(e),o=r.map((e=>(e.startTime=i+e.startTime,e.endTime=i+e.endTime,new(window.VTTCue||window.TextTrackCue)(e.startTime,e.endTime,e.text))));t._fetchedCues[n]=o}))}),(function(){return t._fetchedCues[n]})))}catch(Rp){return Promise.reject(Rp)}},n._addTextTrackCue=function(){try{const e=this;return rc(e._videoReady,(function(){e.manifest.captions&&e.manifest.captions[0].segments.forEach(uc((function(t){const n=e._getSegmentIdentifier(t),r=e._shouldAddSegmentCuesToTextTrack(t),i=e._shouldAddSegmentCuesToTranscript(t);return function(){var o=function(){if(r||i)return rc(e._getSegmentCues(t),(function(t){r&&(e._captionsAddedToTextTrack[n]=!0,t.forEach((t=>{e._captionsTrack.addCue(t)}))),i&&(e._captionsAddedToTranscript[n]=!0,e.fire(Ni.SEGMENT_CUES_LOADED,t))}))}();if(o&&o.then)return o.then(sc)}()})))}))}catch(Rp){return Promise.reject(Rp)}},n._hasNewSegments=function(e){var t;const n=this._getCurrentStream(e),r=3*(this.lowLatencyMode?3:1);return(null==(t=n.playlist)?void 0:t.misses)<r},n._loadSegments=function(){try{const e=this;return rc(e._videoReady,(function(){const t=e._video.webkitCurrentPlaybackTargetIsWireless,n="closed"===e._sorcerer.readyState;if(!t&&!n)for(const r in e._streams)e._streams[r].length>0&&e._loadSegmentsForType(r)}))}catch(Rp){return Promise.reject(Rp)}},n._loadSegmentsForType=function(e){try{const t=this;return rc(t._videoReady,(function(){if(!t._sorcerer.allowSegmentRequests)return;const{index:n,reasonForSwitch:r}=t._getStream(e);let i;return ac((function(){if(n>=0&&n!==t.sorcerer[e].activeStreamIndex)return i=n>t.sorcerer[e].activeStreamIndex,t._switching[e]=!0,rc(t._manifestLoader.switchTo(e,n),(function(){let i={reasonForSwitch:r};t.sorcerer[e].switchTo(n,!0,i).then((()=>{t._switching[e]=!1})).catch(console.error)}))}),(function(){return rc(O(0),(function(){const n=t.lowLatencyMode&&void 0!==i,r=t._sorcerer[e].activeStreamIndex,o=t._getCurrentStream(e,r),s=t._abr.getSegmentsToLoad(n,e,o),a=t._getSegmentTimeoutMs();s.forEach((n=>{const i=t._key(n),s={type:e,stream:r,segment:n.segment,part:n.part},u="video"===e&&!n.hint;let c=a;if(n.hint&&t._playInitiated&&n.start>t.currentTime){const e=1e3*(n.start-t.currentTime);c=Math.min(dc,e+a)}const l=o.avg_bitrate/8*n.duration,d=t.sorcerer[e].streams[r],h=t._preventExpiredSegmentUsage(n);d.addSegment(h,{identifier:s,includeWithBandwidthChecks:u,priority:n.programDateTime,excludeConnectTime:t.lowLatencyMode,timeout:t._timeoutTest||t.lowLatencyMode?c:dc,size:t._timeoutTest||t.lowLatencyMode?l:void 0}).catch((e=>{e instanceof rs||e instanceof te||t._clearSegment(s)})),t._segmentsAdded[i]=s}))}))}))}))}catch(Rp){return Promise.reject(Rp)}},n._preventExpiredSegmentUsage=function(e){var t;let n=null==e?void 0:e.url;const r=null==(t=this._manifestLoader)?void 0:t.baseUrl;return r&&n&&!n.startsWith(r)&&(n=`${r}${e.uri}`),n},n._getStream=function(e,t=!1){var n;let r;if(this._switching[e])return{index:-1,reasonForSwitch:null};if("subtitles"===e)return r=this._manifestLoader.activeStream("video"),{index:r.subtitles[r.currentRenditions.subtitles].index,reasonForSwitch:null};if("audio"===e)return r=this._manifestLoader.activeStream("video"),{index:r.audio[r.currentRenditions.audio].index,reasonForSwitch:null};if(!t&&G(this._timeSinceLastStreamSwitchCheck)<this._STREAM_SWITCH_CHECK_INTERVAL)return{index:this._lastStreamIndex,reasonForSwitch:null};this._timeSinceLastStreamSwitchCheck=X();const i=null==(n=this.video)||null==(n=n.metadata)?void 0:n.percentShown,o=this._abr.filterStreams(this._streams.video,this._video.clientWidth,this._video.clientHeight,i);if(0===o.length)return{index:this._lastStreamIndex,reasonForSwitch:null};const{index:s,reasonForSwitch:a}=this._abr.optimalStream(o,this._lastStreamIndex),u=o[s],c=this._streams.video.indexOf(u);if(c>=0&&(t||c!==this._lastStreamIndex)){if(c>this._lastStreamIndex&&G(this._timeSinceLastDownShift)<this._DOWN_SHIFT_CHECK_INTERVAL)return{index:this._lastStreamIndex,reasonForSwitch:a};c<this._lastStreamIndex&&(this._timeSinceLastDownShift=X());const e={index:c,streams:this._streams.video};return this.fire(Ni.STREAM_TARGET_CHANGE,e),this._lastStreamIndex=c,{index:c,reasonForSwitch:a}}return{index:this._lastStreamIndex,reasonForSwitch:a}},n.getCurrentStream=function(e="video"){return this._getCurrentStream(e)},n._getCurrentStream=function(e="video",t=0){return void 0!==this._sorcerer&&null!==this._sorcerer&&(t=this._sorcerer[e].activeStreamIndex),this._streams[e][t]},n._checkForPlaybackStall=function(){if(this._video.currentTime===this._lastStallCurrentTime&&X()-this._lastStallCheckTime>=1e3&&this._shouldBeMakingProgress()){const e=`Jumping forward 0.1s because of stall at time of ${this._video.currentTime}`;this.fire(Mi.STALL_JUMP,{msg:e}),this._video.currentTime+=.1}this._lastStallCurrentTime=this._video.currentTime,this._lastStallCheckTime=X()},n._shouldBeMakingProgress=function(){return this._video.readyState!==this._video.HAVE_NOTHING&&!!this._video.buffered.length&&!this._video.paused&&this._hasContentFor(this._video.buffered,this._video.currentTime)},n._hasContentFor=function(e,t){for(let n=0;n<e.length;n++)if(!(t<e.start(n)-.1||t>e.end(n)-.5))return!0;return!1},n._checkForPlaybackGap=function(){const e=this.buffered;if(!e.length)return;const t=e.length,n=this._video.currentTime;let r,i,o,s;try{r=function(e,t){if(!e||!e.length)return null;if(1===e.length&&e.end(0)-e.start(0)<1e-6)return null;let n;for(let r=0;r<e.length;r++)if(e.start(r)>t&&(0===r||e.end(r-1)-t<=.5)){n=r;break}return n>=0?n:null}(e,n)}catch(Rp){throw DOMException,Rp}if(null===r)return;if(this._video.readyState===this._video.HAVE_NOTHING)return;if(this._video.paused)return;if(t<=r)return;try{i=e.start(r),o=e.end(t-1)}catch(Rp){throw DOMException,Rp}const a=i-n,u=o-i,c=this.lowLatencyMode?1:2;if(u>0&&u<=this.segmentLength*c)return s=`Preventing jump too close to buffered end time. Would have jumped to: ${i}. Last buffered end time ${o}.`,void this.fire(Mi.BUFFER_GAP_JUMP_PREVENT,{msg:s});0===r?(s=`Jumping forward ${a} seconds because of gap before start time of ${i}`,this.fire(Mi.BUFFER_GAP_JUMP,{msg:s})):(s=`Jumping forward ${a} seconds because of gap starting at ${e.end(r-1)} and ending at ${i}`,this.fire(Mi.BUFFER_GAP_JUMP,{msg:s})),this._video.currentTime=i+.1},n._atDurationEnd=function(){const e=this.buffered;return!!(e&&e.length&&this._video.currentTime+lc>e.end(e.length-1))},n.setVideoSrc=function(e){try{const t=this;return rc(t._startPreload(t._preload),(function(){return rc(t._loadManifest(e),(function(){return ac((function(){if(t.sorcerer.isInstanceofManagedMediaSource(t.sorcerer.mediaSource)){const e=document.createElement("source");e.type="video/mp4",e.src=URL.createObjectURL(t.sorcerer.mediaSource),t._video.appendChild(e);let{src:n,mime:r}=t._telecineVideo.externalDisplayFiles.AirPlay;const i=document.createElement("source");return i.type=r,rc(Qi(n),(function(e){i.src=e,t._video.appendChild(i)}))}t._video.src=URL.createObjectURL(t.sorcerer.mediaSource)}),(function(){t._videoReady.resolve()}))}))}))}catch(Rp){return Promise.reject(Rp)}},n._startPreload=function(e){try{const t=this;return t._preloadReady=V(),"none"===e&&t.paused||t._preloadReady.resolve(),rc(t._preloadReady)}catch(Rp){return Promise.reject(Rp)}},n.getBitrateAtTime=function(e,t="video",n="average"){if(!this._sorcerer)return 0;const r=this._sorcerer.streamIndexAtTime(e,t),i=this._streams[t][r];var o;return i?null!==(o=i["average"===n?"avg_bitrate":"bitrate"])&&void 0!==o?o:i.bitrate:0},n.onprogress=function(){this._checkForPlaybackGap()},n.ondurationchange=function(){this._checkForPlaybackGap()},n.ontimeupdate=function(){if(!this._sorcerer)return;if(e.prototype.ontimeupdate.call(this),null!==this._timeToSeekTo)return;this.atLiveTail=this._isNearLiveTail(this._video.currentTime),this._shouldSnapToLiveEdge(this._video.currentTime)?this.atLiveEdge=!0:(this._video.playbackRate<1||this._hasDriftedBehindLiveEdge())&&(this.atLiveEdge=!1),this.fire(Ni.DROPPED_FRAMES,this._sorcerer.getDroppedFrameTotal());const t=this._getCurrentStream();if(t){const e={speed:this._abr.getCurrentSpeed(),bitrate:t.avg_bitrate,speeds:this._sorcerer.getResponseSpeeds()};this.fire(Ni.BANDWIDTH,e)}!this._isOnline&&this._atDurationEnd()&&this.fire(Mi.STREAM_OFFLINE),!this.lowLatencyMode&&G(this._timeSinceLastStreamSwitchCheck)>this._STREAM_SWITCH_CHECK_INTERVAL&&this._loadSegments()},n._shouldSnapToLiveEdge=function(e){return e>=this.liveEdgeTime-1*this.segmentLength},n._hasDriftedBehindLiveEdge=function(e){return e>=this.liveEdgeTime-2*this.segmentLength},n._isNearLiveTail=function(e){return e<=this.liveTailTime+2*this.segmentLength},n._getSeekReadyPromiseForTime=function(e=this._timeToSeekTo){return new Promise((t=>{this._abr.canPlayFromTimeInStream(e,this._getCurrentStream())?t(e):this._resolveSeek=t})).then((e=>(this._timeToSeekTo=null,this._seekInProgressPromise=null,this._video.currentTime=e,new Promise(((e,t)=>{this._lastSeekReject=t;const n=()=>{e(this._video.currentTime),this._video.removeEventListener("seeked",n)};this._video.addEventListener("seeked",n)})))))},n.seekToTime=function(e){if(!this.eventHasDVREnabled||e===this.currentTime)return Promise.resolve();let t;if(null===this._timeToSeekTo||(this._lastSeekReject&&(this._lastSeekReject(),this._lastSeekReject=null),this._seekInProgressPromise=null,this._timeToSeekTo=null,this._resolveSeek=null),this._timeToSeekTo=e,!this._abr.canPlayFromTimeInStream(e,this._getCurrentStream()))try{this._segmentsAdded={};for(const e in this._streams)if(this._streams[e].length>0){const t=this.sorcerer[e].activeStreamIndex;this.sorcerer[e].streams[t].abort()}t=this._sorcerer.removeBuffer()}catch(n){}return this._seekInProgressPromise=this._getSeekReadyPromiseForTime(e),Promise.all([this._videoReady,t]).then((()=>(this._loadSegments(),this._seekInProgressPromise))).catch((e=>{}))},n.onpause=function(){var t;e.prototype.onpause.call(this),this.eventHasDVREnabled?this.atLiveEdge=!1:(null==(t=this._manifestLoader)||t.stop(),this._sorcerer&&(this._sorcerer.abortFetches(),this._segmentsAdded={},this._sorcerer.removeBuffer().catch((()=>{}))))},n.onplay=function(){this.eventHasDVREnabled||this._playInitiated&&this._refreshManifest()},n.pause=function(){this.eventHasDVREnabled&&(this.atLiveEdge=!1),e.prototype.pause.call(this)},n.play=function(){const t=this;return e.prototype.play.call(this,uc((function(){return t._preloadReady.resolve(),null!==t._timeToSeekTo?Promise.resolve(t._seekInProgressPromise):ac((function(){if(t._playInitiated&&!t.eventHasDVREnabled)return t._segmentsAdded={},oc(ic((function(){return cc(t._sorcerer.removeBuffer())}),(function(e){})),(function(){return cc(t._refreshManifest())}))}),(function(){return rc(t._videoReady,(function(){return t._loadSegments(),rc(t._bufferAvailable(),(function(){const e=Math.max(t._latencyController.liveSyncPosition,t._video.buffered.start(0));return t._atLiveEdge?t.currentTime=e:t.currentTime=t._video.currentTime,t._playInitiated=!0,Promise.resolve()}))}))}))})))},n._bufferAvailable=function(){return new Promise((e=>{const t=()=>{this.buffered.length&&(this._sorcerer.off("appendbufferend",t),this.preloadStreamIndex=null,e())};this._sorcerer.on("appendbufferend",t),t()}))},n._getSegmentTimeoutMs=function(){return this._abr.getSegmentRelativeTimeout(this._streams.video,this._getCurrentStream("video"),1e3*this.segmentLength)},n._loadMediaManifest=function(){return Promise.resolve().then((function(){return Ao}))},n.setCaptionsShouldDisplay=function(e){this._captionsVisible=e},n.setCaptionsShouldLoad=function(e){this._captionsLoading=e},l(t,[{key:"preload",get:function(){return this._preload},set:function(e){this._preload!==e&&"none"!==e&&this._preloadReady.resolve(),this._preload=e}},{key:"latency",get:function(){var e;return null==(e=this._latencyController)?void 0:e.latency}},{key:"lowLatencyMode",get:function(){return this._lowLatencyMode},set:function(e){this._lowLatencyMode=e,this._manifestLoader&&(this._manifestLoader.lowLatencyMode=e)}},{key:"downloadSpeed",get:function(){return this._abr.getCurrentSpeed()}},{key:"restrictedStreamIndexes",get:function(){return this._restrictedStreamIndexes},set:function(e){this._restrictedStreamIndexes.join(",")!==e.join(",")&&(this._restrictedStreamIndexes=e,this._abr.lock(this._restrictedStreamIndexes))}},{key:"preloadStreamIndex",get:function(){return this._preloadStreamIndex},set:function(e){this._preloadStreamIndex=e;const t=null!==e?[this._preloadStreamIndex]:this._restrictedStreamIndexes;this._abr.lock(t)}},{key:"videoWidth",get:function(){return this._stream?this._stream.width:this._video.videoWidth}},{key:"videoHeight",get:function(){return this._stream?this._stream.height:this._video.videoHeight}},{key:"currentTime",get:function(){return null!==this._timeToSeekTo?this._timeToSeekTo:this._video.currentTime},set:function(e){this._video.readyState<=this._video.HAVE_NOTHING||(this.eventHasDVREnabled&&this._playInitiated?this._shouldSnapToLiveEdge(e)?(this.atLiveEdge=!0,this.seekToTime(this.liveEdgeTime)):(this.atLiveEdge=!1,this.seekToTime(Math.max(e,this.liveTailTime))):this._video.currentTime=e)}},{key:"liveEdgeTime",get:function(){return this._latencyController.liveSyncPosition}},{key:"atLiveEdge",get:function(){return this._atLiveEdge},set:function(e){this.atLiveEdge!==e&&this.eventHasDVREnabled&&(this._atLiveEdge=e,this._video.playbackRate>1&&e&&(this._video.playbackRate=1),this.lowLatencyMode=!!this.eventIsLowLatency&&e,this.bufferTarget=e?this.defaultBufferTarget:18,e&&(this.presentationDelay=this.defaultPresentationDelay))}},{key:"atLiveTail",get:function(){return this._atLiveTail},set:function(e){this.atLiveTail!==e&&this.eventHasDVREnabled&&(this._atLiveTail=e,this._video.playbackRate<1&&e&&(this._video.playbackRate=1))}},{key:"liveTailTime",get:function(){var e,t;const n=null!==(e=null==(t=this._getCurrentStream())||null==(t=t.segments)||null==(t=t[0])?void 0:t.start)&&void 0!==e?e:0;return Math.max(n,0)}},{key:"ended",get:function(){return this._hasLiveEventEnded}},{key:"isLowerProfileAvailable",get:function(){return this._sorcerer?this._sorcerer.video.activeStreamIndex>0:null}},{key:"sorcerer",get:function(){return this._sorcerer}},{key:"segmentLength",get:function(){var e,t;return this.lowLatencyMode&&(null==(e=this._manifestLoader)||null==(e=e.activeStream("video"))?void 0:e.partTargetDuration)||(null==(t=this._manifestLoader)||null==(t=t.activeStream("video"))?void 0:t.targetDuration)}}],[{key:"displayName",get:function(){return"HLSLiveScanner"}},{key:"supportedVideoTypes",get:function(){return["application/x-mpegURL"]}}])}(es);function fc(e){return e.forEach(((e,t)=>{e.index=t})),e}const pc=document.createElement("video"),_c={"application/x-mpegURL":"application/x-mpegURL"};let mc=function(e){function t(t,n={}){var r,i;return(i=e.call(this,t,n)||this)._apiManifestUrl=null,i._playInitiated=!1,i._atLiveEdge=!0,i._atLiveTail=!1,i._secondsBehindPlaylistStart=0,i._playlistOffsetSet=!1,i.reset(),i.dvrEnabled=null!==(r=n.dvrEnabled)&&void 0!==r&&r,i.getLiveEventStartTimeEpoch=n.getLiveEventStartTimeEpoch,window.addEventListener("online",(()=>{i.play()})),i}p(t,e),t.supported=function(){return t.supportedVideoTypes.length>0};var n=t.prototype;return n.deactivate=function(){e.prototype.deactivate.call(this),this.reset()},n.reset=function(){this._manifestRefreshTimeout&&clearTimeout(this._manifestRefreshTimeout),this._onReady=null,this._manifestRefreshTimeout=null,this._isOnline=!1,this._hasLiveEventEnded=!1,this._hlsAvailabilityCheckTimeout=null,this._bufferedIndex=0,this._manifestRefreshTimeout=null,this._secondsBehindPlaylistStart=0,this._playlistOffsetSet=!1,this._abr=new Yu(this,this._options),this._restrictedStreamIndexes=[]},n.endLive=function(){this._isOnline=!1,this._hasLiveEventEnded=!0,clearTimeout(this._manifestRefreshTimeout),this._video.pause(),function(e){setTimeout(e,0)}((()=>{e.prototype.deactivate.call(this),this.fire(Di.ENDED)}))},n._setUpRefreshTimer=function(){const e=$(this.video.metadata.playlistRefreshUrl.split("?")[1]);e.expires&&(this._manifestRefreshTimeout=setTimeout((()=>{this._refreshLiveApiPlaylistUrl()}),1e3*(e.expires-10)))},n._refreshLiveApiPlaylistUrl=function(e=0){const t=this.video.metadata.playlistRefreshUrl;return Se(t).json().then((n=>{if(!("url"in n))throw new Error(`Error parsing 'url' key from player live API refresh endpoint: ${t} ${n}`);return this._loadNativeHlsManifest(n.url.hls).then((()=>(this.play(),this._checkHlsAvailability(5e3),null))).catch((()=>this._refreshLiveApiPlaylistUrl(++e)))})).catch((()=>{if(e>=3)throw new Error(`Manifest failed to load after ${e} attempts.`);return++e,this._refreshLiveApiPlaylistUrl(e)}))},n._setUpLiveEventListeners=function(){this.on(Mi.STREAM_OFFLINE,(()=>{this._isOnline=!1}))},n._setUpNativeHls=function(e){return this._setUpLiveEventListeners(),this._isOnline=!0,this.fire(Mi.STREAM_ONLINE),this._checkHlsAvailability(5e3),Promise.resolve(e)},n._loadNativeHlsManifest=function(e){return this._apiManifestUrl=e,/json=1/.test(e)?Se(e).json().then((e=>{if(!("url"in e))throw new Error(`Error parsing 'url' key from Live API manifest endpoint: ${this._apiManifestUrl} ${e}`);this._video.src=this._getUrlWithMinSecondsParam(e.url),this._setUpRefreshTimer()})).catch((e=>{const t=this.video.metadata.playlistRefreshUrl;return Se(t).json().then((e=>{if(!("url"in e))throw new Error(`Error parsing 'url' key from player live API refresh endpoint: ${t} ${e}`);this._apiManifestUrl=e.url.ios,this._video.src=this._getUrlWithMinSecondsParam(e.url.ios),this._setUpRefreshTimer()}))})):(this._video.src=this._getUrlWithMinSecondsParam(e),this._setUpRefreshTimer(),Promise.resolve())},n._getUrlWithMinSecondsParam=function(e){if(this.dvrEnabled)return e;const t=new URL(e);return t.searchParams.set("min_seconds","30"),t.toString()},n._loadTextTracks=function(){const e=this._video.textTracks;if(null!=e&&e.length)for(let t=0;t<e.length;t++){const n=e[t];this._loadTextTrack(n)}},n._loadTextTrack=function(e){if(e&&!this._captionsTrack){const{label:t,kind:n,language:r,id:i}=e,o=new ec({label:t,kind:n,language:r,id:i},this._telecineVideo);this._telecineVideo.textTracks=ko([o]),this._addTextTrackListeners(o,e),this.fire(Ni.TEXT_TRACKS_AVAILABLE),this._captionsTrack=e}},n.setModeForTrack=function(e,t){return this._captionsTrack&&this._captionsTrack.mode!==t&&(this._captionsTrack.mode=t),this},n.getActiveCuesForTrack=function(e){return this._captionsTrack&&"disabled"!==this._captionsTrack.mode?this._captionsTrack.activeCues:[]},n.addTextTrack=function(e){return this._captionsTrack||this._loadTextTracks(),this._captionsTrack},n._checkHlsAvailability=function(e){"number"==typeof ze.iOS&&ze.iOS<9||this._hlsAvailabilityCheckTimeout||(this._hlsAvailabilityCheckTimeout=setTimeout((()=>{if(!this._isOnline)return;const e=new XMLHttpRequest;e.onload=()=>{410!==e.status?(200!==e.status&&this.fire(Mi.STREAM_OFFLINE),e.response.match(/^#EXTM3U\n#EXT-X-VERSION:3\n$/)&&this.fire(Mi.STREAM_OFFLINE)):this._refreshLiveApiPlaylistUrl()},e.onerror=()=>{this.fire(Mi.STREAM_OFFLINE)},/json=1/.test(this._apiManifestUrl)?Se(this._apiManifestUrl).json().then((t=>{"url"in t||this.fire(Mi.STREAM_OFFLINE),e.open("GET",t.url),e.send()})).catch((()=>{e.open("GET",this._apiManifestUrl),e.send()})):(e.open("GET",this._apiManifestUrl),e.send())}),e))},n._shouldSnapToLiveEdge=function(e){return e>=this.liveEdgeTime-3},n._hasDriftedBehindLiveEdge=function(e){return e>=this.liveEdgeTime-6},n._isNearLiveTail=function(e){return e<=this.liveTailTime+6},n.setVideoSrc=function(e){this._onReady=this._setUpNativeHls(e).then((()=>(this._apiManifestUrl=e,this._loadNativeHlsManifest(e))))},n.ontimeupdate=function(){e.prototype.ontimeupdate.call(this),this.atLiveTail=this._isNearLiveTail(this._video.currentTime),this._shouldSnapToLiveEdge(this._video.currentTime)?this.atLiveEdge=!0:(this._video.playbackRate<1||this._hasDriftedBehindLiveEdge())&&(this.atLiveEdge=!1)},n.onplaying=function(){this._playInitiated=!0},n.oncanplay=function(){if(!this._playInitiated){const e=this._video.seekable.length;e>0&&(this._video.currentTime=this._video.seekable.end(e-1))}if(!this._playlistOffsetSet){this._playlistOffsetSet=!0;const e=this._video.getStartDate().getTime()/1e3;this._secondsBehindPlaylistStart=e-this.getLiveEventStartTimeEpoch()}this._loadTextTracks()},n.onprogress=function(){this._hlsAvailabilityCheckTimeout&&(clearTimeout(this._hlsAvailabilityCheckTimeout),this._hlsAvailabilityCheckTimeout=null)},n.onstalled=function(){this._checkHlsAvailability(1e4)},n.onerror=function(){return this._video.error.code===this._video.error.MEDIA_ERR_SRC_NOT_SUPPORTED?(Se(this._apiManifestUrl).then((()=>{e.prototype.onerror.call(this)})).catch((t=>{t instanceof re?this.fire(Di.ERROR,new No("MediaNetworkError","A network error ocurred while fetching the media.")):e.prototype.onerror.call(this)})),!1):e.prototype.onerror.call(this)},n.onwaiting=function(){this._checkHlsAvailability(1e4)},n.pause=function(){this.dvrEnabled&&(this.atLiveEdge=!1),e.prototype.pause.call(this)},n.play=function(){return e.prototype.play.call(this,(()=>this._onReady))},l(t,[{key:"currentTime",get:function(){return this._secondsBehindPlaylistStart+this._video.currentTime},set:function(e){if(this.liveEdgeTime){const t=e>=this.liveEdgeTime-3;this.atLiveEdge=t}this._video.currentTime=e-this._secondsBehindPlaylistStart}},{key:"liveEdgeTime",get:function(){const e=this._video.seekable.length;return e>0?this._secondsBehindPlaylistStart+this._video.seekable.end(e-1):0}},{key:"atLiveEdge",get:function(){return this._atLiveEdge},set:function(e){this.dvrEnabled&&(this._atLiveEdge=e,this._video.playbackRate>1&&e&&(this._video.playbackRate=1))}},{key:"atLiveTail",get:function(){return this._atLiveTail},set:function(e){this.dvrEnabled&&(this._atLiveTail=e,this._video.playbackRate<1&&e&&(this._video.playbackRate=1))}},{key:"liveTailTime",get:function(){return this._video.seekable.length>0?this._secondsBehindPlaylistStart+this._video.seekable.start(0):0}},{key:"ended",get:function(){return this._hasLiveEventEnded}},{key:"supportsPlaybackRate",get:function(){return e.prototype.supportsPlaybackRate&&this.dvrEnabled}}],[{key:"displayName",get:function(){return"NativeHLSLiveScanner"}},{key:"supportedVideoTypes",get:function(){const e=[];if("function"!=typeof pc.canPlayType)return e;for(const t in _c){const n=_c[t];pc.canPlayType(n).replace(/^no$/,"")&&e.push(t)}return e}}])}(es),vc=function(){function e(e,t={}){this._telecine=e,this._element=e._element,this._options=t}var t=e.prototype;return t.activate=function(){throw new No("NotImplemented","The effect must implement the activate method.")},t.deactivate=function(){throw new No("NotImplemented","The effect must implement the deactivate method.")},l(e,null,[{key:"displayName",get:function(){return"Effect"}},{key:"supported",get:function(){return!1}},{key:"supportedScanners",get:function(){return[]}}])}();const gc=new WeakMap,yc=new WeakMap;let Ec=function(){return l((function({src:e,mime:t,id:n=Z(),priority:r=0,metadata:i={}},o){if(!e)throw new TypeError("Must provide a src for the file.");if(!t)throw new TypeError("Must provide a mime type for the file.");Object.defineProperties(this,{mime:{value:t,enumerable:!0},id:{value:`${n}`,enumerable:!0},metadata:{value:i,enumerable:!0}}),this.video=o,this.priority=r,this.src=e}),[{key:"priority",get:function(){return gc.get(this)},set:function(e){if(!("number"==typeof(e=parseInt(e,10))&&isFinite(e)&&Math.floor(e)===e&&e>=0))throw new TypeError("The file priority must be an integer greater than or equal to 0.");gc.set(this,e)}},{key:"src",get:function(){return yc.get(this)},set:function(e){yc.set(this,e),this.video.fire(Ni.FILE_SRC_UPDATE,this)}},{key:"restrictedStreamIndexes",get:function(){if(!Object.getOwnPropertyDescriptor(Object.getPrototypeOf(this.video.currentScanner),"restrictedStreamIndexes"))throw new ReferenceError("The current scanner does not support streams.");return this.video.currentScanner.restrictedStreamIndexes},set:function(e){if(!Array.isArray(e))throw new TypeError("Indexes must be an array.");if(!Object.getOwnPropertyDescriptor(Object.getPrototypeOf(this.video.currentScanner),"restrictedStreamIndexes"))throw new ReferenceError("The current scanner does not support streams.");this.video.currentScanner.restrictedStreamIndexes=e}}])}(),Tc=function(e){function t({enabled:t=!1,id:n=Z(),kind:r="",label:i="",language:o="",provenance:s=""},a){var u;return(u=e.call(this)||this)._enabled=t,Object.defineProperties(u,{kind:{value:r,enumerable:!0},label:{value:i,enumerable:!0},language:{value:o,enumerable:!0},id:{value:`${n}`,enumerable:!0},provenance:{value:s,enumerable:!0}}),u.video=a,u}return p(t,e),t.prototype.dispatchEvent=function(e){this.fire(e,{target:this})},l(t,[{key:"enabled",get:function(){return this._enabled},set:function(e){this._enabled=e}},{key:"active",get:function(){return this._enabled}}])}(bn);const Sc="default";let bc=function(){function e(){this._cdmList={},this._preferredKeySystems={},this._licenseTokenUrls={},this._licenseUrls={},this._certificateUrls={},this._keySessions={},this._keyChainState=Sc,this._keyTypes={KEYCHAIN_DEFAULT:Sc,KEYCHAIN_SD_FALLBACK:"sd-fallback"}}var t=e.prototype;return t.getAllKeySessions=function(){return Object.values(this._keySessions)||[]},t.getCdms=function(e){return this._cdmList[e]},t.getAllPreferredKeySystems=function(){return this._preferredKeySystems},t.addCdms=function(e,t){this._cdmList[t]=e},t.addKeySession=function(e,t){this._keySessions[t]=e},t.addLicenseTokenUrl=function(e,t){this._licenseTokenUrls[t]=e},t.addLicenseUrl=function(e,t){this._licenseUrls[t]=e},t.addPreferredKeySystem=function(e,t){this._preferredKeySystems[t]=e},t.closeAllKeySessions=function(){for(let e in this._keySessions)this._keySessions[e]&&this._keySessions[e].sessionId&&this._keySessions[e].close()},l(e,[{key:"state",get:function(){return this._keyChainState},set:function(e){Object.values(this._keyTypes).indexOf(e)<0||(this._keyChainState=e)}},{key:"activeKeySession",get:function(){return this._keySessions[this._keyChainState]}},{key:"activeKeySystem",get:function(){return this._preferredKeySystems[this._keyChainState]}},{key:"keyTypes",get:function(){return this._keyTypes}},{key:"activeLicenseTokenUrl",get:function(){return this._licenseTokenUrls[this._keyChainState]}},{key:"activeLicenseUrl",get:function(){return this._licenseUrls[this._keyChainState]}}])}();function Ac(e,t,n){return n?t?t(e):e:(e&&e.then||(e=Promise.resolve(e)),t?e.then(t):e)}let wc=function(){function e(e,t,n={}){this._hasFallbackAssets=!!e.fallback_asset,this._useHls=t,this._drmLaUrlParams=n,this._fallbackCallback=()=>null,this._currentTime=0,this._firstLaUrlRequest=!0,this._hasFallbackSourceUpdated=!1,this._encryptedEventName=null,this._boundGenerateRequest=this._generateRequest.bind(this),this._boundOnKeyStatus=this._onKeyStatus.bind(this),this._boundUpdateTimeRef=this.updateTimeRef.bind(this),this._keyChain=new bc,this._keyTypes=this._keyChain.keyTypes,this._keyChain.state=this._keyTypes.KEYCHAIN_DEFAULT,this.updateLAUrls(e)}var t=e.prototype;return t.init=function(e,t={},n={}){try{let r=!1;const i=this;return i._video=e._video,i._scanner=e,i._useMs=!!window.MSMediaKeys,window.MediaKeys&&window.navigator&&window.navigator.requestMediaKeySystemAccess&&window.MediaKeySystemAccess&&window.MediaKeySystemAccess.prototype.getConfiguration||window.WebKitMediaKeys||i._useMs?(n=i._initDataToArray(n),Ac(Ic((function(){if(i._keyChain.state===i._keyTypes.KEYCHAIN_SD_FALLBACK)return i._scanner.once("seeking",i._boundUpdateTimeRef),i._hasFallbackSourceUpdated=!0,Ac(i.waitForPlay(),(function(){const e=i.setUpKeySystem(t,n,i._keyTypes.KEYCHAIN_SD_FALLBACK).then((()=>{i._scanner.currentTime=i._currentTime,i._scanner.play()}));return r=!0,e}))}),(function(e){if(r)return e;const o=i._keyChain.getCdms(i._keyTypes.KEYCHAIN_DEFAULT);return o?Ac(ju(o,i._useHls,i._useMs,t),(function(e){let r=!1;const{keySystem:o}=i.getPreferredMediaKeySystem(e);return Ic((function(){if(i._hasFallbackAssets){const e=null==o?void 0:o.getStatusForPolicy;return Ac(e?o.getStatusForPolicy({minHdcpVersion:"1.0"}):"usable",(function(e){if("output-restricted"===e){const e=i._fallBackToSD();return r=!0,e}}),!e)}}),(function(e){return r?e:Ac(i.waitForPlay(),(function(){return i.setUpKeySystem(t,n)}))}))})):Promise.reject(`No CDMs set for keyType: ${i._keyTypes.KEYCHAIN_DEFAULT}`)})))):(i._scanner.fire(Ni.EME_UNSUPPORTED),Promise.reject())}catch(Rp){return Promise.reject(Rp)}},t.updateTimeRef=function(){this._currentTime=this._scanner.currentTime},t.updateLAUrls=function(e){this._keyChain.addCdms(e.cdms,this._keyTypes.KEYCHAIN_DEFAULT),e.fallback_asset&&this._keyChain.addCdms(e.fallback_cdms,this._keyTypes.KEYCHAIN_SD_FALLBACK)},t.waitForPlay=function(){try{const e=this;return Ac(new Promise((t=>{e._scanner.paused&&!e._scanner.isPlayRequestActive?e._scanner.once("play",(()=>t())):t()})))}catch(Rp){return Promise.reject(Rp)}},t._initDataToArray=function(e={}){if(void 0===e||void 0===e.inits)return e;const t=oi(e);for(var n=0,r=Object.entries(t.inits);n<r.length;n++){const[t,s]=r[n];for(var i=0,o=Object.entries(s);i<o.length;i++){const[t,n]=o[i];if(void 0===n||void 0===n.initData)return e;n.initData=Po(n.initData)}}return t},t.getPreferredMediaKeySystem=function(e){return e.find((e=>"com.microsoft.playready"!==e.name&&null!==e.keySystem))},t.setUpKeySystem=function(e,t,n=this._keyTypes.KEYCHAIN_DEFAULT){return new Promise(((r,i)=>{const o=this,s=this._keyChain.getCdms(n);return s?ju(s,this._useHls,this._useMs,e).then(function(e){return function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];try{return Promise.resolve(e.apply(this,t))}catch(Rp){return Promise.reject(Rp)}}}((function(e){const r=o.getPreferredMediaKeySystem(e);o._keyChain.addPreferredKeySystem(r,n);const i=o._keyChain.activeKeySystem&&function(e,t){let n=null;return Object.keys(e).forEach((r=>{t.name===e[r].id&&(n=e[r])})),n}(s,o._keyChain.activeKeySystem);if(!i)throw o._scanner.fire(Ni.EME_UNSUPPORTED),new Error("No valid key system was found.");return Ic((function(){if(i.certificate)return function(e){return e&&e.then?e.then(Rc):Promise.resolve()}(Vu(i.certificate,r.keySystem))}),(function(){o._keyChain.addLicenseTokenUrl(i.license_url,n);const e=t&&t.inits&&t.inits[i.id];return e||o._addEncryptedHandler(i,n),o._setMediaKeys(n).then((()=>{const t=o._keyChain.state===n;return e&&t&&o._generateRequest(e.cenc,n)}))}))}))).then(r):i("No CDMs set for keyType: ",n)}))},t.destroy=function(){this._keyChain&&this._keyChain.closeAllKeySessions(),this._video&&this._video.removeEventListener(this._encryptedEventName,this._boundGenerateRequest)},t._switchKeyChainState=function(e){return new Promise((t=>{var n;this._keyChain.state=e,null==(n=this._keyChain.activeKeySession)||n.addEventListener("message",(e=>this._getLicense(e))),t()}))},t._addEncryptedHandler=function(e,t){this._encryptedEventName="encrypted",this._keyChain.addLicenseUrl(e.license_url,t),this._useHls?(this._certificateUrl=e.certificate_url,this._encryptedEventName="webkitneedkey"):this._useMs&&(this._encryptedEventName="msneedkey"),this._video.addEventListener(this._encryptedEventName,this._boundGenerateRequest)},t._setMediaKeys=function(e){return new Promise((t=>{if(this._useMs){const e=()=>{this._video.msSetMediaKeys(this._keyChain.activeKeySystem.keySystem),this._video.removeEventListener("loadedmetadata",e),t()};this._video.readyState>=1?e():this._video.addEventListener("loadedmetadata",e)}else{if(this._useHls)this._video.webkitSetMediaKeys(this._keyChain.activeKeySystem.keySystem);else{const t=this._video.mediaKeys||this._keyChain.activeKeySystem.keySystem;this._keyChain.addKeySession(this._createSession(t),e),e===this._keyChain.state&&this._keyChain.activeKeySession.addEventListener("message",(e=>this._getLicense(e))),this._video.mediaKeys||this._video.setMediaKeys(this._keyChain.activeKeySystem.keySystem)}t()}}))},t._createSession=function(e,t,n){const r=e.createSession(t,n);if(!r)throw new Error("Could not create key session");return r},t._generateRequest=function(e,t){t=t||this._keyChain.state;const n=new Error("A decryption key error was encountered");return"com.apple.fps.1_0"===this._keyChain.activeKeySystem.name?(this._loadFairPlayCertificate(this._certificateUrl).then((r=>{this._contentId=function(e){const t=function(e){const t=new Uint16Array(e.buffer);return String.fromCharCode.apply(null,t)}(e),n=document.createElement("a");return n.href=t,n.hostname}(e.initData);const i=function(e,t,n){const r=new Uint8Array(function(e){const t=new ArrayBuffer(2*e.length),n=new Uint16Array(t);for(let r=0,i=e.length;r<i;r++)n[r]=e.charCodeAt(r);return n}(t).buffer);let i=0;const o=new ArrayBuffer(e.byteLength+4+r.byteLength+4+n.byteLength),s=new DataView(o);new Uint8Array(o,i,e.byteLength).set(e),i+=e.byteLength,s.setUint32(i,r.byteLength,!0),i+=4;const a=new Uint8Array(o,i,r.byteLength);return a.set(r),i+=a.byteLength,s.setUint32(i,n.byteLength,!0),i+=4,new Uint8Array(o,i,n.byteLength).set(n),new Uint8Array(o,0,o.byteLength)}(e.initData,this._contentId,r);return this._keyChain.addKeySession(this._createSession(this._keyChain.activeKeySystem.keySystem,"video/mp4",i),t),this._keyChain.activeKeySession.contentId=this._contentId,this._keyChain.activeKeySession.addEventListener("webkitkeymessage",(e=>this._getLicense(e))),this._keyChain.activeKeySession.addEventListener("webkitkeyerror",(e=>{throw n})),r})).catch((e=>{this._scanner.fire(e.error,e.payload)})),!0):"com.microsoft.playready"===this._keyChain.activeKeySystem.name?(this._keyChain.addKeySession(this._createSession(this._video.msKeys,"video/mp4",e.initData),t),this._keyChain.activeKeySession.addEventListener("mskeymessage",(e=>this._getLicense(e))),this._keyChain.activeKeySession.addEventListener("mskeyerror",(e=>{throw n})),!0):!this._keyChain.activeKeySession.sessionId&&!this._activeKeySession&&(this._keyChain.activeKeySession.addEventListener("keystatuseschange",this._boundOnKeyStatus),this._activeKeySession=this._keyChain.activeKeySession.generateRequest(e.initDataType,e.initData).catch((()=>{this._scanner.fire(Ni.DRM_FAILURE)})),!0)},t._onKeyStatus=function(){let e=!1;const t=Array.from(this._keyChain.activeKeySession.keyStatuses.values());if(t.forEach(((t,n)=>{"expired"===t&&(e=!0)})),t.length&&t.every((e=>"output-restricted"===e))){if(this._hasFallbackAssets)return void this._fallBackToSD();this._scanner.fire(Ni.DRM_OUTPUT_RESTRICTED)}e&&this._keyChain.activeKeySession.close()},t._getLicense=function(e){return this._getLicenseUrl(this._keyChain.activeLicenseTokenUrl).then((t=>new Promise(((n,r)=>{this._keyChain.addLicenseUrl(t,this._keyChain.state),this._activeKeySession=null;const i=new XMLHttpRequest;i.keySession=e.target,i.open("POST",this._keyChain.activeLicenseUrl),i.responseType="arraybuffer";let o=e.message;if("com.microsoft.playready"===this._keyChain.activeKeySystem.name){const t=function(e){const t=e,n=String.fromCharCode.apply(null,new Uint16Array(t)),r=(new DOMParser).parseFromString(n,"application/xml"),i={},o=r.getElementsByTagName("HttpHeader");for(let s=0;s<o.length;++s){const e=o[s].querySelector("name"),t=o[s].querySelector("value");e&&t&&(i[e.textContent]=t.textContent)}return[i,Po(r.querySelector("Challenge").textContent)]}(e.message),n=t[0];Object.keys(n).forEach((e=>{i.setRequestHeader(e,n[e])})),o=t[1]}"com.apple.fps.1_0"===this._keyChain.activeKeySystem.name&&(o=new Uint8Array(o),i.setRequestHeader("Content-type","application/octet-stream")),i.onload=()=>{if(403!==i.status)if(i.status>=400)r(new No(Ni.DRM_FAILURE));else try{this._scanner.fire(Ni.DRM_AUTH_SUCCESS);const e=new Uint8Array(i.response);i.keySession.update(e),n()}catch(Rp){r(new No(Ni.DRM_FAILURE,`Error updating key session: ${Rp}`))}else r(new No(Ni.DRM_AUTH_FAILURE))},i.onerror=r,i.send(o)})).catch((e=>{this._scanner.fire(e.name,{text:e.message||"License request failed."})}))))},t._getLicenseUrl=function(e){const t=((e,t)=>{const{atid:n,dnt:r,context:i,leadUUID:o,playerLocation:s,firstLog:a,playbackRoute:u,referrer:c}=t;return Q(e,{atid:n,context:i,referrer:c,dnt:1===r?r:void 0,first_log:a?"1":void 0,lead_uuid:o,player_location:s,playback_route:u},!0)})(e,g(g({},this._drmLaUrlParams),{},{firstLog:this._firstLaUrlRequest}));return new Promise(((e,n)=>{const r=new XMLHttpRequest;r.withCredentials=!0,r.open("GET",t),r.onload=()=>{if(r.status>=400)n(new No(Ni.DRM_FAILURE));else try{try{const t=JSON.parse(r.response),{licenseAcquisitionUrl:n,token:i}=t;if(!n&&!i)throw new Error;e(`${n}?ExpressPlayToken=${i}`)}catch(t){e(r.response)}}catch(Rp){n(new No(Ni.DRM_FAILURE,`Error retrieving License Acquisition URL (LA_URL): ${Rp}`))}},r.onerror=n,r.send(),this._firstLaUrlRequest=!1}))},t._loadFairPlayCertificate=function(e){return new Promise(((t,n)=>{const r=new XMLHttpRequest;r.open("GET",e),r.responseType="arraybuffer",r.setRequestHeader("Pragma","Cache-Control: no-cache"),r.setRequestHeader("Cache-Control","max-age=0"),r.onload=()=>{if(403!==r.status)if(r.status>=400)n({error:Ni.DRM_FAILURE});else try{t(new Uint8Array(r.response))}catch(Rp){n(Rp)}else n({error:Ni.DRM_AUTH_FAILURE})},r.onerror=n,r.send()}))},t._fallBackToSD=function(){this.updateTimeRef(),this._switchKeyChainState(this._keyTypes.KEYCHAIN_SD_FALLBACK).then((()=>{this._fallbackCallback(),this._scanner.fire(Ni.DRM_KEY_SWITCH,this._keyTypes.KEYCHAIN_SD_FALLBACK)})).catch((e=>{this._scanner.fire(Ni.DRM_OUTPUT_RESTRICTED)}))},t.setFallbackCallback=function(e){this._fallbackCallback=()=>e()},l(e,[{key:"state",get:function(){return this._keyChain.state}},{key:"hasFallbackAssets",get:function(){return this._hasFallbackAssets}},{key:"hasFallbackSourceUpdated",get:function(){return this._hasFallbackSourceUpdated},set:function(e){this._hasFallbackSourceUpdated=e}}])}();function Ic(e,t){var n=e();return n&&n.then?n.then(t):t(n)}function Rc(){}const kc=(()=>{const e=navigator.userAgent.match(/Chrom(?:e|ium)\/([0-9]+)\.([0-9]+)\./);return!!e&&{major:parseInt(e[1],10),minor:parseInt(e[2],10)}})(),Pc=document.createElement("video"),Dc={settingPlaybackRate:(()=>{if(ze.android&&kc&&"object"==typeof kc&&kc.major<52)return!1;const e=Pc.playbackRate;Pc.playbackRate=.5*e;const t=e!==Pc.playbackRate;return Pc.playbackRate=e,t})(),settingVolume:(()=>{if(ze.android||ze.iOS||ze.iPadOS)return!1;const e=Pc.volume;return Pc.volume=.5*e,Pc.volume!==e})(),textTracks:void 0!==Pc.textTracks&&"undefined"!=typeof TextTrackList&&Pc.textTracks instanceof TextTrackList},Oc=new WeakMap;let Lc=function(e){function t({files:t,id:n=Z(),title:r=null,subtitle:i=null,metadata:o={},textTracks:s=ko(),audioTracks:a=ko(),externalDisplayFiles:u={},chapters:c=[],duration:l}){var d;if(d=e.call(this)||this,!t||!Array.isArray(t))throw new TypeError("Must provide files for the video.");const h=function(e=[]){return e.getFileById=Ro,e}(t.map((e=>e instanceof Ec?(e.video=d,e):new Ec(e,d)))),f=ko(s.map((e=>e instanceof ec?(e.video=d,e):new ec(e,d))));if(d._audioTracksFromConfig=a,Object.keys(u).forEach((e=>{!u[e]||u[e]instanceof Ec||(u[e]=new Ec(u[e],d))})),Object.defineProperties(d,{id:{value:`${n}`,enumerable:!0},title:{value:r,enumerable:!0},subtitle:{value:i,enumerable:!0},metadata:{value:o,enumerable:!0},files:{value:h,enumerable:!0},textTracks:{value:f,enumerable:!0,writable:!0},chapters:{value:c,enumerable:!0},duration:{value:l,enumerable:!0},externalDisplayFiles:{value:u,enumerable:!0}}),o.drm){const{drm:e,useHls:t,drmLaUrlParams:n}=o;d._drmHandler=new wc(e,t,n)}return d}return p(t,e),t.prototype.deactivate=function(){this._drmHandler&&this._drmHandler.destroy(),this.textTracks.forEach((e=>this.currentScanner.removeTextTrack(e)))},l(t,[{key:"drmHandler",get:function(){return this._drmHandler||null}},{key:"currentFile",get:function(){return this.currentScanner.currentFile},set:function(e){this.currentScanner.currentFile=e}},{key:"currentScanner",get:function(){return Oc.get(this)},set:function(e){this.currentScanner&&Dc.textTracks&&this.textTracks.forEach((e=>this.currentScanner.removeTextTrack(e))),Dc.textTracks&&this.textTracks.forEach((t=>e.addTextTrack(t))),Oc.set(this,e)}},{key:"chapters",get:function(){return this.chapters}},{key:"audioTracks",get:function(){return ko((this.currentScanner.constructor.supportsVideoElementAudioTracks?Array.from(this.currentScanner.audioTracks):this._audioTracksFromConfig).map((e=>e instanceof Tc?(e.video=this,e):new Tc(e,this))))}},{key:"enabledAudioTrack",get:function(){return this.audioTracks.find((e=>!!e.enabled))}}])}(bn),Cc=function(e){function t(t,n={}){var r;return(r=e.call(this)||this)._telecine=t,r._options=n,r._bufferInterval=null,r._lastBufferCheckVideoTime=r._options.embedTime?r._options.embedTime:0,r._isBuffering=!1,r._isSeeking=!1,r._userPlayState=!1,r.playInitiated=!1,r._isLiveStreamOnline=!1,r._checkInterval=250,r._boundEndBuffering=r._endBuffering.bind(r),r._boundOnPause=r._onPause.bind(r),r._boundOnSeeking=r._onSeeking.bind(r),r._boundOnSeeked=r._onSeeked.bind(r),r._boundOnLiveOnline=r._onLiveOnline.bind(r),r._boundOnLiveOffline=r._onLiveOffline.bind(r),r._toggleEvents(r._telecine.on),r._options.noInterval||r._setUpRebufferMonitor(),r}p(t,e);var n=t.prototype;return n.destroy=function(){clearInterval(this._bufferInterval),this._toggleEvents(this._telecine.off),this._endBuffering()},n._toggleEvents=function(e){e(Di.PAUSE,this._boundOnPause),e(Di.PLAYING,this._boundEndBuffering),e(Di.SEEKING,this._boundOnSeeking),e(Di.SEEKED,this._boundOnSeeked),e(Mi.STREAM_ONLINE,this._boundOnLiveOnline),e(Mi.STREAM_OFFLINE,this._boundOnLiveOffline)},n._onPause=function(){this.userPlayState=!1},n._endBuffering=function(){this._isBuffering&&(this._isBuffering=!1,this.fire(Ni.BUFFER_ENDED))},n._onSeeking=function(){this._isSeeking=!0},n._onSeeked=function(){this._isSeeking=!1},n._onLiveOnline=function(){this._isLiveStreamOnline=!0},n._onLiveOffline=function(){this._isLiveStreamOnline=!1},n._setUpRebufferMonitor=function(){clearInterval(this._bufferInterval),this._bufferInterval=setInterval(this.runIntervalCheck.bind(this),this._checkInterval)},n.runIntervalCheck=function(){if(!this._telecine.video)return;const e=this._telecine.video.currentScanner;if(!e)return;const t=this._telecine.isLive(),n=e.currentTime,r=this._checkInterval/2/1e3;if(this.playInitiated&&(!this._isSeeking||t)&&(!this._telecine.paused||this.userPlayState)&&!this._isBuffering&&n<this._lastBufferCheckVideoTime+r){if(t&&!this._isLiveStreamOnline)return;const e=this._telecine.buffered;for(let t=0;t<e.length;t++)if(n>=e.start(t)&&n+.2<=e.end(t))return void(this._lastBufferCheckVideoTime=n);if(n+r>=this._telecine.duration)return;this._isBuffering=!0,this.fire(Ni.BUFFER_STARTED)}(this.playInitiated&&this._isBuffering&&n>this._lastBufferCheckVideoTime+r||t&&!this._isLiveStreamOnline&&this._isBuffering)&&(this._isBuffering=!1,this.fire(Ni.BUFFER_ENDED)),this._lastBufferCheckVideoTime=n},l(t,[{key:"userPlayState",get:function(){return this._userPlayState},set:function(e){this._userPlayState=e,e||this._endBuffering()}}])}(bn);function Nc(){let e,t;function n(){if(!t)return Promise.reject();e.preload="";let n=e.play();return void 0===n&&(n=new Promise((t=>{e.addEventListener("playing",t)}))),n}function r(){t&&(t.resolve(),t=null)}function i(e){t&&(t.reject(e),t=null)}return{set video(t){e=t},get video(){return e},get active(){return!!t},start:function(o=Promise.resolve.bind(Promise)){return t||(t=V()),e.currentSrc?document.createElement("video").load():e.load(),o().then(n).then(r).catch(i),t},cancel:function(){t&&(t.reject(new No(Xo,"The play() request was interrupted by a call to pause()")),t=null)}}}let Mc=function(e){function t(t,n,r={}){var i;return(i=e.call(this)||this)._element=t,i._scanners=n,i._options=r,i._video=null,i._textTracks=ko(),i._properties={},i._currentScanner=new es(t),i._options.playRequest=new Nc,i._blacklistedScanners=[],i._activeEffects=[],i._previousScanner=null,i._switchingVideo=!1,i._snapshotDisplayed=!1,i}p(t,e);var n=t.prototype;return n.supportsEffect=function(e){return!!e.supported&&e.supportedScanners.some((e=>this._getScannerName(this._currentScanner)===e.displayName))},n.getEffectByName=function(e){let t=null;return this._activeEffects.forEach((n=>{e===this._getEffectName(n)&&(t=n)})),t},n.activateEffect=function(e,t){const n=new e(this,t);return n.activate(),this._activeEffects.push(n),n},n.deactivateEffect=function(e){return this._activeEffects.some(((t,n)=>t.constructor===e&&(t.deactivate(),this._activeEffects.splice(n,1),!0)))},n.deactivateEffects=function(){this._activeEffects.forEach((e=>this.deactivateEffect(e.constructor)))},n.play=function(){if(!this._video||this._video.files.length<1)throw new No("NoFiles","There are no files to play.");this._rebufferMonitor.playInitiated||(this._rebufferMonitor.playInitiated=!0),this._rebufferMonitor.userPlayState=!0;const e=this._currentScanner.play();return this._properties.paused=!1,e},n.pause=function(){if(!this._video||this._video.files.length<1)throw new No("NoFiles","There are no files to play.");return this._rebufferMonitor.userPlayState=!1,this._currentScanner.pause(),this._properties.paused=!0,this},n.isLive=function(){return this.currentScannerName.includes("Live")},n.endLive=function(){this._currentScanner.endLive()},n.getBitrateAtTime=function(e,t="video",n="average"){var r,i;return"MediaSourceScanner"!==this._getScannerName(this._currentScanner)&&"HLSLiveScanner"!==this._getScannerName(this._currentScanner)||"audio"===t&&this._currentScanner._streams[t].length<=1?0:(null==(r=(i=this._currentScanner).getBitrateAtTime)?void 0:r.call(i,e,t,n))||0},n.getCurrentStream=function(e="video"){var t,n;return null==(t=(n=this._currentScanner).getCurrentStream)?void 0:t.call(n,e)},n.showExternalDisplayPicker=function(e){this._currentScanner.showExternalDisplayPicker(e)},n.requestPictureInPicture=function(){return this._currentScanner.requestPictureInPicture()},n.exitPictureInPicture=function(){return this._currentScanner.exitPictureInPicture()},n.addChapter=function(e,t){this._currentScanner.addChapter(e,t)},n.removeChapter=function(e){this._currentScanner.removeChapter(e)},n.addCuePoint=function(e,t){return this._currentScanner.addCuePoint(e,t)},n.removeCuePoint=function(e){return this._currentScanner.removeCuePoint(e)},n.removeAllCuePoints=function(){return this._currentScanner.removeAllCuePoints()},n.enableAudioTrack=function(e){return this._currentScanner.enableAudioTrack(e)},n.addVideoEventListeners=function(){return this._currentScanner.addVideoEventListeners()},n.removeVideoEventListeners=function(){return this._currentScanner.removeVideoEventListeners()},n._findScanner=function({textTrackSupport:e=!1}={}){if(e&&!Dc.textTracks)return null;const t=this._video.files.sort(((e,t)=>e.priority-t.priority)),n=this._scanners;for(const r in t){let e=t[r];for(const t in n){let r=n[t];if(r.supported(this._options.disableMMS)&&-1===this._blacklistedScanners.indexOf(this._getScannerName(r))&&r.supportedVideoTypes.some((t=>e.mime===t)))return r}}return null},n.reactivate=function(){var e;null!=(e=this._currentScanner)&&e.reactivate&&this._currentScanner.reactivate(),this.play()},n.checkRebuffer=function(e,t){this._rebufferMonitor&&(this._rebufferMonitor.playInitiated=e,this._rebufferMonitor.userPlayState=t,this._rebufferMonitor.runIntervalCheck())},n._initScanner=function(e,t){if(this._currentScanner.constructor===e&&this._currentScanner.video===t)return;const n=!this.isLive()&&this._currentScanner._preserveCurrentTime;this._switchingVideo?(this._previousScanner=this._currentScanner,this._previousScanner._switchingVideo=!0,this._snapshotDisplayed||(this._previousScanner.takeSnapshot(),this._snapshotDisplayed=!0),this._previousScanner.deactivate()):this._currentScanner.deactivate();const r=new e(this._element,this._options);Object.keys(Fi).forEach((e=>{const t=Fi[e];r.on(t,(e=>this._handleEvent(t,e,r)))})),this._currentScanner=r,t.currentScanner=r,this._currentScanner.video=t;const i=Object.keys(this._properties);for(let o=0;o<i.length;o++){const e=i[o];"paused"!==e?("currentTime"!==e||n)&&(this._currentScanner[e]=this._properties[e]):!1===this._properties.paused&&this._currentScanner.play()}this._currentScanner.addChapters(t.chapters,t.duration),this.fire(Ni.SCANNER_CHANGE,this._getScannerName(this._currentScanner)),this._currentScanner.on(["canplay","playing"],(()=>{this._previousScanner&&(this._previousScanner._switchingVideo=!1,this._previousScanner.removeSnapshot(),this._previousScanner=null,this._snapshotDisplayed=!1)}))},n._updateScanner=function(){if(null===this._video)return;const e=this._findScanner({textTrackSupport:this._video.textTracks.length>0});e?this._initScanner(e,this._video):this._fireVideoError("FilesNotPlayable","None of the files could be played in this browser.")},n._resetScanner=function(){this._currentScanner.deactivate(),this._currentScanner=new es(this._element)},n._handleEvent=function(e,t,n){if(n===this._currentScanner){switch(e){case Di.ERROR:return void(t instanceof No&&this.fire(Di.ERROR,t));case Ni.SCANNER_ERROR:this._fireVideoError("ScannerError",`The current scanner can no longer be used because ${t.reason}`),this._blacklistedScanners.push(this._getScannerName(this._currentScanner)),this._updateScanner([]);break;case Ni.FILE_ERROR:this._fireVideoError("FileError",`The current file can no longer be used because ${t.reason}`),this._currentScanner._switchToNextFile();break;case Ni.DOWNLOAD_ERROR:this._fireVideoError("DownloadError",t),this._currentScanner._switchToNextFile();break;case Ni.EME_UNSUPPORTED:this._fireVideoError(Vo,{text:null,code:"emeunsupported"});break;case Ni.DRM_FAILURE:case Ni.DRM_AUTH_FAILURE:this._fireVideoError(Vo,{text:t.text,code:t.code});break;case Ni.DRM_OUTPUT_RESTRICTED:this._fireVideoError(Vo,{text:null,code:"outputrestricted"});break;case Ni.DRM_AUTH_SUCCESS:this.fire(Ni.DRM_AUTH_SUCCESS);break;case Di.TIME_UPDATE:this._properties.currentTime=this._currentScanner.currentTime;break;case Ni.MEDIA_URL_EXPIRED:this._fireVideoError("MediaUrlExpired",t);break;case Ni.MEDIA_URL_BAD_REQUEST:this._fireVideoError(Ho,t);break;case xi.SPATIAL_UNSUPPORTED:this.getEffectByName("ThreeSixtyEffect").deactivate();break;case Di.ENDED:const e=!this._options.dvrEnabled||this.atLiveEdge;this._properties.paused=e;break;case Di.WAITING:this.fire(Di.WAITING)}this._activeEffects.forEach((t=>{"function"==typeof t[`on${e}`]&&t[`on${e}`]()})),this.fire(e,t)}},n._fireVideoError=function(e,t){this.fire(Di.ERROR,new No(e,t))},n._getScannerName=function(e){return e instanceof es?e.constructor.displayName:e.prototype.constructor.displayName},n._setUpRebufferMonitor=function(){this._rebufferMonitor&&this._rebufferMonitor.destroy(),this._rebufferMonitor=new Cc(this,this._options),this._rebufferMonitor.on(Ni.BUFFER_STARTED,(()=>{this.fire(Ni.BUFFER_STARTED)})),this._rebufferMonitor.on(Ni.BUFFER_ENDED,(()=>{this.fire(Ni.BUFFER_ENDED)}))},n._getEffectName=function(e){return e instanceof vc?e.constructor.displayName:e.prototype.constructor.displayName},n.setCaptionsShouldDisplay=function(e){"HLSLiveScanner"===this._getScannerName(this._currentScanner)&&this._currentScanner.setCaptionsShouldDisplay(e)},n.setCaptionsShouldLoad=function(e){"HLSLiveScanner"===this._getScannerName(this._currentScanner)&&this._currentScanner.setCaptionsShouldLoad(e)},l(t,[{key:"element",get:function(){return this._element}},{key:"videoElement",get:function(){return this._currentScanner.videoElement}},{key:"manifest",get:function(){return this._currentScanner.manifest||{video:[]}}},{key:"supportsVideoElementAudioTracks",get:function(){return this._currentScanner.constructor.supportsVideoElementAudioTracks}},{key:"activeEffects",get:function(){return this._activeEffects}},{key:"latency",get:function(){return this._currentScanner.latency}},{key:"downloadSpeed",get:function(){return this._currentScanner.downloadSpeed||0}},{key:"pictureInPictureActive",get:function(){return this._currentScanner.pictureInPictureActive}},{key:"pictureInPictureEnabled",get:function(){return this._currentScanner.pictureInPictureEnabled}},{key:"isLowerProfileAvailable",get:function(){return this._currentScanner.isLowerProfileAvailable}},{key:"buffered",get:function(){return this._currentScanner.buffered}},{key:"bufferTarget",get:function(){return this._currentScanner.bufferTarget},set:function(e){this._properties.bufferTarget=e,this._currentScanner.bufferTarget=e}},{key:"presentationDelay",get:function(){return this._currentScanner.presentationDelay},set:function(e){this._properties.presentationDelay=e,this._currentScanner.presentationDelay=e}},{key:"lowLatencyMode",get:function(){return this._currentScanner.lowLatencyMode},set:function(e){this._properties.lowLatencyMode=e,this._currentScanner.lowLatencyMode=e}},{key:"manifestLoadDurations",get:function(){return this._currentScanner.manifestLoadDurations?this._currentScanner.manifestLoadDurations:[]}},{key:"successfulSegments",get:function(){return this._currentScanner.successfulSegments?this._currentScanner.successfulSegments:[]}},{key:"failedSegments",get:function(){return this._currentScanner.failedSegments?this._currentScanner.failedSegments:[]}},{key:"cuePoints",get:function(){return this._currentScanner.cuePoints}},{key:"currentChapterID",get:function(){if(this._currentScanner&&this._currentScanner.chaptersTrack&&this._currentScanner.chaptersTrack.activeCues.length){const{activeCues:e}=this._currentScanner.chaptersTrack;return e[e.length-1].id}return null}},{key:"chapters",get:function(){return this._currentScanner.chaptersTrack?this._currentScanner.chaptersTrack.cues:[]}},{key:"chaptersTrack",get:function(){return this._currentScanner.chaptersTrack}},{key:"currentFile",get:function(){return this._currentScanner.currentFile},set:function(e){if("string"==typeof e&&(e=this._files.filter((t=>t.id===e))[0]),!e)throw new No("FileNotValid","The file is not valid.");this._currentScanner.currentFile=e}},{key:"currentScannerName",get:function(){return this._getScannerName(this._currentScanner)}},{key:"currentScanner",get:function(){return this._currentScanner}},{key:"currentTime",get:function(){return this._currentScanner.currentTime},set:function(e){this._properties.currentTime=e,this._currentScanner.currentTime=e}},{key:"liveEdgeTime",get:function(){const e=this._currentScanner.liveEdgeTime;return null==e?this._previousLiveEdgeTime:(this._previousLiveEdgeTime=e,e)}},{key:"atLiveEdge",get:function(){var e;return null!==(e=this._currentScanner.atLiveEdge)&&void 0!==e?e:this.isLive()}},{key:"liveTailTime",get:function(){const e=this._currentScanner.liveTailTime;return null==e?this._previousLiveTailTime:(this._previousLiveTailTime=e,e)}},{key:"atLiveTail",get:function(){var e;return null!==(e=this._currentScanner.atLiveTail)&&void 0!==e&&e}},{key:"duration",get:function(){return this._currentScanner.duration}},{key:"ended",get:function(){return this._currentScanner.ended}},{key:"externalDisplayAvailable",get:function(){return this._currentScanner.externalDisplayAvailable}},{key:"externalDisplayActive",get:function(){return this._currentScanner.externalDisplayActive}},{key:"loop",get:function(){return this._currentScanner.loop},set:function(e){this._properties.loop=e,this._currentScanner.loop=e}},{key:"muted",get:function(){return this._currentScanner.muted},set:function(e){this._properties.muted=!!e,this._currentScanner.muted=!!e}},{key:"playsinline",get:function(){return this._currentScanner.playsinline},set:function(e){this._properties.playsinline=!!e,this._currentScanner.playsinline=!!e}},{key:"paused",get:function(){return this._currentScanner.paused}},{key:"played",get:function(){return this._currentScanner.played}},{key:"seekable",get:function(){return this._currentScanner.seekable}},{key:"seeking",get:function(){return this._currentScanner.seeking}},{key:"defaultPlaybackRate",get:function(){return this._currentScanner.defaultPlaybackRate},set:function(e){this._properties.defaultPlaybackRate=e,this._currentScanner.defaultPlaybackRate=e}},{key:"playbackRate",get:function(){return this._currentScanner.playbackRate},set:function(e){this._properties.playbackRate=e,this._currentScanner.playbackRate=e}},{key:"preload",get:function(){return this._currentScanner.preload},set:function(e){this._properties.preload=e,this._currentScanner.preload=e}},{key:"autoPictureInPicture",get:function(){return this._currentScanner.autoPictureInPicture},set:function(e){this._properties.autoPictureInPicture=!!e,this._currentScanner.autoPictureInPicture=!!e}},{key:"disablePictureInPicture",get:function(){return this._currentScanner.disablePictureInPicture},set:function(e){this._properties.disablePictureInPicture=!!e,this._currentScanner.disablePictureInPicture=!!e}},{key:"video",get:function(){return this._video},set:function(e){this._video&&this._video.deactivate(),this._blacklistedScanners=[],this._setUpRebufferMonitor(),null===e?(this._video=null,this._resetScanner()):(this._video=new Lc(e),this._updateScanner())}},{key:"videoWidth",get:function(){return this._currentScanner.videoWidth}},{key:"videoHeight",get:function(){return this._currentScanner.videoHeight}},{key:"volume",get:function(){return this._currentScanner.volume},set:function(e){if(e<0||e>1)throw new No("IndexSizeError",`Failed to set the 'volume' property: The volume provided (${e}) is outside of the range [0, 1].`);this._properties.volume=e,this._currentScanner.volume=e}},{key:"videoElementAudioTracks",get:function(){return this._currentScanner.audioTracks}},{key:"brainDebug",get:function(){return this._currentScanner.brainDebug}}])}(bn),xc=function(e){function t(t,n={}){var r;return(r=e.call(this,t,n)||this)._activated=!1,r._video=r._telecine._currentScanner._video,r}p(t,e);var n=t.prototype;return n.activate=function(){this._activated=!0,this._canvas=document.createElement("canvas"),this._canvas.className="vp-canvas-effect",this._canvas.style.cssText="\n            position: absolute;\n            top:0;\n            left:0;\n            bottom:0;\n            right:0;\n        ",this._ctx=this._canvas.getContext("2d",{alpha:!1}),this._element.appendChild(this._canvas),this._startRendering()},n.deactivate=function(){this._canvas&&this._element.removeChild(this._canvas),this._stopRendering(),this._activated=!1},n._startRendering=function(){this._requestFrame()},n._requestFrame=function(){this._animationFrame=window.requestAnimationFrame(this._renderFrame.bind(this))},n._renderFrame=function(){const e=this._video,t=this._canvas;t.width=e.clientWidth,t.height=e.clientHeight;const n=Math.floor(this._videoContentWidth()),r=Math.floor(this._videoContentHeight()),i=Math.floor((e.clientWidth-n)/2),o=Math.floor((e.clientHeight-r)/2);this._ctx.fillStyle="#000",this._ctx.fillRect(0,0,t.width,t.height),this._ctx.drawImage(e,i,o,n,r),this._requestFrame()},n._videoRatio=function(){return this._video.videoHeight/this._video.videoWidth},n._videoContentWidth=function(){return Math.min(this._video.clientHeight/this._videoRatio(),this._video.clientWidth)},n._videoContentHeight=function(){return Math.min(this._video.clientWidth*this._videoRatio(),this._video.clientHeight)},n._stopRendering=function(){this._animationFrame&&(window.cancelAnimationFrame(this._animationFrame),this._animationFrame=null)},l(t,null,[{key:"displayName",get:function(){return"CanvasEffect"}},{key:"supported",get:function(){return!0}},{key:"supportedScanners",get:function(){return[es,qu]}}])}(vc),Uc=function(){return l((function(){}),null,[{key:"Equirect",get:function(){return"equirectangular"}}])}(),Fc=function(){return l((function(){}),null,[{key:"Mono",get:function(){return"mono"}},{key:"TopBottom",get:function(){return"top-bottom"}},{key:"LeftRight",get:function(){return"left-right"}}])}(),jc=function(){function e(e,t,n){this.isStereo=t!==Fc.Mono,this._leftEye=null,this._rightEye=null,e===Uc.Equirect?this.createEquirectProjection(n,t):this.createEquirectProjection(n,Fc.Mono)}var t=e.prototype;return t.createEquirectProjection=function(e,t){t!==Fc.Mono?(this._leftEye=this._createEquirectangularSphereMesh(e),this._rightEye=this._createEquirectangularSphereMesh(e),this._leftEye.layers.set(1),this._rightEye.layers.set(2),t===Fc.TopBottom&&(this._chopGeometryUvs(this._leftEye.geometry,.5,.5),this._chopGeometryUvs(this._rightEye.geometry,.5,0)),t===Fc.LeftRight&&(this._chopGeometryUvs(this._leftEye.geometry,.5,0,0),this._chopGeometryUvs(this._rightEye.geometry,.5,.5,0))):this._leftEye=this._createEquirectangularSphereMesh(e)},t._createEquirectangularSphereMesh=function(t,n,r,i){const o=new THREE.SphereBufferGeometry(n||e.SPHERE_RADIUS,r||e.TESSELATION_WIDTH,i||e.TESSELATION_HEIGHT);o.scale(-1,1,1);const s=new THREE.MeshBasicMaterial({map:t});return new THREE.Mesh(o,s)},t._chopGeometryUvs=function(e,t,n,r=1){for(let i=0;i<e.attributes.uv.array.length;i+=2)e.attributes.uv.array[i+r]*=t,e.attributes.uv.array[i+r]+=n},l(e,[{key:"left",get:function(){return this._leftEye}},{key:"right",get:function(){return this._rightEye}}],[{key:"TESSELATION_WIDTH",get:function(){return 120}},{key:"TESSELATION_HEIGHT",get:function(){return 80}},{key:"SPHERE_RADIUS",get:function(){return 500}}])}(),Vc=function(){function e(e){this._renderer=e}var t=e.prototype;return t.hasVRHeadset=function(){return ze.webvr?navigator.getVRDisplays().then((e=>e.length>0?(this._renderer.vr.setDevice(e[0]),e[0]):null)):null},t.enter=function(){return this._renderer.vr.getDevice()&&this._renderer.vr.getDevice().requestPresent([{source:this._renderer.domElement}])},t.exit=function(){return this._renderer.vr.getDevice()&&this._renderer.vr.getDevice().exitPresent()},l(e,[{key:"supported",get:function(){return ze.webvr}},{key:"device",get:function(){return this._renderer&&this._renderer.vr.getDevice()?this._renderer.vr.getDevice():null}},{key:"isPresenting",get:function(){return!(!this._renderer||!this._renderer.vr.getDevice())&&this._renderer.vr.getDevice().isPresenting}}])}(),Bc=function(e){function t(t,n={}){var r;return(r=e.call(this,t,n)||this)._activated=!1,r._camera=null,r._scene=null,r._renderer=null,r.isUserInteracting=!1,r._onMouseDownMouseX=0,r._onMouseDownMouseY=0,r._coordinates={lat:0,long:0},r._previousCoordinates={lat:0,long:0},r._onMouseDownCoordinates={lat:0,long:0},r._previousCameraProps=r.cameraProps,r._phi=0,r._theta=0,r._rotation=0,r._video=r._telecine._currentScanner._video,r._videoRefreshLoop=null,r._gyroVector={x:0,y:0},r._offset={lat:0,long:0},r._writeSpeeds={videoFps:r._options.fps,motionRenderSpeed:60},r._maxTimeBetweenWrites=1e3/r._writeSpeeds.videoFps,r._motionTimeouts=[],r._movingAutomatically=!1,r._deviceMotionHasOccurred=!1,r._updateFromGyroscopePending=!1,r._keysPressed={up:!1,down:!1,left:!1,right:!1},r}p(t,e),t.frustumSurfaceArea=function(e,t,n){const r=2*jc.SPHERE_RADIUS*2*Math.sin(Math.PI/180*(e/2));return r*(r*t/n)/(4*Math.PI*Math.pow(jc.SPHERE_RADIUS,2))};var n=t.prototype;return n.activate=function(){return new Promise((e=>{if(window.THREE)return void e();const t=document.createElement("script");t.src=this._options.threeUrl,document.body.appendChild(t),t.onload=()=>{e()}})).then((()=>this._initialize()))},n._initialize=function(){this._activated=!0,this._camera=new THREE.PerspectiveCamera(this._options.fieldOfView,this._video.clientWidth/this._video.clientHeight,1,2*jc.SPHERE_RADIUS),this._camera.target=new THREE.Vector3(0,0,0),this._camera.layers.enable(1),this._initializeAutoMovement(this._options.directorTimeline),this._scene=new THREE.Scene,this._texture=new THREE.VideoTexture(this._video),this._texture.generateMipmaps=!1,this._texture.minFilter=THREE.NearestFilter,this._texture.maxFilter=THREE.NearestFilter,this._texture.format=THREE.RGBFormat,this._projector=new jc(this._options.projection,this._options.stereoMode,this._texture),this._projector.isStereo&&this._scene.add(this._projector.right),this._scene.add(this._projector.left),this._renderer=new THREE.WebGLRenderer,this._renderer.vr.enabled=!0,this._renderer.setPixelRatio(window.devicePixelRatio),this._output=document.createElement("div"),this._renderer.domElement.style.margin="0 auto",this._output.appendChild(this._renderer.domElement),this._element.appendChild(this._output),this._hideOutput(),this._telecine._currentScanner._video.setAttribute("crossorigin","anonymous"),this._startRendering(),this._telecine._currentScanner.paused||this._showOutput(),this._webvr=new Vc(this._renderer),this._webvr.supported&&this._webvr.hasVRHeadset().then((e=>{setTimeout((()=>{this._telecine.fire(xi.WEBVR_HARDWARE_AVAILABLE,this._webvr.device)}),100)})).catch((e=>{}))},n.toggleVR=function(){if(this._webvr.isPresenting)this._webvr.exit().then((()=>{this.adjustRenderSize()})).catch((e=>{}));else{if(this._telecine._currentScanner.paused)return;this._webvr.enter().then((()=>{this.adjustRenderSize()})).catch((e=>{}))}},n.onplay=function(){this._activated&&(this._showOutput(),this.adjustRenderSize())},n.deactivate=function(){this._output&&this._element.removeChild(this._output),this._stopRendering(),this._activated=!1},n.snapToCenter=function(){this._motionTimeouts.forEach((e=>clearTimeout(e)));const e=((this._coordinates.long>=180?360:0)-this._coordinates.long)/11,t=(0-this._coordinates.lat)/11;this._rotation=0;for(let n=0;n<50;n++)this._motionTimeouts.push(setTimeout((()=>{0===n&&(this._movingAutomatically=!0,this._options.isMobile||(this._maxTimeBetweenWrites=1e3/this._writeSpeeds.motionRenderSpeed)),49===n&&(this._movingAutomatically=!1,this._options.isMobile||(this._maxTimeBetweenWrites=1e3/this._writeSpeeds.videoFps)),this._updateViewpoint(this._coordinates.lat+t/Math.pow(1.1,n),this._coordinates.long+e/Math.pow(1.1,n)),this._offset.lat=THREE.Math.radToDeg(this._gyroVector.x)+this._coordinates.lat+t/Math.pow(1.1,n),this._offset.long=THREE.Math.radToDeg(this._gyroVector.y)+this._coordinates.long+t/Math.pow(1.1,n)}),n*this._maxTimeBetweenWrites))},n.isStereo=function(){return!!this._projector&&this._projector.isStereo},n._initializeAutoMovement=function(e){e&&e[0]&&void 0!==e[0].p&&"undefined"!==e[0].y&&this._updateViewpoint(e[0].p,e[0].y)},n._updateViewpoint=function(e,t){this._previousCoordinates.long=this._coordinates.long,this._previousCoordinates.lat=this._coordinates.lat,e%=360,this._coordinates.lat=Math.max(-85,Math.min(85,e)),t=(t%=360)>=0?t:360+t,this._coordinates.long=t},n.makeContact=function(e){this.isUserInteracting=!0,this._motionTimeouts.forEach((e=>clearTimeout(e))),this._movingAutomatically=!1,this._contactPoint={x:e.x,y:e.y},this._onMouseDownCoordinates.long=this._coordinates.long,this._onMouseDownCoordinates.lat=this._coordinates.lat,this._motionStart={long:this._coordinates.long,lat:this._coordinates.lat},this._options.isMobile||(this._maxTimeBetweenWrites=1e3/this._writeSpeeds.motionRenderSpeed)},n.move=function(e){this._offset.lat=THREE.Math.radToDeg(this._gyroVector.x)+this._previousCoordinates.lat,this._offset.long=THREE.Math.radToDeg(this._gyroVector.y)+this._previousCoordinates.long;const t=this._motionStart.lat-.2*(this._contactPoint.y-e.y),n=.2*(this._contactPoint.x-e.x)+this._motionStart.long;this._updateViewpoint(t,n)},n.moveWheel=function(e){this._offset.lat=THREE.Math.radToDeg(this._gyroVector.x)+this._previousCoordinates.lat,this._offset.long=THREE.Math.radToDeg(this._gyroVector.y)+this._previousCoordinates.long;const t=this._coordinates.lat-.1*e.y,n=this._coordinates.long+.1*e.x;this._updateViewpoint(t,n)},n.moveDevice=function(e,t,n,r){this._updateFromGyroscopePending=!0;const i=new THREE.Quaternion;let o=window.orientation;null===o&&(o=this._video.clientWidth>this._video.clientHeight?90:0),e=e?THREE.Math.degToRad(e):0,t=t?THREE.Math.degToRad(t):0,n=n?THREE.Math.degToRad(n):0;const s=o?THREE.Math.degToRad(o):0,a=new THREE.Vector3(0,0,1),u=new THREE.Euler,c=new THREE.Quaternion,l=new THREE.Quaternion(-Math.sqrt(.5),0,0,Math.sqrt(.5));u.set(t,e,-n,"YXZ"),i.setFromEuler(u),i.multiply(l),i.multiply(c.setFromAxisAngle(a,-s)),this._gyroVector=(new THREE.Euler).setFromQuaternion(i,"YXZ"),this._rotation=this._gyroVector.z,this.isUserInteracting||this._movingAutomatically||this._updateViewpoint(THREE.Math.radToDeg(this._gyroVector.x)-this._offset.lat,-THREE.Math.radToDeg(this._gyroVector.y)+this._offset.long),this._deviceMotionHasOccurred||(this.snapToCenter(),this._telecine.fire(xi.MOTION_START),this._deviceMotionHasOccurred=!0)},n.releaseContact=function(e){if(this._offset.lat=THREE.Math.radToDeg(this._gyroVector.x)-this._coordinates.lat,this._offset.long=THREE.Math.radToDeg(this._gyroVector.y)+this._coordinates.long,this.isUserInteracting=!1,this._motionStart&&!e){const e=Math.hypot(this._coordinates.long-this._motionStart.long,this._coordinates.lat-this._motionStart.lat);this._moveDueToMomentum(e)}},n.abandonMotion=function(){this.isUserInteracting=!1,this._motionStart=null},n.keyPress=function(e){this._options.keyboardDisabled||(this._keyIsDown()||(this.isUserInteracting=!0,this._motionTimeouts&&this._motionTimeouts.forEach((e=>clearTimeout(e)))),this._keysPressed[e]||(this._keysPressed[e]=!0))},n.keyUp=function(e){this._keysPressed[e]=!1,this._keyIsDown()||(this.isUserInteracting=!1,this._moveDueToMomentum(1/0))},n._moveFromKeyPress=function(){Object.keys(this._keysPressed).forEach((e=>{if(this._keysPressed[e])switch(e){case"up":this._updateViewpoint(this._coordinates.lat+2,this._coordinates.long);break;case"down":this._updateViewpoint(this._coordinates.lat-2,this._coordinates.long);break;case"left":this._updateViewpoint(this._coordinates.lat,this._coordinates.long-2);break;case"right":this._updateViewpoint(this._coordinates.lat,this._coordinates.long+2)}}))},n._keyIsDown=function(){return Object.keys(this._keysPressed).map((e=>this._keysPressed[e])).some((e=>e))},n._moveDueToMomentum=function(e){if(e>=20){const t={long:this._coordinates.long-this._previousCoordinates.long,lat:this._coordinates.lat-this._previousCoordinates.lat};e===1/0&&(t.long/=2,t.lat/=2);for(let e=1;e<50;e++)this._motionTimeouts.push(setTimeout((()=>{1===e&&(this._movingAutomatically=!0),49===e&&(this._movingAutomatically=!1,this._maxTimeBetweenWrites=1e3/this._writeSpeeds.videoFps);const n=2/Math.pow(e,1.5);this._offset.lat=THREE.Math.radToDeg(this._gyroVector.x)+this._coordinates.lat+t.lat,this._offset.long=THREE.Math.radToDeg(this._gyroVector.y)+this._coordinates.long+t.long,this._updateViewpoint(this._coordinates.lat+t.lat*n,this._coordinates.long+t.long*n)}),e*this._maxTimeBetweenWrites))}},n.onseeked=function(){this._activated&&this._update()},n.onresize=function(){this.adjustRenderSize(),this.isUserInteracting=!1},n._update=function(){if(!this.isVRPresenting){this._phi=THREE.Math.degToRad(90+this._coordinates.lat),this._theta=THREE.Math.degToRad(this._coordinates.long),this._camera.position.set(Math.sin(this._phi)*Math.cos(this._theta),Math.cos(this._phi),Math.sin(this._phi)*Math.sin(this._theta)),this._camera.lookAt(this._camera.target),this._camera.rotation.z+=this._rotation;const e=this.cameraProps;this._telecine.fire(xi.CAMERA_UPDATE,e),this._previousCameraProps.yaw===e.yaw&&this._previousCameraProps.pitch===e.pitch&&this._previousCameraProps.roll===e.roll&&this._previousCameraProps.fov===e.fov||(this._previousCameraProps=e,this._telecine.fire(xi.CAMERA_CHANGE,e))}this._renderer.render(this._scene,this._camera)},n.adjustRenderSize=function(){if(this.isVRPresenting)this._camera.aspect=this._video.clientWidth/this._video.clientHeight,this._camera.updateProjectionMatrix(),this._renderer.setSize(this._video.clientWidth,this._video.clientHeight);else{this._video.clientWidth>this._video.clientHeight?this._camera.aspect=Math.max(1,Math.min(2,this._video.clientWidth/this._video.clientHeight)):this._camera.aspect=Math.max(1/3,Math.min(3,this._video.clientWidth/this._video.clientHeight)),this._camera.updateProjectionMatrix();const e=Do(this._video.clientWidth,this._video.clientHeight,this._camera.aspect,1);this._renderer.setSize(e.width,e.height),this._output.style.paddingTop=`${e.top}px`}},n._startRendering=function(){this._renderer.setAnimationLoop((()=>{this._keyIsDown()&&this._moveFromKeyPress(),this._update()}))},n._stopRendering=function(){this._renderer.setAnimationLoop(null)},n._showOutput=function(){this._styleOutput({backgroundColor:"#000",display:"block"})},n._hideOutput=function(){this._styleOutput({backgroundColor:"#000",display:"none"})},n._styleOutput=function({backgroundColor:e,display:t}={}){this._output.style.cssText=`position:absolute;left:0;top:0;margin-left:auto;margin-right:auto;padding:0;background:${e};width:100%;height:100%;text-align:center;display:${t}`},l(t,[{key:"isUserInteracting",get:function(){return this._isUserInteracting},set:function(e){e!==this._isUserInteracting&&(this._isUserInteracting=e,e?this._options.isMobile||this._telecine.fire(xi.MOTION_START):this._options.isMobile||this._telecine.fire(xi.MOTION_END))}},{key:"currentCoordinates",get:function(){return this._coordinates},set:function([e,t]){if(e>90||e<-90)throw new RangeError("Latitude should be a float between -90 and 90.");if(t<0||t>360)throw new RangeError("Longitude should be a float between 0 and 360.");this._updateViewpoint(e,t),this._update()}},{key:"cameraProps",get:function(){return{yaw:this._coordinates.long,pitch:this._coordinates.lat,roll:this.roll,fov:this.fieldOfView}},set:function(e){e=g(g({},this.cameraProps),e),this.fieldOfView=e.fov,this.roll=e.roll,this.currentCoordinates=[e.pitch,e.yaw]}},{key:"roll",get:function(){return 180*this._rotation/Math.PI},set:function(e){if(e<-180||e>180)throw new RangeError("Roll should be a float between -180 and 180.");this._rotation=THREE.Math.degToRad(e)}},{key:"isVRPresenting",get:function(){return this._webvr&&this._webvr.isPresenting}},{key:"fieldOfView",get:function(){return this._camera?this._camera.fov:this._options.fieldOfView},set:function(e){this._camera.fov=e,this._camera.updateProjectionMatrix(),this._renderer.render(this._scene,this._camera)}},{key:"hasVRHeadset",get:function(){return this._webvr&&!!this._webvr.device}}],[{key:"displayName",get:function(){return"ThreeSixtyEffect"}},{key:"supported",get:function(){try{const e=document.createElement("canvas");return!!window.WebGLRenderingContext&&(e.getContext("webgl")||e.getContext("experimental-webgl"))}catch(Rp){return this._telecine._currentScanner.fire(xi.SPATIAL_UNSUPPORTED),!1}}},{key:"supportedScanners",get:function(){return[es,qu]}}])}(vc),Hc=function(e){function t(t,n={}){var r;return(r=e.call(this,t,n)||this).connected=!1,r._context=null,r._source=null,r._mirror=null,r._rotator=null,r._decoder=null,r}p(t,e);var n=t.prototype;return n.activate=function(){return this._context=new AudioContext,new Promise(((e,t)=>{if("undefined"!=typeof ambisonics)return void e();const n=document.createElement("script");n.src=this._options.ambisonicsUrl,document.body.appendChild(n),n.onload=()=>e(),n.onerror=()=>t()})).then((()=>this.toggleAmbisonics())).catch((()=>{this._telecine._currentScanner.fire(xi.AMBISONIC_UNSUPPORTED)}))},n.deactivate=function(){this._disconnect(!0)},n.toggleAmbisonics=function(){var e,t;(null!==(e=null==(t=this._telecine.getCurrentStream("audio"))?void 0:t.ambisonic_order)&&void 0!==e?e:0)<1?this._disconnect():this._connect()},n._connect=function(){var e,t;if(!this._context)return;const n=null!==(e=null==(t=this._telecine.getCurrentStream("audio"))?void 0:t.ambisonic_order)&&void 0!==e?e:0;if(this.connected||n<1)return;const r=this._telecine._currentScanner._video;this._source=this._context.createMediaElementSource(r),this._mirror=new ambisonics.sceneMirror(this._context,n),this._rotator=new ambisonics.sceneRotator(this._context,n),this._decoder=new ambisonics.binDecoder(this._context,n),this._source.connect(this._mirror.in),this._mirror.out.connect(this._rotator.in),this._rotator.out.connect(this._decoder.in),this._decoder.out.connect(this._context.destination),this._mirror.mirror(1),this.connected=!0},n._disconnect=function(e=!1){this._source&&this._source.disconnect(),e&&this._context&&(this._context.close(),this._context=null),this._source=null,this._mirror=null,this._rotator=null,this._decoder=null,this.connected=!1},n.updateRotation=function(e,t,n){this._rotator&&(this._rotator.yaw!==e||this._rotator.pitch!==t||this._rotator.roll!==n)&&(this._rotator.yaw=e,this._rotator.pitch=t,this._rotator.roll=n,this._rotator.updateRotMtx())},l(t,null,[{key:"displayName",get:function(){return"AmbisonicEffect"}},{key:"supported",get:function(){return void 0!==window.AudioContext}},{key:"supportedScanners",get:function(){return[es,qu]}}])}(vc);const Xc={h264:"video/mp4",hls:"application/vnd.apple.mpegurl",hlsLive:"application/x-mpegURL",dash:"application/vnd.vimeo.dash+json",dashMpd:"video/vnd.mpeg.dash.mpd",vp6:"video/x-flv",vp8:"video/webm",webm:"video/webm",hds:"application/f4m"},Wc={"application/vnd.apple.mpegurl":"hls","application/vnd.vimeo.dash+json":"dash","video/vnd.mpeg.dash.mpd":"dash","video/mp4":"progressive","video/webm":"progressive","video/x-flv":"progressive","application/x-mpegURL":"hlslive"},qc="pending",Gc="active",Kc="started",Yc="ended",$c="started",zc="done",Qc="error";var Jc=/\s/,Zc=/^\s+/;var el=/^[-+]0x[0-9a-f]+$/i,tl=/^0b[01]+$/i,nl=/^0o[0-7]+$/i,rl=parseInt;function il(e){if("number"==typeof e)return e;if(pt(e))return NaN;if(vt(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=vt(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=function(e){return e?e.slice(0,function(e){for(var t=e.length;t--&&Jc.test(e.charAt(t)););return t}(e)+1).replace(Zc,""):e}(e);var n=tl.test(e);return n||nl.test(e)?rl(e.slice(2),n?2:8):el.test(e)?NaN:+e}var ol=1/0;var sl=it.isFinite,al=Math.min,ul=function(){var e=Math.round;return function(t,n){if(t=il(t),(n=null==n?0:al(function(e){var t=function(e){return e?(e=il(e))===ol||e===-1/0?17976931348623157e292*(e<0?-1:1):e==e?e:0:0===e?e:0}(e),n=t%1;return t==t?n?t-n:t:0}(n),292))&&sl(t)){var r=(Yt(t)+"e").split("e");return+((r=(Yt(e(r[0]+"e"+(+r[1]+n)))+"e").split("e"))[0]+"e"+(+r[1]-n))}return e(t)}}();function cl(e){return!isNaN(e)}function ll(e){return ul(e,3)}function dl(e){return"webkitDisplayingFullscreen"in e&&e.webkitDisplayingFullscreen}let hl=0;function fl(e="b"){return`${e}${++hl}`}fl(),fl();const pl=fl(),_l=fl(),ml=fl(),vl=fl(),gl=fl(),yl=fl(),El=Symbol("CONFIG_CHANGED"),Tl=Symbol("TELECINE_READY"),Sl=Symbol("TELECINE_VIDEO_INIT"),bl=Symbol("PLAY_INITIATED"),Al=Symbol("QUALITY_CHANGED"),wl=Symbol("CUE_CHANGED"),Il=Symbol("CAPTIONS_CHANGED"),Rl=Symbol("SPATIAL_PLAYBACK_TOGGLED"),kl=Symbol("PICTURE_IN_PICTURE_AVAILABLE_SAFARI"),Pl=Symbol("HLS_QUALITY_CHANGED"),Dl=Symbol("REQUEST_COMPLETE_LIVE_SUBTITLES"),Ol=Symbol("COMPLETE_LIVE_SUBTITLES_LOADED"),Ll=Symbol("COMPLETE_LIVE_SUBTITLES_ERROR");var Cl=Object.freeze({__proto__:null,CONFIG_CHANGED:El,TELECINE_READY:Tl,TELECINE_VIDEO_INIT:Sl,PLAY_INITIATED:bl,QUALITY_CHANGED:Al,CUE_CHANGED:wl,CAPTIONS_CHANGED:Il,SPATIAL_PLAYBACK_TOGGLED:Rl,PICTURE_IN_PICTURE_AVAILABLE_SAFARI:kl,HLS_QUALITY_CHANGED:Pl,REQUEST_COMPLETE_LIVE_SUBTITLES:Dl,COMPLETE_LIVE_SUBTITLES_LOADED:Ol,COMPLETE_LIVE_SUBTITLES_ERROR:Ll});const Nl=Symbol("liveeventpending"),Ml=Symbol("liveeventactive"),xl=Symbol("liveeventstarting"),Ul=Symbol("liveeventstarted"),Fl=Symbol("liveeventended"),jl=Symbol("livearchivestarted"),Vl=Symbol("livearchivedone"),Bl=Symbol("livearchiveerror"),Hl=Symbol("livesettingsupdated"),Xl=Symbol("lowlatencyfallback"),Wl=Symbol("livestatssuccess"),ql=Symbol("livestatsfailure");var Gl=Object.freeze({__proto__:null,EVENT_PENDING:Nl,EVENT_ACTIVE:Ml,EVENT_STARTING:xl,EVENT_STARTED:Ul,EVENT_ENDED:Fl,ARCHIVE_STARTED:jl,ARCHIVE_DONE:Vl,ARCHIVE_ERROR:Bl,SETTINGS_UPDATED:Hl,LOW_LATENCY_FALLBACK:Xl,LIVE_STATS_SUCCESS:Wl,LIVE_STATS_FAILURE:ql});g(g(g(g(g(g(g(g({},Di),Ni),Mi),Gl),xi),Li),Ui),Cl);const Kl=g(g({},Mi),Gl);function Yl(e){var t;return(null==e||null==(t=e.archive)?void 0:t.status)===zc}function $l(e){return(null==e?void 0:e.status)===qc}function zl(e){return(null==e?void 0:e.status)===Kc}function Ql(e){return(null==e?void 0:e.status)===Yc}function Jl(e){return Zl(e,"/playlist/refresh")}function Zl(e,t){var n;const r=null==(n=e.request.files.hls)?void 0:n.default_cdn,{signature:i,timestamp:o,expires:s}=e.request;return`https://${e.player_url}/live/${e.video.id}${t}?signature=${i}&time=${o}&expires=${s}&cdn=${r}`}var ed=Object.prototype.hasOwnProperty;function td(e){if(null==e)return!0;if(ir(e)&&(tt(e)||"string"==typeof e||"function"==typeof e.splice||Fn(e)||$n(e)||Nn(e)))return!e.length;var t=jr(e);if("[object Map]"==t||"[object Set]"==t)return!e.size;if(Zn(e))return!rr(e).length;for(var n in e)if(ed.call(e,n))return!1;return!0}function nd(e){const t=this;let n={};const r={get attributes(){return Object.assign({},t)},get previousAttributes(){return n},clear(){i();var e=t.attributes;for(var n in e)delete t[n]},set(e){for(var n in i(),e=oi(e))t[n]=e[n]},clone:()=>new nd(t.attributes),toJSON:()=>oi(t.attributes)};function i(){td(t.attributes)||(n=oi(t.attributes))}return r.set(e),k(t,r)}function rd(e,t){const n=new nd(ki(e,t));let r=!1;return P(n,{reset:function(e){return n.clear(),function(e){r=!0,n.set(e),ki(n,t)}(e),n},isNewVideo:function(){const e=n.previousAttributes;return!r||e.video.id!==n.video.id||e.video.version.current!==n.video.version.current||!!e.video.live_event&&!Yl(e.video.live_event)&&(!n.video.live_event||Yl(n.video.live_event))}})}function id(e,t,n){return void 0===n&&(n=t,t=void 0),void 0!==n&&(n=(n=il(n))==n?n:0),void 0!==t&&(t=(t=il(t))==t?t:0),function(e,t,n){return e==e&&(void 0!==n&&(e=e<=n?e:n),void 0!==t&&(e=e>=t?e:t)),e}(il(e),t,n)}function od(e=[],t=null,n=null){if(!t&&!n)return e;if(!e.length)return e;if(t===n&&-1!==e.indexOf(t))return[t];const r=parseFloat(t),i=parseFloat(n);if(r&&i&&i<r)return e;const o=e.filter((e=>{const t=parseFloat(e);return!(r&&t<r||i&&t>i)}));return o.length?o:e}function sd(e=[],t=null){const n=od(e,t,t);return 1===n.length?n[0]:null}function ad(e){return e.quality||e.metadata.quality}function ud(e,t,n=!1){return n?cd(e,t):function(e,t){e.embed.settings.audio_tracks||(t=null);const n=e.request.files,r=pd(n),i=Ed(e),o=e.request.cookie.quality||i||function(e){const t=pd(e.request.files);let n=t.some(gd);ze.mobileAndroid&&(n=!1);let r="720p";if(n){const e=t.map(ad);-1!==e.indexOf("1080p")&&-1===e.indexOf("720p")&&(r="1080p")}return e.request.cookie.hd||e.video.default_to_hd?r:"360p"}(e);let s=function({files:e=[],preference:t="360p",priorityOffset:n=0}){(e=Array.from(e)).sort(Td());const r=e.map(ad);if(t){-1===r.indexOf(t)&&(r.push(t),r.sort(((e,t)=>yd(t)-yd(e))));const e=r.indexOf(t),n=r.splice(0,e);n.reverse(),r.push.apply(r,T(n))}return e.map((e=>({id:e.id,src:e.url,mime:e.mime,priority:r.indexOf(e.quality)+1+n,metadata:{profile:e.profile,cdn:e.cdn,origin:e.origin,quality:e.quality,fps:e.fps}})))}({files:r,preference:o,priorityOffset:3});return n.hls&&(s=s.concat(hd(e,!1,t)),e.request.drm&&ze.browser.webKit)||n.dash&&(s=s.concat(fd(e,!1,t))),s}(e,t)}function cd(e,t){const n=e.request.files;let r=[];const i=e.request.drm&&ze.browser.webKit;return(n.hls&&(ze.iPhone||ze.iPad)||i)&&(r=r.concat(hd(e,!0,t))),n.dash&&!i&&(r=r.concat(fd(e,!0,t))),r}function ld(e,t=!1,n=!1){let r=e.url;if("avc_url"in e&&(r=e.avc_url),t)return r;const i=ze.dolbyVision,o=ze.hdr&&ze.hevc,s=ze.hevc;return n||(i&&"hevc_dvh1_url"in e?r=e.hevc_dvh1_url:o&&"hevc_hdr_url"in e?r=e.hevc_hdr_url:s&&"hevc_sdr_url"in e&&(r=e.hevc_sdr_url)),ze.av1&&"av1_url"in e&&(r=e.av1_url),r}function dd(e){return e.fallback_url}function hd(e,t=!1,n=null){var r;const i=e.request.files,o=i.hls.default_cdn,s=e.request.drm,a=i.hls.cdns[o],u=(null==a||null==(r=a.alternatives)?void 0:r[n])||a,c=t?dd(u):ld(u,s);return{id:`hls-${o}-${e.video.id}`,src:c,mime:Xc.hls,priority:3,metadata:{cdn:o,origin:i.hls.cdns[o].origin,quality:"sd"}}}function fd(e,t=!1,n=null){const r=e.request.files;return td(r.dash)?[]:Object.keys(r.dash.cdns).map((i=>{var o;const s=r.dash.cdns[i],a=(null==s||null==(o=s.alternatives)?void 0:o[n])||s,u=(ze.browser.chrome||ze.browser.firefox)&&e.request.drm,c=t?dd(a):ld(a,!1,u);return{id:`dash-${i}-${e.video.id}`,src:c,mime:e.request.drm?Xc.dashMpd:Xc.dash,priority:i===r.dash.default_cdn?1:2,metadata:{cdn:i,origin:r.dash.cdns[i].origin,quality:"sd"}}}))}function pd(e){if(td(e.progressive))return[];let t=e.progressive;return"progressive_avc"in e&&(t=e.progressive_avc),t.filter(md(t))}function _d(e){if("number"==typeof e)return e;const t=e.split("-");return 5===t.length?t[0]:parseInt(t[0],10)}function md(e){const t=e.filter(vd).map(ad);return e=>-1===t.indexOf(ad(e))||vd(e)}function vd(e){let t=e.fps;return"metadata"in e&&(t=e.metadata.fps),t>30}function gd(e){return yd(e)>=720}function yd(e){return"string"!=typeof e&&(e=ad(e)),parseInt(e,10)}function Ed(e){const t=pd(e.request.files).map((e=>e.quality));return e.embed.on_site?null:sd(t,e.embed.quality)}function Td(e="desc"){return(t,n)=>{const r=yd(t),i=Sd(t),o=yd(n),s=Sd(n);return"asc"===e?r-o||i-s:o-r||s-i}}function Sd(e){return"object"!=typeof e?0:"fps"in e?e.fps:"metadata"in e&&"fps"in e.metadata?e.metadata.fps:0}function bd(e){const t=e.video.live_event,n=e.request.files;if(!td(n.hls)){var r;const i=n.hls.default_cdn,o=n.hls.cdns[i].json_url||function(e){var t;const n=e.dvr,r=e.low_latency;var i,o;return n?null==(i=e.playback_urls)?void 0:i["akamai-fmp4"].hls_noredirect:r?null==(o=e.playback_urls)?void 0:o["akamai-low-latency"].hls_noredirect:null==(t=e.playback)?void 0:t.hls_noredirect}(t),s=null!=(r=e.request.flags)&&r.live_dash?2:1;return{id:`hls-${i}-${e.video.id}`,src:o,mime:Xc.hlsLive,priority:s,metadata:{cdn:i,origin:n.hls.cdns[i].origin,quality:"sd"}}}return null}function Ad(e,t){let n=[];if(t.video){const i=t.video.currentFile.mime;if(i===Xc.hlsLive)return t.manifest.video.map((e=>g(g({},e),{},{quality:`${e.height}p`})));if([Xc.dash,Xc.dashMpd].includes(i)){var r;const i=!!t.video.drmHandler,o=i&&"sd-fallback"===t.video.drmHandler.state;n=function(e,t=!1){if(!e)return[];let n=e.streams;"streams_avc"in e&&(n=e.streams_avc);const r=ze.dolbyVision,i=ze.hevc&&ze.hdr,o=ze.hevc;return r&&"streams_hevc_dvh1"in e?n=e.streams_hevc_dvh1:i&&"streams_hevc_hdr"in e?n=e.streams_hevc_hdr:o&&"streams_hevc_sdr"in e?n=e.streams_hevc_sdr:ze.av1&&"streams_av1"in e&&(n=e.streams_av1),t&&"streams_fallback"in e&&(n=e.streams_fallback),n}(e.request.files.dash,o),!i&&null!=t&&null!=(r=t.currentScanner)&&r.manifestLoaded&&(n=function(e,t){const n=t.map((e=>e.id));return e.filter((e=>{const t=_d(e.id);return n.includes(e.id)||n.includes(t)}))}(n,t.currentScanner.videoStreams))}else n=t.video.files.filter((e=>"progressive"===Wc[e.mime]))}return n.filter(md(n)).sort(Td())}function wd(e){let t=ad(e);const n={"1440p":"2K","2160p":"4K","2700p":"5K","3240p":"6K","3780p":"7K","4320p":"8K"};for(const r in n)t=t.replace(r,n[r]);return t}function Id(e){return ze.spatialPlayback&&e.video.spatial?35:75}function Rd(e){return e.request.text_tracks.map((e=>({id:e.id,src:e.url,kind:e.kind,label:e.label,language:e.lang,provenance:e.provenance})))}let kd={captureException(e){},captureMessage(e){},captureBreadcrumb(){}},Pd=kd;var Dd={set:function(e){Pd=Object.assign({},kd,e)},captureException:function(e,t){return Pd.captureException(e,t)},captureMessage:function(e,t){return Pd.captureMessage(e,t)},captureBreadcrumb:function(e,t,n="backbone",r="info"){return Pd.captureBreadcrumb(e,t,n,r)}};function Od(e,t,n){let r=!1,i=!1,o=!1,s=!0,a="auto";function u(e){if(!s&&n.buffered&&n.buffered.length>0){e=e||n.currentTime;const i=function(e,t){var n=e.length-1;if(e.length>1)for(var r=0,i=e.length;r<i;r++)if(e.start(r)<=t&&e.end(r)>=t){n=r;break}return n}(n.buffered,e),s=n.buffered.end(i),a=s/n.duration,u=n.duration;if(t.fire(Di.PROGRESS,{loaded:s,duration:u,loadProgress:a}),o&&r&&s===n.duration)return void(r&&n.paused&&n.play().catch(Dd.captureException))}}function c(t=[]){const r=Ad(e,n).reverse().map((e=>e.quality)),i=t.filter((e=>-1!==r.indexOf(e))).sort(((e,t)=>r.indexOf(e)-r.indexOf(t)));return i.map((e=>r.indexOf(e)))}function l(e=[],t=null){if(e.includes("auto"))n.video.currentFile.restrictedStreamIndexes=[];else{const t=c(e);t.length&&(Dd.captureBreadcrumb(`Switched to ${e[0]}`,{},"video"),n.video.currentFile.restrictedStreamIndexes=t)}if(t){const e=c([t]),r=e.length?e[0]:null;n._currentScanner.preloadStreamIndex=r}else n._currentScanner.preloadStreamIndex=null}function d(){if(e.embed.on_site)return;const t=Ad(e,n).map((e=>e.quality)),r=od(t,e.embed.quality||e.embed.min_quality,e.embed.quality||e.embed.max_quality),i=sd(t,e.embed.initial_quality);l(r.length&&r.length!==t.length?r:["auto"],i)}return t.on(Sl,(function(){var t;n.playsinline=e.embed.playsinline,n.muted=e.embed.muted,n.lowLatencyMode=null==(t=e.video.live_event)?void 0:t.low_latency})),t.on(_l,(function(){s=!0,n.paused||n.pause(),i=!1,r=!1,n.currentTime=0})),t.on(ml,(function(){n.paused||n.pause(),n.video=null})),n.on(Di.PLAY,(function(){s=!1,t.fire(Di.PLAY,n.currentTime)})),n.on(Di.PAUSE,(function(){r=!1,t.fire(Di.PAUSE,n.currentTime,n.ended)})),n.on(Di.PLAYING,(function(e){u()})),n.on(Di.TIME_UPDATE,(function(){if(s)return;const{currentTime:e,liveEdgeTime:r,atLiveEdge:i,liveTailTime:o,atLiveTail:a,duration:u,playbackRate:c}=n,l=e/u;t.fire(Di.TIME_UPDATE,{currentTime:e,liveEdgeTime:r,atLiveEdge:i,liveTailTime:o,atLiveTail:a,duration:u,playbackRate:c,timeProgress:l})})),n.on(Di.ENDED,(function(e){n.loop?n.play().catch(Dd.captureException):(r=!1,t.fire(Di.ENDED,e))})),n.on(Di.LOADED_METADATA,(function(t){const r=n.duration;if(isFinite(r)&&r>0){if(r<e.video.duration-1||r>e.video.duration+1)return;e.video.duration=r}e.video.video_width=n.videoWidth,e.video.video_height=n.videoHeight})),n.on(Di.DURATION_CHANGE,(function(t){const r=n.duration;isFinite(r)&&(e.video.duration>0&&(r<e.video.duration-1||r>e.video.duration+1)||(e.video.duration=r))})),n.on(Di.PROGRESS,u),n.on(Ni.BUFFER_STARTED,(()=>{o=!0})),n.on(Ni.BUFFER_ENDED,(()=>{o=!1})),t.on(pl,(function(t){n.isLive()&&0===n.liveEdgeTime||(t=id(t,ll(n.isLive()?n.liveTailTime:0),ll(n.isLive()?n.liveEdgeTime:n.duration||e.video.duration)),n.currentTime=t)})),n.on(Di.SEEKING,(function(){const e=n.currentTime,r=n.duration,i=e/r;t.fire(Di.SEEKING,{currentTime:e,duration:r,timeProgress:i})})),n.on(Di.SEEKED,(function(){u();const e=n.currentTime,r=n.duration,i=e/r;t.fire(Di.SEEKED,{currentTime:e,duration:r,timeProgress:i})})),n.on(Ni.CURRENT_FILE_CHANGE,(function(t){Dd.captureBreadcrumb("Current file changed",{id:t.id,mime:t.mime,src:t.src,metadata:t.metadata},"video"),[Xc.dash,Xc.dashMpd].includes(t.mime)&&d(),[Xc.hlsLive].includes(t.mime)?n.once(Ni.STREAMS_LOADED,(()=>{d()})):Ed(e)})),n.on(Di.RESIZE,(function(){n.video.currentFile.mime===Xc.hls&&n.videoHeight&&t.fire(Pl,{height:n.videoHeight})})),{play:function(){return r=!0,i||(t.fire(bl),i=!0),n.play()},pause:function(){r=!1,n.pause()},get quality(){return a},set quality(r){!function(r){const i=n.video.currentFile.mime;if([Xc.dash,Xc.dashMpd,Xc.hlsLive].includes(i))l([r]);else{const t=Ad(e,n).filter((e=>e.metadata.quality===r));t.length>0&&(s=!0,n.video.currentFile=t[0])}a=r,t.fire(Al,r)}(r)}}}function Ld(e,t,n){let r=null;ze.spatialPlayback&&(t.on(Sl,(function(){r&&(n.deactivateEffect(Bc),r=null,t.fire(Rl,r));const i=e.video.spatial;i&&(e.request.drm||n.supportsEffect(Bc)&&(r=n.activateEffect(Bc,{threeUrl:e.request.urls.three_js,fps:e.video.fps,fieldOfView:i.fov,directorTimeline:i.director_timeline,projection:i.projection,stereoMode:i.stereo_mode,initialView:i.initial_view,isMobile:ze.android,dimensions:e.embed.on_site?{width:1080,height:540}:{width:640,height:360},keyboardDisabled:!e.embed.keyboard}),t.fire(Rl,r)))})),n.on(xi.SPATIAL_UNSUPPORTED,(function(){r&&(n.deactivateEffect(Bc),r=null,t.fire(Rl,r))})))}function Cd(e,t,n){let r=null;t.on(Sl,(function(){r&&(n.deactivateEffect(xc),r=null),e.video.canvas&&(e.request.drm||n.supportsEffect(xc)&&(r=n.activateEffect(xc)))}))}var Nd=Ii((function(e,t,n){Ai(e,t,n)}));function Md(e,t,n){return n?t?t(e):e:(e&&e.then||(e=Promise.resolve(e)),t?e.then(t):e)}const xd=5e3;function Ud(e,t){try{var n=e()}catch(Rp){return t(Rp)}return n&&n.then?n.then(void 0,t):n}let Fd=function(e){function n(t,n,r,i){var o;return(o=e.call(this)||this)._liveEventHasID=V(),o._liveEvent=oi(t),o._sessionUrl=t.session_url||t.sessionUrl,o._subtitleUrl=t.subtitleUrl,o._sessionRefreshUrl=n,o._subtitleRefreshUrl=i,o._appPollUrl=r,o._forcedPoll=!1,o._disabled=!1,o._dvrEnabled=t.dvr,o._setupPolling(),o}p(n,e);var r=n.prototype;return r.requestCompleteLiveSubtitles=function(){try{const e=this;return Md(Ud((function(){return Md(Se({url:e._subtitleUrl,retry:3,retryStatus:e=>[410].includes(e)||t.retryStatus(e),hooks:{beforeRetry:[e._beforeSubtitleRetry.bind(e)]}}).json(),(function(e){if(null==e||!e.url)throw new Error("No webvtt url was available to fetch");return Md(Se(e.url).text(),nc)}))}),(function(e){throw e})))}catch(Rp){return Promise.reject(Rp)}},r._beforeSubtitleRetry=function(e){try{return Md(this._refreshSubtitleUrl(),(function(t){e.url=t}))}catch(Rp){return Promise.reject(Rp)}},r._refreshSubtitleUrl=function(){try{const e=this;return Md(Se(e._subtitleRefreshUrl).json(),(function(t){return e._subtitleUrl=t.url,t.url}))}catch(Rp){return Promise.reject(Rp)}},r.disable=function(){this._disabled=!0},r.forcePolling=function(){this.isForcePolling||(this._forcedPoll=!0,this._setupPolling())},r.unforcePolling=function(){this._forcedPoll=!1},r._setupPolling=function(){!1!==this._liveEvent.polling&&(this._liveEvent.id&&this._liveEventHasID.resolve(),this._shouldPollApp()?this._pollApp():this._shouldPoll()&&this._pollLiveApi())},r._shouldPoll=function(){var e;return!(Ql(this._liveEvent)&&(null==(e=this._liveEvent.archive)?void 0:e.status)!==$c||!this.isForcePolling&&zl(this._liveEvent))},r._shouldPollApp=function(){return!this._sessionUrl||!(!$l(this._liveEvent)||null!==this._liveEvent.id)},r._refreshSessionUrl=function(){try{const e=this;return Md(Se(e._sessionRefreshUrl).json(),(function(t){return e._sessionUrl=t.url,t.url}))}catch(Rp){return Promise.reject(Rp)}},r._pollLiveApi=function(){try{const e=this;if(e._disabled)return Md();let n,r={};return ze.browser.ie&&(r={Pragma:"no-cache","Cache-Control":"no-cache"}),Md(function(e,t){return e&&e.then?e.then(t):t()}(Ud((function(){return Md(Se({url:e._sessionUrl,retry:3,retryStatus:e=>[410].includes(e)||t.retryStatus(e),hooks:{beforeRetry:[e._beforeRetry.bind(e)]},headers:r}).json(),(function(e){n=e}))}),(function(){throw new Error(`Hit max retries polling ${e._sessionUrl}`)})),(function(t){if(e._dvrEnabled&&(n.dvr=e._dvrEnabled),n.status!==e._liveEvent.status){if(Ql(n)&&"provision_expire"===n.terminate_reason)return e._sessionUrl=null,e._liveEvent.id=null,void setTimeout(e._setupPolling.bind(e),xd);const t={[Gc]:Kl.EVENT_ACTIVE,[qc]:Kl.EVENT_PENDING,[Kc]:Kl.EVENT_STARTED,[Yc]:Kl.EVENT_ENDED}[n.status];try{e.fire(t,n)}catch(r){throw new Error(`Error firing live event status change ${r}`)}}if(n.archive&&(!e._liveEvent.archive||n.archive.status!==e._liveEvent.archive.status)){const t={[$c]:Kl.ARCHIVE_STARTED,[zc]:Kl.ARCHIVE_DONE,[Qc]:Kl.ARCHIVE_ERROR}[n.archive.status];e.fire(t,n)}e._liveEvent=Nd(e._liveEvent,n),e._shouldPoll()&&setTimeout(e._pollLiveApi.bind(e),xd)})))}catch(Rp){return Promise.reject(Rp)}},r._beforeRetry=function(e){try{return Md(this._refreshSessionUrl(),(function(t){e.url=t}))}catch(Rp){return Promise.reject(Rp)}},r._pollApp=function(){try{const e=this;return e._disabled?Md():Md(Se(e._appPollUrl).json(),(function(t){let n=!1;return function(r,i){var o=function(){if(null!==t.ingest.session_id)return e._liveEventHasID.resolve(),e._liveEvent.id=t.ingest.session_id,Md(e._refreshSessionUrl(),(function(){e._pollLiveApi(),n=!0}))}();return o&&o.then?o.then(i):i(o)}(0,(function(t){if(n)return t;setTimeout(e._pollApp.bind(e),xd)}))}))}catch(Rp){return Promise.reject(Rp)}},l(n,[{key:"isForcePolling",get:function(){return this._forcedPoll}},{key:"liveEventIDReady",get:function(){return this._liveEventHasID}}])}(bn);function jd(){}function Vd(e){return function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];try{return Promise.resolve(e.apply(this,t))}catch(Rp){return Promise.reject(Rp)}}}function Bd(e,t,n){const r=Vd((function(){return function(e){return e&&e.then?e.then(jd):Promise.resolve()}({hive:()=>{},kollective:()=>{}}[e.video.ecdn.ecdn_provider]())}));let i,o,s,a=!1,u=0,c=0;function l(){o&&(o.disable(),o=null)}function d(){n.endLive()}return t.on(El,(function(){i&&!e.isNewVideo()||(i=!0,l(),e.video.live_event&&!Yl(e.video.live_event)&&(function(n){o=new Fd(n,function(e){return Zl(e,"/session/refresh")}(e),function(e){return`https://${e.vimeo_url}/live_event/status?clip_id=${e.video.id}`}(e),function(e){return Zl(e,"/subtitle/refresh")}(e)),o.on(Kl.EVENT_ENDED,d),Object.keys(Kl).forEach((e=>{const n=Kl[e];o.on(n,(e=>{t.fire(n,e)}))})),t.on(Dl,Vd((function(){return function(e){if(e&&e.then)return e.then(jd)}(function(e,n){try{var r=function(){var e;return function(e,t){return void 0?t?t(e):e:(e&&e.then||(e=Promise.resolve(e)),t?e.then(t):e)}(null==(e=o)?void 0:e.requestCompleteLiveSubtitles(),(function(e){t.fire(Ol,e)}))}()}catch(Rp){return n()}return r&&r.then?r.then(void 0,n):r}(0,(function(e){t.fire(Ll)})))})))}(e.video.live_event),function(){u=0,c=0;let e=!1;n.once(Di.PLAYING,(()=>e=!0));let r=X();clearInterval(s),s=setInterval((()=>{n.paused||(u+=G(r)/1e3),e&&a&&(c+=G(r)/1e3),function(e){if(n.lowLatencyMode&&e>12&&n.latency>10&&a){const e="Rebuffer ratio > 12% and latency > 10s, fallback to normal HLS w/ target latency of 12s.";t.fire(Kl.LOW_LATENCY_FALLBACK,{msg:e}),n.lowLatencyMode=!1,n.presentationDelay=12,n.bufferTarget=12}}(c/u*100),r=X()}),500)}()),e.video.ecdn&&r())})),t.on(ml,(function(){l()})),n.on(Kl.STREAM_ONLINE,(function(){o.isForcePolling&&o.unforcePolling()})),n.on(Kl.STREAM_OFFLINE,(function(){o.isForcePolling||o.forcePolling()})),n.on(Ni.BUFFER_STARTED,(function(){a=!0})),n.on(Ni.BUFFER_ENDED,(function(){a=!1})),{get p2pReady(){}}}function Hd(e,t,n){if(n)return t?t(e()):e();try{var r=Promise.resolve(e());return t?r.then(t):r}catch(Rp){return Promise.reject(Rp)}}function Xd(e,t){var n=e();return n&&n.then?n.then(t):t(n)}function Wd(e,t){try{var n=e()}catch(Rp){return t(Rp)}return n&&n.then?n.then(void 0,t):n}function qd(e){return function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];try{return Promise.resolve(e.apply(this,t))}catch(Rp){return Promise.reject(Rp)}}}function Gd(e,t,n){var r;const i=qd((function(){return Wd((function(){return Hd(m,(function(t){return t(n,e)}))}),(function(e){throw Dd.captureException(e),new Error("Failed to create Hive Module",e)}))})),o=qd((function(){return Wd((function(){return Hd(_,(function(e){return e(n)}))}),(function(e){return Dd.captureException(e),null}))})),s=function(){return function(e){return e&&e.then||(e=Promise.resolve(e)),e}(Xd((function(){if(!u)return Hd(o,(function(e){u=e}))}),(function(){var t;return null==(t=u)?void 0:t.setUp(e)})))},a=qd((function(){return Wd((function(){return Xd((function(){if(!c)return Hd(i,(function(e){c=e}))}),(function(){var e;return null==(e=c)?void 0:e.setUp(d)}))}),(function(e){var t;return null==(t=c)||t.stop(),null}))}));let u,c,l=!1,d=!1,h=!1;const f=null==(r=e.video.ecdn)?void 0:r.ecdn_provider;let p;function _(){return import("./kollective.module.js").then((({default:e})=>e))}function m(){return import("./hive.module.js").then((({default:e})=>e))}function v(){try{u&&(u.destroy(),u=null),c&&(c.destroy(),c=null)}catch(e){}}return t.on(El,(function(){var t;e.isNewVideo()&&(l=!1),!0!==e.preload||!1!==h||"kollective"!==f?l||((null==(t=e.video.live_event)?void 0:t.status)!==qc?(l=!0,v(),f&&(p={hive:a,kollective:s}[f]())):d=!0):h=!0})),t.on(ml,v),{get p2pReady(){return p}}}function Kd(e,t,n){let r=null;function i(){n.deactivateEffect(Hc),r=null}t.on(bl,(function(){var t;r&&i(),(null==(t=e.video.channel_layout)?void 0:t.startsWith("ambisonic"))&&n.supportsEffect(Hc)&&(r=n.activateEffect(Hc,{ambisonicsUrl:e.request.urls.ambisonics_js}))})),n.on(xi.CAMERA_UPDATE,(function({yaw:e,pitch:t,roll:n}){r&&r.updateRotation(e,t,n)})),n.on(xi.AMBISONIC_UNSUPPORTED,(function(){r&&i()})),n.on(Ni.STREAM_CHANGE,(function(){r&&r.toggleAmbisonics()}))}function Yd(e,t=[]){if(!e||"null"===e||0===t.length)return{track:null};const[n,r]=e.split("."),[i]=n.split(/[-_]/),o=n!==i,s=t.filter((e=>o&&e.language===n||e.language===i)).sort(((e,t)=>{const o=2*(e.language===i&&e.kind===r)+2*(e.language===n)+1*(e.kind===r);return 2*(t.language===i&&t.kind===r)+2*(t.language===n)+1*(t.kind===r)-o}));return s.length>0?{track:s[0],exactMatch:s[0].language===n&&s[0].kind===r}:{track:null}}function $d(e){const t=e.split(/\n/g);let n=[],r=[];return t.forEach((e=>{let t=e.match(/<[a-zA-Z]+ ?.*?>/g)||[],i=e.match(/<\/[a-zA-Z]+ ?.*?>/g)||[];const o=r.map((({startTag:e})=>e));r=[],t=o.concat(t),t.forEach((e=>{let[t]=e.replace(/<|>/g,"").split(" ");const n=i.indexOf(`</${t}>`);-1!==n?i.splice(n,1):r.push({startTag:e,closeTag:`</${t}>`})}));const s=r.map((({closeTag:e})=>e)).reverse().join(""),a=`${o.join("")}${e}${s}`;n.push(a)})),n.join("<br>")}function zd(e){return e?e.split(/\n/g).join("↵"):e}function Qd(e,t){let n;function r(){return t.pictureInPictureActive||dl(t.videoElement)?"showing":"hidden"}function i(){if(0!==t.video.textTracks.length){if(t.video.textTracks.forEach((e=>{e.on("cuechange",o),e.on("modechange",s)})),t.video.textTracks.language){const[n]=t.video.textTracks.language.split(/[-_]/),[r]=t.video.textTracks.language.split(/[-_]/);if(n!==r){const n=`${t.video.textTracks.language}.subtitles`,{track:r}=Yd(n,t.video.textTracks);if(r)return void e.fire(vl,n)}}e.fire(gl)}else e.fire(gl)}function o(t){const n=t.target,r=n.activeCues,i=[];let o;for(var s=0,a=r.length;s<a;s++)""!==r[s].text.replace(/^\s+|\s+$/gm,"")&&(o=document.createElement("span"),o.appendChild(r[s].getCueAsHTML()),i.push({html:$d(o.innerHTML),text:zd(r[s].text)}));e.fire(wl,n,i)}function s(n){const r=n.target;dl(t.videoElement)&&"showing"===r.mode&&e.fire(Il,r)}e.on(Sl,i),e.on(vl,(function(i){if(n&&n.id===i)return;let o=t.video.textTracks.getTrackById(i),s=!0;o||({track:o,exactMatch:s}=Yd(i,t.video.textTracks)),o!==n&&setTimeout((()=>{t.video&&t.video.textTracks.forEach((e=>{e.mode=e===o?r():"disabled"})),e.fire(Il,o,!s),n=o}),0)})),e.on(gl,(function(){setTimeout((()=>{t.video&&t.video.textTracks.forEach((e=>{e.mode="disabled"})),e.fire(wl),n&&(n=null,e.fire(Il,null))}),0)})),e.on(Ni.TEXT_TRACKS_AVAILABLE,i),e.on([Di.ENTER_PICTURE_IN_PICTURE,Di.LEAVE_PICTURE_IN_PICTURE],(function(){!function(e){n&&n.mode!==e&&(n.mode=e)}(r())}))}const Jd=["main","translation"];function Zd(e,t){return Array.from(e).map((e=>g(g({},e),{},{enabled:e.id===t})))}function eh(e){return Array.from(e).find((e=>e.enabled))}function th(e,t){let n="translation";return"1"===e.id?n="main":e.label.includes("(Audio description)")?n="descriptions":e.label.includes("(Commentary)")&&(n="commentary"),e.language===t.language&&n===t.kind}function nh(e,t,n){let r,i,o,s,a,u;function c(){var t,n;const i=e.video.live_event,o=null==i?void 0:i.dvr;if($l(i)||function(e){return(null==e?void 0:e.status)===Gc}(i)||Ql(i)&&!Yl(i))return void(r.video=null);if(zl(i)&&r.video&&!e.isNewVideo())return;const s=e.request.audio_tracks||[],u=null==(t=eh(s))?void 0:t.id,c="sd-fallback"===(null==(n=r.video)||null==(n=n.drmHandler)?void 0:n.state),h=zl(i)?function(e){const t=[],n=bd(e);n&&t.push(n);const r=function(e){var t,n;const r=e.video.live_event,i=e.request.files;if(td(i.dash))return null;const o=i.dash.default_cdn,s=i.dash.cdns[o].url||(null==(t=r.playback)?void 0:t.dash_noredirect),a=null!=(n=e.request.flags)&&n.live_dash?2:1;return{id:`dash-${o}-${e.video.id}`,src:s,mime:Xc.dashMpd,priority:a,metadata:{cdn:o,origin:i.dash.cdns[o].origin,quality:"sd"}}}(e);return r&&t.push(r),t}(e):ud(e,u,c),f=Rd(e);var p;if(r.video&&!e.isNewVideo()&&!a&&(!o||Yl(i)))return null==(p=r.video.drmHandler)||p.updateLAUrls(e.request.drm),void l(h,f);d({files:h,textTracks:f,audioTracks:s,switchingVideo:o,startTime:o&&r.currentTime})}function l(e,t){e.forEach((e=>{const t=r.video.files.getFileById(e.id);t&&t.src!==e.src&&(t.src=e.src)})),t.forEach((e=>{const t=r.video.textTracks.getTrackById(e.id);t&&t.src!==e.src&&(t.src=e.src)}))}function d({files:i,textTracks:a,audioTracks:c=[],switchingVideo:l=!1,startTime:d}){var h,f,p,_,m,v;const g=e.video.live_event,y=n.getBoundingClientRect(),E=zl(g)?bd(e):function(e){const t=e.request.files;if(!td(t.hls)){const e=t.hls.default_cdn,n=t.hls.cdns[e],r=n.captions||n.url;return r?{src:r,mime:Xc.hls,metadata:{cdn:e,origin:n.origin,quality:"sd"}}:null}return null}(e);var T;u||(u=(null==(T=r.played)?void 0:T.length)>0);const S=!r.paused||(null==(h=r._rebufferMonitor)?void 0:h._isBuffering);r._switchingVideo=l,r.video={id:e.video.id,title:e.video.title,subtitle:`from ${e.video.owner.name}`,files:i,textTracks:a,audioTracks:c,chapters:Jt(e,"embed.chapters",[]),duration:e.video.duration,externalDisplayFiles:{AirPlay:E},metadata:{playlistRefreshUrl:Jl(e),useHls:e.request.drm&&ze.browser.webKit,drm:e.request.drm,drmLaUrlParams:e.request.drm&&{atid:e.request.atid,leadUUID:null==(f=e.user.lead)?void 0:f.id,playbackRoute:null!=(p=e.request.flags)&&p.ott?"player_embed_ott":"player_embed",playerLocation:e.embed.on_site?"onsite":"embed",dnt:null!==(_=null==(m=e.request.flags)?void 0:m.dnt)&&void 0!==_?_:e.embed.dnt,embedContext:e.embed.context,referrer:e.request.referrer},p2pReady:e.video.ecdn&&(null!==(v=o.p2pReady)&&void 0!==v?v:s.p2pReady),percentShown:Bc.frustumSurfaceArea(e.video.spatial.fov,y.width,y.height)}},l?r.checkRebuffer(u,S):t.fire(Sl),"number"==typeof d&&(r.currentTime=d)}return function(){var t,i,o,s;const a=[qu,hc,mc,es],u=e.video.ecdn&&!(null!=(t=e.request.flags)&&t.ecdn_delta_updates);r=new Mc(n,a,{externalDisplays:[Io],mediaSourceScanner:{droppedFrameSwitchPercent:Id(e)},tests:e.request.ab_tests,fileCodecs:e.request.file_codecs,presentationDelay:e.video.presentation_delay,lowLatencyMode:null==(i=e.video.live_event)?void 0:i.low_latency,dvrEnabled:null==(o=e.video.live_event)?void 0:o.dvr,disableDeltaUpdates:u,getLiveEventStartTimeEpoch:()=>function(e){var t;return null!=e&&e.started_on?new Date(e.started_on).getTime()/1e3:null==e||null==(t=e.ingest)?void 0:t.start_time}(e.video.live_event),sessionMetadata:{clipId:e.video.id,sessionId:e.request.session},disableMMS:!(null==(s=e.request.flags)||!s.disable_mms)||!ze.iOS})}(),Object.values(Di).filter((e=>![Di.TIME_UPDATE,Di.PROGRESS,Di.SUSPEND,Di.ERROR].includes(e))).forEach((e=>{r.on(e,((t="")=>{Dd.captureBreadcrumb(e,t,"video event")}))})),r.on(Ni.STREAMS_LOADED,(function(t){t.video.forEach((t=>{const n=function(e,t){return t.find((t=>_d(t.id)===String(e)||_d(t.id)===_d(e)))}(t.id,Ad(e,r));n?(t.profile=n.profile,t.quality=n.quality,t.fps=n.fps):(t.profile=null,t.quality=`${t.height}p`,t.fps=t.framerate)}))})),r.on(Ni.STREAM_CHANGE,(function({index:e,streams:n,metadata:r}){const i=n[e];Dd.captureBreadcrumb("Stream changed",i,"video"),t.fire(Ni.STREAM_CHANGE,i,e,n,r)})),r.on(Ni.STREAM_TARGET_CHANGE,(function({index:e,streams:n}){const r=n[e];t.fire(Ni.STREAM_TARGET_CHANGE,r,e,n)})),r.on(Ni.DRM_KEY_SWITCH,(function(){var t;if(!e.request.drm.fallback_asset)return;const n=Rd(e),i=null==(t=eh(r.video.audioTracks))?void 0:t.id;l(cd(e,i),n)})),function(e,t){[Li.ACTIVATED,Li.AVAILABLE,Li.DEACTIVATED,Li.UNAVAILABLE,Mi.STREAM_OFFLINE,Mi.STREAM_ONLINE,Mi.BUFFER_GAP_JUMP,Mi.BUFFER_GAP_JUMP_PREVENT,Mi.STALL_JUMP,Mi.LATENCY_UPDATED,Ui.MEDIASESSION_PAUSE,Ui.MEDIASESSION_PLAY,Ui.MEDIASESSION_SEEK_BACKWARD,Ui.MEDIASESSION_SEEK_FORWARD,Ui.MEDIASESSION_SEEK_TO,Ni.AUDIO_TRACK_CHANGED,Ni.AV_DURATION_MISMATCH,Ni.BANDWIDTH,Ni.BUFFER_ENDED,Ni.BUFFER_OCCUPANCY,Ni.BUFFER_STARTED,Ni.CHAPTER_CUES_UPDATED,Ni.CUE_POINT,Ni.CURRENT_FILE_CHANGE,Ni.DOWNLOAD_END,Ni.DOWNLOAD_TIMEOUT,Ni.DRM_AUTH_SUCCESS,Ni.DRM_KEY_SWITCH,Ni.DROPPED_FRAMES,Ni.MANIFEST_LOADED,Ni.MANIFEST_TIMEOUT,Ni.QUOTA_EXCEEDED_ERROR,Ni.SCANNER_CHANGE,Ni.STREAM_CHANGE_START,Ni.STREAM_BUFFER_END,Ni.STREAM_BUFFER_START,Ni.AVAILABLE_STREAMS_CHANGED,Ni.MEDIA_CAPABILITY_STREAMS_UNSUPPORTED,Ni.TEXT_TRACKS_AVAILABLE,Ni.DROPPED_FRAME_PERCENT_EXCEEDED,Ni.LOAD_SEGMENT_FAILED,Ni.SEGMENT_CUES_LOADED,xi.CAMERA_UPDATE,xi.CAMERA_CHANGE,xi.MOTION_END,xi.MOTION_START,xi.SPATIAL_UNSUPPORTED,xi.WEBVR_ENTER,xi.WEBVR_EXIT,xi.WEBVR_HARDWARE_AVAILABLE,Di.DURATION_CHANGE,Di.ERROR,Di.LOAD_START,Di.LOADED_DATA,Di.LOADED_METADATA,Di.PLAYING,Di.RATE_CHANGE,Di.RESIZE,Di.STALLED,Di.VOLUME_CHANGE,Di.WAITING,Di.ENTER_PICTURE_IN_PICTURE,Di.LEAVE_PICTURE_IN_PICTURE,Di.WEBKIT_BEGIN_FULLSCREEN,Di.WEBKIT_END_FULLSCREEN].forEach((n=>{e(n,((...e)=>{t.apply(void 0,[n].concat(e))}))}))}(r.on,t.fire),t.fire(Tl),new Qd(t,r),new Ld(e,t,r),new Cd(e,t,r),new Kd(e,t,r),o=new Bd(e,t,r),i=new Od(e,t,r),s=new Gd(e,t,r),t.on(El,c),t.on(yl,(function(n){var i,o;if(null==(i=e.embed)||null==(i=i.settings)||!i.audio_tracks)return;if(r.supportsVideoElementAudioTracks)return void r.enableAudioTrack(null==n?void 0:n.id);const s=function(e,t={}){if(null==e||!e.length)return[];const n=t.language,r=t.kind;let i=null==t?void 0:t.id;if(i)return Zd(e,i);if(r&&n){const t=e.find((e=>e.language===n&&e.kind===r));if(i=null==t?void 0:t.id,i)return Zd(e,i)}if(n){const t=e.find((e=>e.language===n&&Jd.includes(e.kind)));if(i=null==t?void 0:t.id,i)return Zd(e,i)}const o=e.find((e=>"main"===e.kind));return i=null==o?void 0:o.id,Zd(e,i)}(e.request.audio_tracks,n),a=eh(s),u="sd-fallback"===(null==(o=r.video)||null==(o=o.drmHandler)?void 0:o.state);d({files:ud(e,null==a?void 0:a.id,u),textTracks:r.video.textTracks,audioTracks:s,switchingVideo:!0,startTime:r.currentTime}),t.fire(Ni.AUDIO_TRACK_CHANGED)})),t.on(Di.LOADED_DATA,(function(){var t,n;if(r.supportsVideoElementAudioTracks&&null!=e&&null!=(t=e.request)&&null!=(t=t.audio_tracks)&&t.length&&null!=(n=r.videoElementAudioTracks)&&n.length){const t=eh(e.request.audio_tracks||[]),n=function(e,t){for(let n=0;n<e.length;n++){const r=e[n];if(th(r,t))return r}return null}(r.videoElementAudioTracks,t);n&&r.enableAudioTrack(n.id)}})),ze.browser.safari&&window.addEventListener("pageshow",(e=>{e.persisted&&(a=!0,c())})),D({telecine:r},i)}function rh(e,t,n){this.constructorName="BackboneError",this.message=e,this.name=t,this.source=n}rh.prototype=new Error;var ih={embed:{},request:{cookie:{},files:{},flags:{},urls:{},text_tracks:[],file_codecs:{}},video:{owner:{},thumbnail_url:"",version:{}},user:{}};function oh(e,t){let n;const r=new bn;let i,o,s=null,a=new rd(t,ih);function u(e,t){return r.fire(El,e,t),e}const c={play:()=>i.play(),pause:()=>i.pause(),get currentTime(){return o.currentTime>.1?ll(o.currentTime):0},set currentTime(e){if(e=parseFloat(e),isNaN(e)||e<0)throw new rh("Seconds must be a positive number less than the duration of the video.","RangeError","setCurrentTime");r.fire(pl,e)},get liveEdgeTime(){return o.liveEdgeTime},get atLiveEdge(){return o.atLiveEdge},get liveTailTime(){return o.liveTailTime},get atLiveTail(){return o.atLiveTail},get duration(){return ll(a.video.duration)},get enabledTextTrack(){return s},loadVideo(e){const t=oi(a);return a.reset(e),a=u(a,t),this},reactivate(){var e;return null!=(e=o)&&e.reactivate&&o.reactivate(),this},unload(){return r.fire(_l),this},destroy(){return r.fire(ml),this},on(e,t){return r.on(e,t),this},once(e,t){return r.once(e,t),this},off(e,t){return r.off(e,t),this},get events(){return r},hasTextTrack(e){let t,n,r=this.textTracks;if(cl(e))n=r.getTrackById(e);else{let n=e.split(".")[0];t=r.some((e=>e.language.toLowerCase()===n.toLowerCase()))}return!(!n&&!t)},enableTextTrack(e,t=null){let n,i,a=this.textTracks;if(cl(e))s=a.getTrackById(e);else{if([n,i=t]=e.split("."),!this.hasTextTrack(e))throw new rh(`There are no tracks for “${n.toUpperCase()}”.`,"InvalidTrackLanguageError","enableTextTrack");s=Yd(i?`${n}.${i}`:n,a).track}if(!s||i&&s.kind!==i)throw new rh(`There are no ${i} tracks for “${n.toUpperCase()}”.`,"InvalidTrackError","enableTextTrack");o.setCaptionsShouldDisplay(!0),r.fire(vl,s.id)},disableTextTrack(){s=null,o.setCaptionsShouldDisplay(!1),r.fire(gl)},enableAudioTrack(e){r.fire(yl,e)},get qualities(){return function(e){var t;const n=e.representations.map((t=>{const n=ad(t);return{id:n,label:wd(t),active:e.quality===n}})),r=null==(t=e.video)?void 0:t.currentFile.mime;return[Xc.dash,Xc.dashMpd,Xc.hlsLive,Xc.hls].includes(r)&&n.unshift({id:"auto",label:"Auto",active:!e.quality||"auto"===e.quality}),n}(this)},get quality(){return i.quality},set quality(e){i.quality=e},get playbackRate(){return o?o.playbackRate:1},set playbackRate(e){o.playbackRate=e,o.defaultPlaybackRate=e},get textTracks(){return o.video?o.video.textTracks:[]},get representations(){return Ad(a,o)},get volume(){return o?o.volume:ll(a.request.cookie.volume)},set volume(e){if(e=parseFloat(e),isNaN(e)||e<0||e>1)throw new rh("Volume should be a number between 0 and 1.","RangeError","setVolume");o.volume=e},get videoId(){return a.video.id},get videoWidth(){return o.videoWidth||a.video.width},get videoHeight(){return o.videoHeight||a.video.height},get readyState(){return o.videoElement.readyState},get telecine(){return o},get audioTracks(){var e;return(null==(e=o)||null==(e=e.video)?void 0:e.audioTracks)||[]},get enabledAudioTrack(){var e;return null==(e=o)||null==(e=e.video)?void 0:e.enabledAudioTrack},requestCompleteLiveSubtitles(){r.fire(Dl)},get hasAudio(){var e,t;return!(null==(e=o)||null==(e=e.video)||null==(e=e.audioTracks)||!e.length)||!(null==(t=o.manifest)||null==(t=t.audio)||!t.length)}};return a=u(a),i=new nh(a,r,e),o=i.telecine,n=Object.create(o),D(n,c)}function sh(e){return"string"==typeof e||!tt(e)&&ft(e)&&"[object String]"==ht(e)}function ah(e){return Math.round(parseInt(e,16)/255*100)/100}function uh(...e){if(1===e.length&&e[0]instanceof uh){var t=e[0];return this.red=t.red,this.green=t.green,this.blue=t.blue,this.alpha=t.alpha,this.hue=t.hue,this.saturation=t.saturation,this.lightness=t.lightness,this}if(1===e.length){if("string"==typeof e[0]&&e[0].indexOf("rgb")>=0)return this.rgba=function(e){var t=/rgba?\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3})(,\s*([\d.]+))?\)/.exec(e);if(!t)throw new Error("Invalid rgb value");return{red:parseInt(t[1],10),green:parseInt(t[2],10),blue:parseInt(t[3],10),alpha:parseFloat(t[5])||1}}(e[0]),this;if(!function(e){return"string"==typeof(e=e.replace("#",""))&&[3,4,6,8].includes(e.length)&&!isNaN(parseInt(e,16))}(`${e[0]}`))throw new Error("Invalid hex value");const{hex:t,alpha:n}=function(e){let t=1;return 4===(e=e.replace("#","")).length&&(t=ah(e.slice(3)+e.slice(3)),e=e.slice(0,3)),8===e.length&&(t=ah(e.slice(6,8)),e=e.slice(0,6)),{hex:e,alpha:t}}(`${e[0]}`);return this.hex=t,this.alpha=n,this}if(3===e.length||4===e.length){for(var n=0;n<3;n++)if(isNaN(parseInt(e[n],10))||parseInt(e[n],10)<0||parseInt(e[n],10)>255)throw new Error("Invalid rgb value");if(e[3]&&parseFloat(e[3])<0||parseFloat(e[3])>1)throw new Error("Invalid alpha value");return this.rgba={red:e[0],green:e[1],blue:e[2],alpha:parseFloat(e[3])||1},this}throw new Error("Invalid color")}function ch(){let e=0,t=null,n=0,r=!1;function i(){return e/1e3}return{trackBufferStart:function(e,i){t=X(),n++,r=!0,e(i)},trackBufferEnd:function(n,i={}){if(!r)return;const o=G(t);e+=o,i.buffer_duration=o/1e3,r=!1,n(i)},trackVideoExit:function(n){r&&!n&&(e+=G(t))},resetLastBufferTime:function(){t=null},getBufferRatio:function(e){const t=i()/e*100;return isNaN(t)?0:Math.round(100*t)/100},getBufferCount:function(){return n},getTotalBufferDuration:i,isVideoBuffering:function(){return r}}}uh.prototype={get complement(){var e=this.clone();return e.rgb={red:255-this.red,green:255-this.green,blue:255-this.blue},e},get hex(){return uh.rgbToHex(this.red,this.green,this.blue)},get hexWithAlpha(){const e=("0"+Math.round(255*this.alpha).toString(16)).slice(-2);return uh.rgbToHex(this.red,this.green,this.blue)+e},set hex(e){return this.rgba=uh.hexToRgb(e),this},get hsl(){return"hsl("+this.hue+","+this.saturation+"%,"+Math.round(this.lightness)+"%)"},set hsl(e){this.hue=e.hue,this.saturation=e.saturation,this.lightness=e.lightness;var t=uh.hslToRgb(e.hue,e.saturation,e.lightness);return this.red=t.red,this.green=t.green,this.blue=t.blue,this.alpha=t.alpha,this},get luminance(){function e(e){return e<=.03928?e/12.92:Math.pow((e+.055)/1.055,2.4)}return.2126*e(this.red/255)+.7152*e(this.green/255)+.0722*e(this.blue/255)},get rgb(){return"rgb("+this.red+","+this.green+","+this.blue+")"},set rgb(e){return this.rgba=e,this},get rgba(){return"rgba("+this.red+","+this.green+","+this.blue+","+this.alpha+")"},set rgba(e){this.red=e.red,this.green=e.green,this.blue=e.blue,this.alpha=e.alpha||1;var t=uh.rgbToHsl(e.red,e.green,e.blue);return this.hue=t.hue,this.saturation=t.saturation,this.lightness=t.lightness,this},get yiq(){return(299*this.red+587*this.green+114*this.blue)/1e3},clone:function(){return new uh(this)},lighten:function(e,t,n){if(this.hsl={hue:this.hue,saturation:this.saturation,lightness:this.lightness+e},t&&n)for(var r=n.contrast(this).ratio;r<t&&(this.lighten(5),r=n.contrast(this).ratio,!(this.lightness>=100)););return this},darken:function(e,t,n){if(this.hsl={hue:this.hue,saturation:this.saturation,lightness:this.lightness-e},t&&n)for(var r=n.contrast(this).ratio;r<t&&(this.darken(5),r=n.contrast(this).ratio,!(this.lightness<=0)););return this},overlayOn:function(e){if(this.alpha>=1)return this;var t=this.clone();return t.rgba={red:t.red*this.alpha+e.red*e.alpha*(1-this.alpha),green:t.green*this.alpha+e.green*e.alpha*(1-this.alpha),blue:t.blue*this.alpha+e.blue*e.alpha*(1-this.alpha),alpha:t.alpha+e.alpha*(1-this.alpha)},t},contrast:function(e){var t=this.alpha;if(t>=1){e.alpha<1&&(e=e.overlayOn(this));var n=this.luminance+.05,r=e.luminance+.05,i=n/r;return r>n&&(i=1/i),{ratio:i=Math.round(10*i)/10,error:0,min:i,max:i}}var o=this.overlayOn(uh.white).contrast(e).ratio,s=this.overlayOn(uh.black).contrast(e).ratio,a=Math.max(o,s),u={red:Math.min(Math.max(0,(e.red-this.red*t)/(1-t)),255),green:Math.min(Math.max(0,(e.green-this.green*t)/(1-t)),255),blue:Math.min(Math.max(0,(e.blue-this.blue*t)/(1-t)),255)},c=this.clone();c.rgb=u;var l=this.overlayOn(c).contrast(e).ratio;return{ratio:Math.round((l+a)/2*10)/10,error:Math.round((a-l)/2*10)/10,min:l,max:a,closest:c,farthest:s===a?uh.white:uh.black}},wcagAACompliant:function(e){return this.contrast(e).ratio>=4.5},wcagAAACompliant:function(e){return this.contrast(e).ratio>=7},yiqContrastColor:function(){return this.yiq>=120?new uh(0,0,0):new uh(255,255,255)}},uh.hexToRgb=function(e){var t;return 3===(e=String(e)).length||4===e.length?(t=/^#?([A-Fa-f0-9])([A-Fa-f0-9])([A-Fa-f0-9])$/i.exec(e))&&(t[1]+=t[1],t[2]+=t[2],t[3]+=t[3]):t=/^#?([A-Fa-f0-9]{2})([A-Fa-f0-9]{2})([A-Fa-f0-9]{2})$/i.exec(e),t?{red:parseInt(t[1],16),green:parseInt(t[2],16),blue:parseInt(t[3],16),alpha:1}:null},uh.rgbToHex=function(e,t,n){return"#"+((1<<24)+(Math.round(e)<<16)+(Math.round(t)<<8)+Math.round(n)).toString(16).slice(1)},uh.rgbToHsl=function(e,t,n){e/=255,t/=255,n/=255;var r,i=Math.max(e,t,n),o=Math.min(e,t,n),s=(i+o)/2,a=s;if(i===o)return{hue:0,saturation:0,lightness:100*a};var u=i-o;return r=a>.5?u/(2-i-o):u/(i+o),i===e?s=(t-n)/u+(t<n?6:0):i===t?s=(n-e)/u+2:i===n&&(s=(e-t)/u+4),s/=6,{hue:Math.round(360*s),saturation:Math.round(100*r),lightness:Math.round(100*a)}},uh.hslToRgb=function(e,t,n){function r(e,t,n){return n<0&&(n+=1),n>1&&(n-=1),6*n<1?e+6*(t-e)*n:2*n<1?t:3*n<2?e+6*(2/3-n)*(t-e):e}if(e/=360,n/=100,0==(t/=100))return{red:Math.floor(255*n),green:Math.floor(255*n),blue:Math.floor(255*n)};var i=n<.5?n*(1+t):n+t-t*n,o=2*n-i;return{red:Math.floor(255*r(o,i,e+1/3)),green:Math.floor(255*r(o,i,e)),blue:Math.floor(255*r(o,i,e-1/3))}},uh.hslToHex=function(e,t,n){var r=uh.hslToRgb(e,t,n);return uh.rgbToHex(r.red,r.green,r.blue)},uh.white=new uh("fff"),uh.black=new uh("000");const lh={VIDEO_BUFFER_END:"video-buffer-end",VIDEO_BUFFER_START:"video-buffer-start",VIDEO_ENDED:"video-ended",VIDEO_EXIT:"video-exit",VIDEO_LOAD_FAILURE:"video-load-failure",VIDEO_MINUTE_WATCHED:"video-minute-watched",VIDEO_PAUSED:"video-paused",VIDEO_PLAYED:"video-played",VIDEO_PLAYBACK_ERROR:"video-playback-error",VIDEO_READY:"video-ready",VIDEO_START_ATTEMPT:"video-start-attempt",VIDEO_START_FAILURE:"video-start-failure",VIDEO_START_TIME:"video-start-time",VIDEO_SEEK:"video-seek",VIDEO_SEEKED:"video-seeked",CHUNK_DOWNLOADED:"chunk_downloaded"};function dh(e){function t(e,t,n=!0,r="POST"){return new Promise(((i,o)=>{"POST"===r&&navigator.sendBeacon?i({status:navigator.sendBeacon(e,t)}):Se({url:e,body:t,method:r,async:n,headers:{"Content-Type":"text/plain; charset=UTF-8"}}).then((e=>{i({response:e,status:e.status})})).catch(o)}))}return{log:function(n,r=!0,i=!0){i&&(n.event_time=n.event_time||X());const o=[n];return t(e,JSON.stringify(o),r)},logRequestPromiseWithUrl:t}}const hh="playing";function fh(e){let t=0,n=0,r=0,i=0,o=!1,s=-1,a=null,u=null,c=null,l={satisfied:0,tolerable:0,frustrated:0},d=null;function h(){const t=e.getBoundingClientRect(),n=e.videoWidth,r=e.videoHeight;if(0===n&&0===r)return;const i="satisfied";let o=i;if(t.width>n&&t.height>r&&(n/t.width<.4?o=i:n/t.width<1?o="tolerable":n/t.width>1&&(o="frustrated")),u){const e=G(u);l[c]+=e}c=o,u=X()}function f(){return o?0:1}function p(){return-1===s?null:s>8e3||-1===s?0:s>2e3?.5:1}function _(){return d?(i=r/G(d),t>=4||i>=.12?0:t<4&&0!==t?i<.12?.5:0:1):null}function m(){if(-1===s)return null;h();const e=Object.keys(l).reduce(((e,t)=>l[e]>l[t]?e:t));switch(e){case"satisfied":return 1;case"tolerable":return.5;case"frustrated":return 0}return null}return e.addEventListener(hh,(()=>{-1===s&&(a=X())})),e.addEventListener("progress",(()=>{-1===s&&(d=X(),s=G(a)),h()})),{startupTimeScore:p,rebufferScore:_,failureScore:f,videoQualityScore:m,overallScore:function(){return Math.min(f(),p(),_(),m())},trackBufferStart:function(){-1!==s&&(t++,n=X())},trackBufferEnd:function(){-1!==s&&(r+=G(n))},onError:function(e){e.final&&(o=!0)}}}function ph(e,t=3){if(e=parseFloat(e),isNaN(e))return 0;var n=Math.pow(10,t);return Math.round(e*n)/n}function _h(e,t){let n,r,i,o,s,a,u,c,l,d,h,f,p,_,m=0;function v(){n=0,r=0,i=0,o=0,s=0,a=null,u=0,c=!1,l=!1,d=null,h=!1,f=new fh(e),p=new ch,_={bufferTracker:p,videoBufferCheck:()=>{setInterval((()=>{let t=e.currentTime;l&&!h&&!e.paused&&!_.bufferTracker.isVideoBuffering()&&t<s+.125&&_.bufferTracker.trackBufferStart(y),l&&!e.paused&&_.bufferTracker.isVideoBuffering()&&t>s+.125&&(_.bufferTracker.trackBufferEnd(E),_.bufferTracker.resetLastBufferTime()),s=t}),250)},addEventData:e=>null,playbackSessionTimer:()=>{let t=X();setInterval((()=>{(!e.paused&&c||h||_.bufferTracker.isVideoBuffering())&&(u+=G(t)/1e3),t=X()}),500)},customMinuteTracker:{shouldCount:()=>!1,onCount:()=>{}}}}function g(e,n={}){0===m&&(n=Object.assign(n,_.addEventData(e)),t(e,n))}function y(e={}){f.trackBufferStart(),g(lh.VIDEO_BUFFER_START,e)}function E(e={}){f.trackBufferEnd(),g(lh.VIDEO_BUFFER_END,e)}return v(),g(lh.VIDEO_READY),function(){let t=Math.ceil(59*Math.random());setInterval((()=>{var s,a,u;function l(e,n){return 0===e?n===t:n>=60}!e.paused&&c&&(n++,null!=(s=_.customMinuteTracker)&&null!=s.shouldCount&&s.shouldCount()&&r++,l(i,n)&&(n=0,i++,g(lh.VIDEO_MINUTE_WATCHED)),l(o,r)&&null!=(a=_.customMinuteTracker)&&null!=a.shouldCount&&a.shouldCount()&&(r=0,o++,null==(u=_.customMinuteTracker)||null==u.onCount||u.onCount(o)))}),1e3)}(),window.addEventListener("pagehide",(t=>{_.bufferTracker.trackVideoExit(e.paused);const n={startup:f.startupTimeScore(),rebuffer:f.rebufferScore(),failure:f.failureScore(),quality:f.videoQualityScore(),overall:f.overallScore()};d&&g(lh.VIDEO_EXIT,{vxs:n})}),!1),e.addEventListener(hh,(()=>{c=!0,h||l&&g(lh.VIDEO_PLAYED)})),e.addEventListener("timeupdate",(()=>{if(l)return;let e={startup_duration:d?ph(G(d)/1e3,2):null};g(lh.VIDEO_START_TIME,e),l=!0})),e.addEventListener("pause",(()=>{c=!1,g(lh.VIDEO_PAUSED)})),e.addEventListener("seeking",(()=>{h||(a=X(),h=!0,c=!1,g(lh.VIDEO_SEEK))})),e.addEventListener("seeked",(()=>{h=!1,e.paused||(c=!0),g(lh.VIDEO_SEEKED,{seek_duration:G(a)/1e3}),a=null})),e.addEventListener("ended",(()=>{g(lh.VIDEO_ENDED)})),e.addEventListener("waiting",(()=>{c=!1})),e.addEventListener("canplay",(()=>{h||_.bufferTracker.isVideoBuffering()&&!c&&(_.bufferTracker.trackBufferEnd(E),_.bufferTracker.resetLastBufferTime())})),{globalProperties:function(){return{autoplay:e.autoplay,buffer_count:_.bufferTracker.getBufferCount(),total_buffer_duration:_.bufferTracker.getTotalBufferDuration(),buffer_ratio:_.bufferTracker.getBufferRatio(u),client_time:X(),is_buffering:_.bufferTracker.isVideoBuffering(),looping:e.loop,minutes_watched:i,network_state:e.networkState,playback_rate:e.playbackRate,player_width:e.getBoundingClientRect().width,player_height:e.getBoundingClientRect().height,session_playback_duration:ph(u,2),video_time:e.currentTime,video_height:e.videoHeight,video_width:e.videoWidth,volume:ph(e.volume,2)}},logStartRequest:function(){d=X(),g(lh.VIDEO_START_ATTEMPT)},customizeHooks:function(e){_=Object.assign(_,e)},initHooks:function(){_.videoBufferCheck(),_.playbackSessionTimer()},logBufferStart:y,logBufferEnd:E,setDisplayContext:function(e){m=e},handleExternalError:function(e,t){c=!1,f.onError(t),g(l?lh.VIDEO_PLAYBACK_ERROR:l?lh.VIDEO_START_FAILURE:lh.VIDEO_LOAD_FAILURE,e)},reset:v}}var mh=function(){return it.Date.now()},vh=Math.max,gh=Math.min;function yh(e,t,n){var r,i,o,s,a,u,c=0,l=!1,d=!1,h=!0;if("function"!=typeof e)throw new TypeError("Expected a function");function f(t){var n=r,o=i;return r=i=void 0,c=t,s=e.apply(o,n)}function p(e){var n=e-u;return void 0===u||n>=t||n<0||d&&e-c>=o}function _(){var e=mh();if(p(e))return m(e);a=setTimeout(_,function(e){var n=t-(e-u);return d?gh(n,o-(e-c)):n}(e))}function m(e){return a=void 0,h&&r?f(e):(r=i=void 0,s)}function v(){var e=mh(),n=p(e);if(r=arguments,i=this,u=e,n){if(void 0===a)return function(e){return c=e,a=setTimeout(_,t),l?f(e):s}(u);if(d)return clearTimeout(a),a=setTimeout(_,t),f(u)}return void 0===a&&(a=setTimeout(_,t)),s}return t=il(t)||0,vt(n)&&(l=!!n.leading,o=(d="maxWait"in n)?vh(il(n.maxWait)||0,t):o,h="trailing"in n?!!n.trailing:h),v.cancel=function(){void 0!==a&&clearTimeout(a),c=0,r=u=i=a=void 0},v.flush=function(){return void 0===a?s:m(mh())},v}function Eh(e,t,n){var r=!0,i=!0;if("function"!=typeof e)throw new TypeError("Expected a function");return vt(n)&&(r="leading"in n?!!n.leading:r,i="trailing"in n?!!n.trailing:i),yh(e,t,{leading:r,maxWait:t,trailing:i})}var Th,Sh=0,bh=0,Ah={},wh={};function Ih(e,t,n){return"_root"==t?n:e!==n?function(e){return Th||(Th=e.matches?e.matches:e.webkitMatchesSelector?e.webkitMatchesSelector:e.mozMatchesSelector?e.mozMatchesSelector:e.msMatchesSelector?e.msMatchesSelector:e.oMatchesSelector?e.oMatchesSelector:Dh.matchesSelector)}(e).call(e,t)?e:e.parentNode?(Sh++,Ih(e.parentNode,t,n)):void 0:void 0}function Rh(e,t,n,r){Ah[e.id]||(Ah[e.id]={}),Ah[e.id][t]||(Ah[e.id][t]={}),Ah[e.id][t][n]||(Ah[e.id][t][n]=[]),Ah[e.id][t][n].push(r)}function kh(e,t,n,r){if(Ah[e.id])if(t)if(r||n)if(r){if(Ah[e.id][t][n])for(var i=0;i<Ah[e.id][t][n].length;i++)if(Ah[e.id][t][n][i]===r){Ah[e.id][t][n].splice(i,1);break}}else delete Ah[e.id][t][n];else Ah[e.id][t]={};else for(var o in Ah[e.id])Ah[e.id].hasOwnProperty(o)&&(Ah[e.id][o]={})}function Ph(e,t,n,r){if(this.element){e instanceof Array||(e=[e]),n||"function"!=typeof t||(n=t,t="_root");var i,o=this.id;for(i=0;i<e.length;i++)r?kh(this,e[i],t,n):(Ah[o]&&Ah[o][e[i]]||Dh.addEvent(this,e[i],s(e[i])),Rh(this,e[i],t,n));return this}function s(e){return function(t){!function(e,t,n){if(Ah[e][n]){var r,i,o=t.target||t.srcElement,s={},a=0,u=0;for(r in Sh=0,Ah[e][n])Ah[e][n].hasOwnProperty(r)&&(i=Ih(o,r,wh[e].element))&&Dh.matchesEvent(n,wh[e].element,i,"_root"==r,t)&&(Sh++,Ah[e][n][r].match=i,s[Sh]=Ah[e][n][r]);for(t.stopPropagation=function(){t.cancelBubble=!0},a=0;a<=Sh;a++)if(s[a])for(u=0;u<s[a].length;u++){if(!1===s[a][u].call(s[a].match,t))return void Dh.cancel(t);if(t.cancelBubble)return}}}(o,t,e)}}}function Dh(e,t){if(!(this instanceof Dh)){for(var n in wh)if(wh[n].element===e)return wh[n];return bh++,wh[bh]=new Dh(e,bh),wh[bh]}this.element=e,this.id=t}Dh.prototype.on=function(e,t,n){return Ph.call(this,e,t,n)},Dh.prototype.off=function(e,t,n){return Ph.call(this,e,t,n,!0)},Dh.matchesSelector=function(){},Dh.cancel=function(e){e.preventDefault(),e.stopPropagation()},Dh.addEvent=function(e,t,n){var r="blur"==t||"focus"==t,i=ze.passiveEvents?{capture:r,passive:!1}:r;e.element.addEventListener(t,n,i)},Dh.matchesEvent=function(){return!0};const Oh=Dh.addEvent,Lh=void 0===window.PointerEvent&&void 0!==window.MSPointerEvent,Ch={pointerdown:"MSPointerDown",pointerup:"MSPointerUp",pointercancel:"MSPointerCancel",pointermove:"MSPointerMove",pointerenter:"MSPointerEnter",pointerleave:"MSPointerLeave",pointerover:"MSPointerOver",pointerout:"MSPointerOut"},Nh="onmspointerenter"in document,Mh="onmspointerleave"in document;Dh.addEvent=function(e,t,n){Lh&&Ch[t]&&(t=Ch[t]),"transitionend"===t&&(Oh(e,"webkitTransitionEnd",n),Oh(e,"otransitionend",n)),"mouseenter"===t&&(t="mouseover"),"mouseleave"===t&&(t="mouseout"),"MSPointerEnter"!==t||Nh||(t="MSPointerOver"),"MSPointerLeave"!==t||Mh||(t="MSPointerOut"),Oh(e,t,n)},Dh.matchesEvent=function(e,t,n,r,i){return!("mouseenter"===e||"mouseleave"===e||!Nh&&"MSPointerEnter"===e||!Mh&&"MSPointerLeave"===e)||function(e,t,n,r){return!r.relatedTarget||(!n||e===t)&&t!==r.relatedTarget&&!t.contains(r.relatedTarget)}(t,n,r,i)};const xh={SETUP_DONE:"SETUP_DONE",NOT_SETUP:"NOT_SETUP"};let Uh=function(){function e(){this.version="1.2.36",this.remotePlayer=null,this.remotePlayerController=null,this.CastContextEventType=null,this.RemotePlayerEventType=null,this.CastState=xh,this.SessionState=null,this.PlayerState=null,this.currentLoadRequestId=null,this.currentLoadingMediaPromise=null}var t=e.prototype;return t.init=function({receiverApplicationId:e="",resumeSavedSession:t=!0,language:n=null,autoJoinPolicy:r="TAB_AND_ORIGIN_SCOPED"}={}){if(!this.isGCastApiAvailable)throw new Error("CAF is not available. Call setup() first.");if("string"!=typeof e||""===e.trim())throw new Error("Parameter 'receiverApplicationId' must be valid.");switch(r){case chrome.cast.AutoJoinPolicy.TAB_AND_ORIGIN_SCOPED:case chrome.cast.AutoJoinPolicy.ORIGIN_SCOPED:case chrome.cast.AutoJoinPolicy.PAGE_SCOPED:break;default:r=chrome.cast.AutoJoinPolicy.TAB_AND_ORIGIN_SCOPED}return this.CastContextEventType=cast.framework.CastContextEventType,this.RemotePlayerEventType=cast.framework.RemotePlayerEventType,this.CastState=Object.assign(this.CastState,cast.framework.CastState),this.SessionState=cast.framework.SessionState,this.PlayerState=chrome.cast.media.PlayerState,cast.framework.CastContext.getInstance().setOptions({receiverApplicationId:e.trim(),resumeSavedSession:t,language:n,autoJoinPolicy:r}),this.isInitialized?this.remotePlayerController:this.initRemotePlayer()},t.initRemotePlayer=function(){if(!this.isGCastApiAvailable)throw new ReferenceError("CAF is not available. Call setup() first.");return this.remotePlayer=new cast.framework.RemotePlayer,this.remotePlayerController=new cast.framework.RemotePlayerController(this.remotePlayer),this.remotePlayerController},t.setup=function({loadLibrary:e=!0}={}){return new Promise(((t,n)=>{if(this.isGCastApiAvailable)return this.AutoJoinPolicy=chrome.cast.AutoJoinPolicy,void t(!0);window.__onGCastApiAvailable=(e,r)=>{let i;r?(i=new Error(r),n(i)):chrome.cast?(this.AutoJoinPolicy=chrome.cast.AutoJoinPolicy,t(e)):(i=new ReferenceError("Cast is not available on this browser."),n(i))};try{if(!1===e)throw new ReferenceError("Cast is not available. Make sure the library has been loaded.");this.loadLibrary()||t(!1)}catch(r){const e=new Error(r);n(e)}}))},t.loadLibrary=function(){if(this.isGCastApiAvailable)return!0;if(null!==window.chrome&&void 0!==window.chrome&&"Google Inc."===window.navigator.vendor){let e="//www.gstatic.com/cv/js/sender/v1/cast_sender.js";if(!(document.querySelectorAll('script[src^="'+e+'"]').length>0)){e+="?loadCastFramework=1";const t=document.createElement("script");return t.src=e,t.async=!0,t.defer=!0,document.head.appendChild(t),!0}}return!1},t.loadMedia=function({contentId:e,contentType:t,currentTime:n=0,duration:r=0,requestCustomData:i=null,mediaCustomData:o=null,autoRequest:s=!1,tracks:a=[],ottCastOptions:u}){return e?this.isSessionEstablished?this.loadMediaOnSession(this.currentSession,{contentId:e,contentType:t,currentTime:n,duration:r,requestCustomData:i,mediaCustomData:o,tracks:a,ottCastOptions:u}):!0!==s?Promise.reject(new TypeError("Option 'autoRequest' must be true when session is not connected.")):this.requestSession().then((s=>this.loadMediaOnSession(s,{contentId:e,contentType:t,currentTime:n,duration:r,requestCustomData:i,mediaCustomData:o,tracks:a,ottCastOptions:u}))):Promise.reject(new TypeError("Option 'contentId' must be valid."))},t.loadMediaOnSession=function(e,{contentId:t,contentType:n,currentTime:r=0,duration:i,requestCustomData:o=null,mediaCustomData:s=null,tracks:a=[],ottCastOptions:u}){if(e&&e instanceof cast.framework.CastSession){const c=e.getSessionState();if(c!==this.SessionState.SESSION_STARTING&&c!==this.SessionState.SESSION_STARTED&&c!==this.SessionState.SESSION_RESUMED)return Promise.reject(new ReferenceError("Session must be established."));const l=this.createLoadRequest(t,n,r,i,o,s,a,u);return null!==this.currentLoadRequestId&&this.currentLoadRequestId===l.requestId||(this.currentLoadRequestId=l.requestId,this.currentLoadingMediaPromise=e.loadMedia(l).finally((()=>{this.currentLoadRequestId=null,this.currentLoadingMediaPromise=null}))),this.currentLoadingMediaPromise}return Promise.reject(new ReferenceError("Session must be cast.framework.CastSession."))},t.requestSession=function(){return this.isSessionEstablished?Promise.resolve(this.currentSession):this.castContext?this.castContext.requestSession().then((()=>this.currentSession)):Promise.reject(new Error("CastContext is not available. Call setup() first."))},t.sendMessage=function({namespace:e,data:t={},autoRequest:n=!1}){return this.isSessionEstablished?this.sendMessageOnSession(this.currentSession,{namespace:e,data:t}):!0!==n?Promise.reject(new TypeError("Option 'autoRequest' must be true when session is not connected.")):this.requestSession().then((n=>this.sendMessageOnSession(n,{namespace:e,data:t})))},t.sendMessageOnSession=function(e,{namespace:t,data:n={}}){if(e||!(e instanceof cast.framework.CastSession)){const r=e.getSessionState();return r!==this.SessionState.SESSION_STARTING&&r!==this.SessionState.SESSION_STARTED&&r!==this.SessionState.SESSION_RESUMED?Promise.reject(new ReferenceError("Session must be established.")):e.sendMessage(t,n)}return Promise.reject(new ReferenceError("Session must be cast.framework.CastSession."))},t.createCastButton=function(e){const t=document.createElement("button","google-cast-button");return e&&e.style&&(null===e.style["--disconnected-color"]&&(e.style["--disconnected-color"]="#00ADEF"),null===e.style["--connected-color"]&&(e.style["--connected-color"]="#E5E500")),e&&Object.keys(e).forEach((n=>{if("string"==typeof e[n])t.setAttribute(n,e[n]);else if("style"===n&&"object"==typeof e[n]){let r="";Object.keys(e[n]).forEach((t=>{r+=t+":"+e[n][t]+";"})),t.setAttribute(n,r)}})),t},t.createLoadRequest=function(e,t,n,r,i,o,s,a){const u=a?new chrome.cast.media.MediaInfo(a.contentId):new chrome.cast.media.MediaInfo(e.toString(),t);u.customData=o,u.duration=r;const c={subtitles:chrome.cast.media.TextTrackType.SUBTITLES,captions:chrome.cast.media.TextTrackType.CAPTIONS};u.tracks=s.map((e=>{const t=new chrome.cast.media.Track(e.id,chrome.cast.media.TrackType.TEXT);return t.trackContentId=e.url,t.trackContentType="text/vtt",t.subtype=c[e.kind],t.name=e.label,t.language=e.lang,t}));const l=new chrome.cast.media.LoadRequest(u);return l.customData=a?a.customData:i,l.currentTime=n||0,a&&(l.credentials=a.credentials,l.credentialsType=a.credentialsType),l},l(e,[{key:"isGCastApiAvailable",get:function(){return!!("undefined"!=typeof cast&&cast&&cast.framework&&cast.framework.VERSION)}},{key:"castState",get:function(){return this.castContext?this.castContext.getCastState():this.isGCastApiAvailable?this.CastState.SETUP_DONE:this.CastState.NOT_SETUP}},{key:"versionGCastApi",get:function(){return this.isGCastApiAvailable?cast.framework.VERSION:null}},{key:"castContext",get:function(){return this.isGCastApiAvailable?cast.framework.CastContext.getInstance():null}},{key:"currentSession",get:function(){return this.castContext?this.castContext.getCurrentSession():null}},{key:"currentSessionObj",get:function(){const e=this.currentSession;return e?e.getSessionObj():null}},{key:"isInitialized",get:function(){return!(!this.isGCastApiAvailable||!this.remotePlayerController)}},{key:"isSessionEstablished",get:function(){const e=this.currentSessionObj;return!!e&&e.status===chrome.cast.SessionStatus.CONNECTED}},{key:"isCastConnected",get:function(){return this.castState===this.CastState.CONNECTED}}])}();function Fh(e,t){return null==e||e!=e?t:e}new Uh;var jh=function(){if("undefined"!=typeof Map)return Map;function e(e,t){var n=-1;return e.some((function(e,r){return e[0]===t&&(n=r,!0)})),n}return function(){function t(){this.__entries__=[]}return Object.defineProperty(t.prototype,"size",{get:function(){return this.__entries__.length},enumerable:!0,configurable:!0}),t.prototype.get=function(t){var n=e(this.__entries__,t),r=this.__entries__[n];return r&&r[1]},t.prototype.set=function(t,n){var r=e(this.__entries__,t);~r?this.__entries__[r][1]=n:this.__entries__.push([t,n])},t.prototype.delete=function(t){var n=this.__entries__,r=e(n,t);~r&&n.splice(r,1)},t.prototype.has=function(t){return!!~e(this.__entries__,t)},t.prototype.clear=function(){this.__entries__.splice(0)},t.prototype.forEach=function(e,t){void 0===t&&(t=null);for(var n=0,r=this.__entries__;n<r.length;n++){var i=r[n];e.call(t,i[1],i[0])}},t}()}(),Vh="undefined"!=typeof window&&"undefined"!=typeof document&&window.document===document,Bh="undefined"!=typeof global&&global.Math===Math?global:"undefined"!=typeof self&&self.Math===Math?self:"undefined"!=typeof window&&window.Math===Math?window:Function("return this")(),Hh="function"==typeof requestAnimationFrame?requestAnimationFrame.bind(Bh):function(e){return setTimeout((function(){return e(Date.now())}),1e3/60)},Xh=["top","right","bottom","left","width","height","size","weight"],Wh="undefined"!=typeof MutationObserver,qh=function(){function e(){this.connected_=!1,this.mutationEventsAdded_=!1,this.mutationsObserver_=null,this.observers_=[],this.onTransitionEnd_=this.onTransitionEnd_.bind(this),this.refresh=function(e){var t=!1,n=!1,r=0;function i(){t&&(t=!1,e()),n&&s()}function o(){Hh(i)}function s(){var e=Date.now();if(t){if(e-r<2)return;n=!0}else t=!0,n=!1,setTimeout(o,20);r=e}return s}(this.refresh.bind(this))}return e.prototype.addObserver=function(e){~this.observers_.indexOf(e)||this.observers_.push(e),this.connected_||this.connect_()},e.prototype.removeObserver=function(e){var t=this.observers_,n=t.indexOf(e);~n&&t.splice(n,1),!t.length&&this.connected_&&this.disconnect_()},e.prototype.refresh=function(){this.updateObservers_()&&this.refresh()},e.prototype.updateObservers_=function(){var e=this.observers_.filter((function(e){return e.gatherActive(),e.hasActive()}));return e.forEach((function(e){return e.broadcastActive()})),e.length>0},e.prototype.connect_=function(){Vh&&!this.connected_&&(document.addEventListener("transitionend",this.onTransitionEnd_),window.addEventListener("resize",this.refresh),Wh?(this.mutationsObserver_=new MutationObserver(this.refresh),this.mutationsObserver_.observe(document,{attributes:!0,childList:!0,characterData:!0,subtree:!0})):(document.addEventListener("DOMSubtreeModified",this.refresh),this.mutationEventsAdded_=!0),this.connected_=!0)},e.prototype.disconnect_=function(){Vh&&this.connected_&&(document.removeEventListener("transitionend",this.onTransitionEnd_),window.removeEventListener("resize",this.refresh),this.mutationsObserver_&&this.mutationsObserver_.disconnect(),this.mutationEventsAdded_&&document.removeEventListener("DOMSubtreeModified",this.refresh),this.mutationsObserver_=null,this.mutationEventsAdded_=!1,this.connected_=!1)},e.prototype.onTransitionEnd_=function(e){var t=e.propertyName,n=void 0===t?"":t;Xh.some((function(e){return!!~n.indexOf(e)}))&&this.refresh()},e.getInstance=function(){return this.instance_||(this.instance_=new e),this.instance_},e.instance_=null,e}(),Gh=function(e,t){for(var n=0,r=Object.keys(t);n<r.length;n++){var i=r[n];Object.defineProperty(e,i,{value:t[i],enumerable:!1,writable:!1,configurable:!0})}return e},Kh=function(e){return e&&e.ownerDocument&&e.ownerDocument.defaultView||Bh},Yh=Zh(0,0,0,0);function $h(e){return parseFloat(e)||0}function zh(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];return t.reduce((function(t,n){return t+$h(e["border-"+n+"-width"])}),0)}var Qh="undefined"!=typeof SVGGraphicsElement?function(e){return e instanceof Kh(e).SVGGraphicsElement}:function(e){return e instanceof Kh(e).SVGElement&&"function"==typeof e.getBBox};function Jh(e){return Vh?Qh(e)?function(e){var t=e.getBBox();return Zh(0,0,t.width,t.height)}(e):function(e){var t=e.clientWidth,n=e.clientHeight;if(!t&&!n)return Yh;var r=Kh(e).getComputedStyle(e),i=function(e){for(var t={},n=0,r=["top","right","bottom","left"];n<r.length;n++){var i=r[n],o=e["padding-"+i];t[i]=$h(o)}return t}(r),o=i.left+i.right,s=i.top+i.bottom,a=$h(r.width),u=$h(r.height);if("border-box"===r.boxSizing&&(Math.round(a+o)!==t&&(a-=zh(r,"left","right")+o),Math.round(u+s)!==n&&(u-=zh(r,"top","bottom")+s)),!function(e){return e===Kh(e).document.documentElement}(e)){var c=Math.round(a+o)-t,l=Math.round(u+s)-n;1!==Math.abs(c)&&(a-=c),1!==Math.abs(l)&&(u-=l)}return Zh(i.left,i.top,a,u)}(e):Yh}function Zh(e,t,n,r){return{x:e,y:t,width:n,height:r}}var ef=function(){function e(e){this.broadcastWidth=0,this.broadcastHeight=0,this.contentRect_=Zh(0,0,0,0),this.target=e}return e.prototype.isActive=function(){var e=Jh(this.target);return this.contentRect_=e,e.width!==this.broadcastWidth||e.height!==this.broadcastHeight},e.prototype.broadcastRect=function(){var e=this.contentRect_;return this.broadcastWidth=e.width,this.broadcastHeight=e.height,e},e}(),tf=function(e,t){var n=function(e){var t=e.x,n=e.y,r=e.width,i=e.height,o="undefined"!=typeof DOMRectReadOnly?DOMRectReadOnly:Object,s=Object.create(o.prototype);return Gh(s,{x:t,y:n,width:r,height:i,top:n,right:t+r,bottom:i+n,left:t}),s}(t);Gh(this,{target:e,contentRect:n})},nf=function(){function e(e,t,n){if(this.activeObservations_=[],this.observations_=new jh,"function"!=typeof e)throw new TypeError("The callback provided as parameter 1 is not a function.");this.callback_=e,this.controller_=t,this.callbackCtx_=n}return e.prototype.observe=function(e){if(!arguments.length)throw new TypeError("1 argument required, but only 0 present.");if("undefined"!=typeof Element&&Element instanceof Object){if(!(e instanceof Kh(e).Element))throw new TypeError('parameter 1 is not of type "Element".');var t=this.observations_;t.has(e)||(t.set(e,new ef(e)),this.controller_.addObserver(this),this.controller_.refresh())}},e.prototype.unobserve=function(e){if(!arguments.length)throw new TypeError("1 argument required, but only 0 present.");if("undefined"!=typeof Element&&Element instanceof Object){if(!(e instanceof Kh(e).Element))throw new TypeError('parameter 1 is not of type "Element".');var t=this.observations_;t.has(e)&&(t.delete(e),t.size||this.controller_.removeObserver(this))}},e.prototype.disconnect=function(){this.clearActive(),this.observations_.clear(),this.controller_.removeObserver(this)},e.prototype.gatherActive=function(){var e=this;this.clearActive(),this.observations_.forEach((function(t){t.isActive()&&e.activeObservations_.push(t)}))},e.prototype.broadcastActive=function(){if(this.hasActive()){var e=this.callbackCtx_,t=this.activeObservations_.map((function(e){return new tf(e.target,e.broadcastRect())}));this.callback_.call(e,t,e),this.clearActive()}},e.prototype.clearActive=function(){this.activeObservations_.splice(0)},e.prototype.hasActive=function(){return this.activeObservations_.length>0},e}(),rf="undefined"!=typeof WeakMap?new WeakMap:new jh,of=function e(t){if(!(this instanceof e))throw new TypeError("Cannot call a class as a function.");if(!arguments.length)throw new TypeError("1 argument required, but only 0 present.");var n=qh.getInstance(),r=new nf(t,n,this);rf.set(this,r)};["observe","unobserve","disconnect"].forEach((function(e){of.prototype[e]=function(){var t;return(t=rf.get(this))[e].apply(t,arguments)}}));var sf=void 0!==Bh.ResizeObserver?Bh.ResizeObserver:of;function af(e,t,n){this.constructorName="MessageApiError",this.message=e,this.name=t,this.source=n}function uf(e){return e}function cf(e){if(!e||""===e)return{};if("object"==typeof e)return e;try{return JSON.parse(e)}catch(t){return{}}}function lf(e){}af.prototype=new Error;let df={captureException(e){},captureMessage(e){},captureBreadcrumb(){}},hf=df;var ff={set:function(e){hf=Object.assign({},df,e)},captureException:function(e,t){return hf.captureException(e,t)},captureMessage:function(e,t){return hf.captureMessage(e,t)},captureBreadcrumb:function(e,t,n="backbone",r="info"){return hf.captureBreadcrumb(e,t,n,r)}};function pf(e={hidePrivateMethods:!0}){const t={},n={},r={parseMessage:cf,buildMessage:uf,logError:lf};let i,o,s={};const a={get methods(){return t},extendMethods(...e){D.apply(void 0,[t].concat(e))},get listeners(){return s},set listeners(e){s=e},emit(e,...t){u.apply(void 0,[e].concat(t))&&d(c.apply(void 0,[e].concat(t)))},emitMethodEvent(e,t){d({method:e,value:t})},filter(e,t){t||"function"!=typeof e||(t=e,e=null),e?function(e,t){n.event=n.event||{},n.event[e]=n.event[e]||[],n.event[e].push(t)}(e,t):function(e){n.global=n.global||[],n.global.push(e)}(t)},hooks:(...e)=>D.apply(void 0,[r].concat(e)),configureClient(e,t){i=e,o=t},tearDown(){window.removeEventListener("message",l)}};function u(...e){if(n){let t,r;if(n.global&&n.global.length)for(t=0;t<n.global.length;t++)if(r=n.global[t],!r.apply(r,e))return!1;let i=e[0];if(n.event&&n.event[i]&&n.event[i].length)for(t=0;t<n.event[i].length;t++)if(r=n.event[i][t],!r.apply(r,e))return!1}return!0}function c(e,...t){const n={event:e};return t&&void 0!==t[0]&&(n.data=t[0]),n}function l(n){if(i!==n.source)return;let o=r.parseMessage(n.data),{method:s,value:a,id:u}=o;if(!(void 0===s||"string"!=typeof s||e.hidePrivateMethods&&s.indexOf("_")>-1))try{let e,i=function(e,t){if(!e)return null;let n=Object.getOwnPropertyDescriptor(t,e);if(n&&"function"==typeof n.value)return n.value;if(n&&"function"==typeof n.get)return n.get;const r=e.substr(0,3),i=e.substr(3,1).toLowerCase()+e.substr(4);return n=Object.getOwnPropertyDescriptor(t,i),"get"===r&&n&&"function"==typeof n.get?n.get:"set"===r&&n&&"function"==typeof n.set?n.set:null}(s,t);if(!i)throw new af(`“${n}” is not a valid method. Valid methods are: ${function(e){return Object.keys(e).reduce(((t,n)=>{if(n.indexOf("_")>-1)return t;const r=Object.getOwnPropertyDescriptor(e,n);return"function"==typeof r.value?(t.push(n),t):("function"==typeof r.get&&t.push("get"+n.charAt(0).toUpperCase()+n.slice(1)),"function"==typeof r.set&&t.push("set"+n.charAt(0).toUpperCase()+n.slice(1)),t)}),[]).sort()}(t).join(", ")}.`,"TypeError",s);ff.captureBreadcrumb("API message received",o,"api"),e=Array.isArray(a)?a:null==a?[]:[a],Promise.resolve(i.call.apply(i,[n].concat(T(e),[u]))).then((e=>{let t;t=Array.isArray(a)||null==e?a:e,d({method:s,value:t})})).catch(r.logError)}catch(c){r.logError(c)}}function d(e){if(o&&function(e=window.parent){return!(!window.postMessage||!e.postMessage)}(i)){e=r.buildMessage(e);try{i.postMessage(e,o)}catch(t){}}}return window.addEventListener("message",l,!1),a}var _f=self!==top,mf=function(){var e=document.createElement("video"),t={request:["requestFullscreen","webkitRequestFullscreen","webkitRequestFullScreen","mozRequestFullScreen","msRequestFullscreen"],exit:["exitFullscreen","webkitCancelFullScreen","webkitExitFullscreen","mozCancelFullScreen","msExitFullscreen"],enabled:["fullscreenEnabled","webkitFullscreenEnabled","mozFullScreenEnabled","msFullscreenEnabled"],element:["fullscreenElement","webkitFullscreenElement","webkitCurrentFullScreenElement","mozFullScreenElement","msFullscreenElement"],change:["fullscreenchange","webkitfullscreenchange","mozfullscreenchange","MSFullscreenChange"],error:["fullscreenerror","webkitfullscreenerror","mozfullscreenerror","MSFullscreenError"]},n={};for(var r in t)for(var i=0,o=t[r].length;i<o;i++)if(t[r][i]in e||t[r][i]in document||"on"+t[r][i].toLowerCase()in document){n[r]=t[r][i];break}return n}(),vf={ENTER:"enter",EXIT:"exit",CHANGE:"change",ERROR:"error"},gf=[],yf={};function Ef(){var e=Array.prototype.slice.apply(arguments),t=e.shift();yf[t].forEach((function(t){"function"==typeof t&&t.apply(t,e)}))}function Tf(e){return function(t,n){-1!==gf.indexOf(t)&&e.call(this,t,n)}}function Sf(e){var t=null;if("VIDEO"===e.tagName)t=e;else{var n=e.getElementsByTagName("video");n[0]&&(t=n[0])}return t}Object.keys(vf).forEach((function(e){gf.push(vf[e]),yf[vf[e]]=[]}));var bf=null,Af=function(){},wf=[];function If(e){var t=Sf(e);if(t&&t.webkitEnterFullscreen){try{t.readyState<t.HAVE_CURRENT_DATA?t.addEventListener("loadeddata",(function n(){t.removeEventListener("loadeddata",n,!1);try{t.webkitEnterFullscreen()}catch(r){return Pf("cannot_enter_fullscreen",e)}}),!1):t.webkitEnterFullscreen(),bf=t}catch(n){return Pf("not_supported",e)}return!0}return Pf(void 0===mf.request?"not_supported":"not_enabled",e)}var Rf=function(e){var t=wf[wf.length-1];t&&(e!==t.element&&e!==bf||!t.hasEntered)&&("VIDEO"===e.tagName&&(bf=e),1===wf.length&&Df.onenter(Df.element),t.enter.call(t.element,e||t.element),t.hasEntered=!0,Ef(vf.ENTER,Df.element))},kf=function(){bf=null;var e=wf.pop();e&&(e.exit.call(e.element),Ef(vf.EXIT,e.element),Df.element||(wf.forEach((function(e){e.exit.call(e.element),Ef(vf.EXIT,e.element)})),wf=[],Df.onexit()))},Pf=function(e,t){if(wf.length>0){var n=wf.pop();t=t||n.element,n.error.call(t,e),Df.onerror(t,e),Ef(vf.ERROR,t,e)}},Df={request:function(e,t,n,r){if(e=e||document.body,wf.push({element:e,enter:t||Af,exit:n||Af,error:r||Af}),void 0===mf.request)return If(e);if(_f&&!1===document[mf.enabled])return If(e);try{e[mf.request]()}catch(i){Pf("not_enabled",e)}},exit:function(){!document[mf.exit]&&Df.element?Df.element[mf.exit]():document[mf.exit]()},toggle:function(e,t,n,r){Df.element?Df.exit():Df.request(e,t,n,r)},videoEnabled:function(e){if(Df.enabled)return!0;var t=Sf(e=e||document.body);return!(!t||void 0===t.webkitSupportsFullscreen)&&(t.readyState<t.HAVE_METADATA?"maybe":t.webkitSupportsFullscreen)},on:Tf((function(e,t){yf[e].push(t)})),off:Tf((function(e,t){var n=yf[e].indexOf(t);n>-1&&yf[e].splice(n,1)})),onenter:Af,onexit:Af,onchange:Af,onerror:Af};try{Object.defineProperties(Df,{element:{enumerable:!0,get:function(){return bf&&bf.webkitDisplayingFullscreen?bf:document[mf.element]||null}},enabled:{enumerable:!0,get:function(){return document[mf.enabled]||!1}}})}catch(Fv){Df.element=null,Df.enabled=!1}function Of(){return window.parent!=window}mf.change&&document.addEventListener(mf.change,(function(e){if(Df.onchange(Df.element),Ef(vf.CHANGE,Df.element),Df.element){var t=wf[wf.length-2];t&&t.element===Df.element?kf():Rf(Df.element)}else kf()}),!1),document.addEventListener("webkitbeginfullscreen",(function(e){var t=!0;if(wf.length>0)for(var n=0,r=wf.length;n<r;n++)if(Sf(wf[n].element)===e.srcElement){t=!1;break}t&&wf.push({element:e.srcElement,enter:Af,exit:Af,error:Af}),Df.onchange(e.srcElement),Ef(vf.CHANGE,Df.srcElement),Rf(e.srcElement)}),!0),document.addEventListener("webkitendfullscreen",(function(e){Df.onchange(e.srcElement),Ef(vf.CHANGE,e.srcElement),kf(e.srcElement)}),!0),mf.error&&document.addEventListener(mf.error,(function(e){Pf("not_allowed")}),!1);var Lf=Object.prototype.hasOwnProperty,Cf=Ii((function(e,t){if(Zn(t)||ir(t))Pn(t,or(t),e);else for(var n in t)Lf.call(t,n)&&kn(e,n,t[n])})),Nf=Vi((function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.Tracker=void 0;var n=function(){function e(){}return e.getAttributeTypeMap=function(){return e.attributeTypeMap},e.attributeTypeMap=[{name:"name",baseName:"name",type:"string"},{name:"version",baseName:"version",type:"string"}],e}();t.Tracker=n}));let Mf;const xf=new Uint8Array(16);function Uf(){if(!Mf&&(Mf="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!Mf))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return Mf(xf)}var Ff=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;function jf(e){return"string"==typeof e&&Ff.test(e)}const Vf=[];for(let jv=0;jv<256;++jv)Vf.push((jv+256).toString(16).slice(1));function Bf(e,t=0){return Vf[e[t+0]]+Vf[e[t+1]]+Vf[e[t+2]]+Vf[e[t+3]]+"-"+Vf[e[t+4]]+Vf[e[t+5]]+"-"+Vf[e[t+6]]+Vf[e[t+7]]+"-"+Vf[e[t+8]]+Vf[e[t+9]]+"-"+Vf[e[t+10]]+Vf[e[t+11]]+Vf[e[t+12]]+Vf[e[t+13]]+Vf[e[t+14]]+Vf[e[t+15]]}let Hf,Xf,Wf=0,qf=0;function Gf(e){if(!jf(e))throw TypeError("Invalid UUID");let t;const n=new Uint8Array(16);return n[0]=(t=parseInt(e.slice(0,8),16))>>>24,n[1]=t>>>16&255,n[2]=t>>>8&255,n[3]=255&t,n[4]=(t=parseInt(e.slice(9,13),16))>>>8,n[5]=255&t,n[6]=(t=parseInt(e.slice(14,18),16))>>>8,n[7]=255&t,n[8]=(t=parseInt(e.slice(19,23),16))>>>8,n[9]=255&t,n[10]=(t=parseInt(e.slice(24,36),16))/1099511627776&255,n[11]=t/4294967296&255,n[12]=t>>>24&255,n[13]=t>>>16&255,n[14]=t>>>8&255,n[15]=255&t,n}function Kf(e,t,n){function r(e,r,i,o){var s;if("string"==typeof e&&(e=function(e){e=unescape(encodeURIComponent(e));const t=[];for(let n=0;n<e.length;++n)t.push(e.charCodeAt(n));return t}(e)),"string"==typeof r&&(r=Gf(r)),16!==(null===(s=r)||void 0===s?void 0:s.length))throw TypeError("Namespace must be array-like (16 iterable integer values, 0-255)");let a=new Uint8Array(16+e.length);if(a.set(r),a.set(e,r.length),a=n(a),a[6]=15&a[6]|t,a[8]=63&a[8]|128,i){o=o||0;for(let e=0;e<16;++e)i[o+e]=a[e];return i}return Bf(a)}try{r.name=e}catch(Fv){}return r.DNS="6ba7b810-9dad-11d1-80b4-00c04fd430c8",r.URL="6ba7b811-9dad-11d1-80b4-00c04fd430c8",r}function Yf(e){return 14+(e+64>>>9<<4)+1}function $f(e,t){const n=(65535&e)+(65535&t);return(e>>16)+(t>>16)+(n>>16)<<16|65535&n}function zf(e,t,n,r,i,o){return $f(function(e,t){return e<<t|e>>>32-t}($f($f(t,e),$f(r,o)),i),n)}function Qf(e,t,n,r,i,o,s){return zf(t&n|~t&r,e,t,i,o,s)}function Jf(e,t,n,r,i,o,s){return zf(t&r|n&~r,e,t,i,o,s)}function Zf(e,t,n,r,i,o,s){return zf(t^n^r,e,t,i,o,s)}function ep(e,t,n,r,i,o,s){return zf(n^(t|~r),e,t,i,o,s)}const tp=Kf("v3",48,(function(e){if("string"==typeof e){const t=unescape(encodeURIComponent(e));e=new Uint8Array(t.length);for(let n=0;n<t.length;++n)e[n]=t.charCodeAt(n)}return function(e){const t=[],n=32*e.length,r="0123456789abcdef";for(let i=0;i<n;i+=8){const n=e[i>>5]>>>i%32&255,o=parseInt(r.charAt(n>>>4&15)+r.charAt(15&n),16);t.push(o)}return t}(function(e,t){e[t>>5]|=128<<t%32,e[Yf(t)-1]=t;let n=1732584193,r=-271733879,i=-1732584194,o=271733878;for(let s=0;s<e.length;s+=16){const t=n,a=r,u=i,c=o;n=Qf(n,r,i,o,e[s],7,-680876936),o=Qf(o,n,r,i,e[s+1],12,-389564586),i=Qf(i,o,n,r,e[s+2],17,606105819),r=Qf(r,i,o,n,e[s+3],22,-1044525330),n=Qf(n,r,i,o,e[s+4],7,-176418897),o=Qf(o,n,r,i,e[s+5],12,1200080426),i=Qf(i,o,n,r,e[s+6],17,-1473231341),r=Qf(r,i,o,n,e[s+7],22,-45705983),n=Qf(n,r,i,o,e[s+8],7,1770035416),o=Qf(o,n,r,i,e[s+9],12,-1958414417),i=Qf(i,o,n,r,e[s+10],17,-42063),r=Qf(r,i,o,n,e[s+11],22,-1990404162),n=Qf(n,r,i,o,e[s+12],7,1804603682),o=Qf(o,n,r,i,e[s+13],12,-40341101),i=Qf(i,o,n,r,e[s+14],17,-1502002290),r=Qf(r,i,o,n,e[s+15],22,1236535329),n=Jf(n,r,i,o,e[s+1],5,-165796510),o=Jf(o,n,r,i,e[s+6],9,-1069501632),i=Jf(i,o,n,r,e[s+11],14,643717713),r=Jf(r,i,o,n,e[s],20,-373897302),n=Jf(n,r,i,o,e[s+5],5,-701558691),o=Jf(o,n,r,i,e[s+10],9,38016083),i=Jf(i,o,n,r,e[s+15],14,-660478335),r=Jf(r,i,o,n,e[s+4],20,-405537848),n=Jf(n,r,i,o,e[s+9],5,568446438),o=Jf(o,n,r,i,e[s+14],9,-1019803690),i=Jf(i,o,n,r,e[s+3],14,-187363961),r=Jf(r,i,o,n,e[s+8],20,1163531501),n=Jf(n,r,i,o,e[s+13],5,-1444681467),o=Jf(o,n,r,i,e[s+2],9,-51403784),i=Jf(i,o,n,r,e[s+7],14,1735328473),r=Jf(r,i,o,n,e[s+12],20,-1926607734),n=Zf(n,r,i,o,e[s+5],4,-378558),o=Zf(o,n,r,i,e[s+8],11,-2022574463),i=Zf(i,o,n,r,e[s+11],16,1839030562),r=Zf(r,i,o,n,e[s+14],23,-35309556),n=Zf(n,r,i,o,e[s+1],4,-1530992060),o=Zf(o,n,r,i,e[s+4],11,1272893353),i=Zf(i,o,n,r,e[s+7],16,-155497632),r=Zf(r,i,o,n,e[s+10],23,-1094730640),n=Zf(n,r,i,o,e[s+13],4,681279174),o=Zf(o,n,r,i,e[s],11,-358537222),i=Zf(i,o,n,r,e[s+3],16,-722521979),r=Zf(r,i,o,n,e[s+6],23,76029189),n=Zf(n,r,i,o,e[s+9],4,-640364487),o=Zf(o,n,r,i,e[s+12],11,-421815835),i=Zf(i,o,n,r,e[s+15],16,530742520),r=Zf(r,i,o,n,e[s+2],23,-995338651),n=ep(n,r,i,o,e[s],6,-198630844),o=ep(o,n,r,i,e[s+7],10,1126891415),i=ep(i,o,n,r,e[s+14],15,-1416354905),r=ep(r,i,o,n,e[s+5],21,-57434055),n=ep(n,r,i,o,e[s+12],6,1700485571),o=ep(o,n,r,i,e[s+3],10,-1894986606),i=ep(i,o,n,r,e[s+10],15,-1051523),r=ep(r,i,o,n,e[s+1],21,-2054922799),n=ep(n,r,i,o,e[s+8],6,1873313359),o=ep(o,n,r,i,e[s+15],10,-30611744),i=ep(i,o,n,r,e[s+6],15,-1560198380),r=ep(r,i,o,n,e[s+13],21,1309151649),n=ep(n,r,i,o,e[s+4],6,-145523070),o=ep(o,n,r,i,e[s+11],10,-1120210379),i=ep(i,o,n,r,e[s+2],15,718787259),r=ep(r,i,o,n,e[s+9],21,-343485551),n=$f(n,t),r=$f(r,a),i=$f(i,u),o=$f(o,c)}return[n,r,i,o]}(function(e){if(0===e.length)return[];const t=8*e.length,n=new Uint32Array(Yf(t));for(let r=0;r<t;r+=8)n[r>>5]|=(255&e[r/8])<<r%32;return n}(e),8*e.length))}));var np={randomUUID:"undefined"!=typeof crypto&&crypto.randomUUID&&crypto.randomUUID.bind(crypto)};function rp(e,t,n,r){switch(e){case 0:return t&n^~t&r;case 1:case 3:return t^n^r;case 2:return t&n^t&r^n&r}}function ip(e,t){return e<<t|e>>>32-t}const op=Kf("v5",80,(function(e){const t=[1518500249,1859775393,2400959708,3395469782],n=[1732584193,4023233417,2562383102,271733878,3285377520];if("string"==typeof e){const t=unescape(encodeURIComponent(e));e=[];for(let n=0;n<t.length;++n)e.push(t.charCodeAt(n))}else Array.isArray(e)||(e=Array.prototype.slice.call(e));e.push(128);const r=e.length/4+2,i=Math.ceil(r/16),o=new Array(i);for(let s=0;s<i;++s){const t=new Uint32Array(16);for(let n=0;n<16;++n)t[n]=e[64*s+4*n]<<24|e[64*s+4*n+1]<<16|e[64*s+4*n+2]<<8|e[64*s+4*n+3];o[s]=t}o[i-1][14]=8*(e.length-1)/Math.pow(2,32),o[i-1][14]=Math.floor(o[i-1][14]),o[i-1][15]=8*(e.length-1)&4294967295;for(let s=0;s<i;++s){const e=new Uint32Array(80);for(let t=0;t<16;++t)e[t]=o[s][t];for(let t=16;t<80;++t)e[t]=ip(e[t-3]^e[t-8]^e[t-14]^e[t-16],1);let r=n[0],i=n[1],a=n[2],u=n[3],c=n[4];for(let n=0;n<80;++n){const o=Math.floor(n/20),s=ip(r,5)+rp(o,i,a,u)+c+t[o]+e[n]>>>0;c=u,u=a,a=ip(i,30)>>>0,i=r,r=s}n[0]=n[0]+r>>>0,n[1]=n[1]+i>>>0,n[2]=n[2]+a>>>0,n[3]=n[3]+u>>>0,n[4]=n[4]+c>>>0}return[n[0]>>24&255,n[0]>>16&255,n[0]>>8&255,255&n[0],n[1]>>24&255,n[1]>>16&255,n[1]>>8&255,255&n[1],n[2]>>24&255,n[2]>>16&255,n[2]>>8&255,255&n[2],n[3]>>24&255,n[3]>>16&255,n[3]>>8&255,255&n[3],n[4]>>24&255,n[4]>>16&255,n[4]>>8&255,255&n[4]]}));var sp=Object.freeze({__proto__:null,v1:function(e,t,n){let r=t&&n||0;const i=t||new Array(16);let o=(e=e||{}).node||Hf,s=void 0!==e.clockseq?e.clockseq:Xf;if(null==o||null==s){const t=e.random||(e.rng||Uf)();null==o&&(o=Hf=[1|t[0],t[1],t[2],t[3],t[4],t[5]]),null==s&&(s=Xf=16383&(t[6]<<8|t[7]))}let a=void 0!==e.msecs?e.msecs:Date.now(),u=void 0!==e.nsecs?e.nsecs:qf+1;const c=a-Wf+(u-qf)/1e4;if(c<0&&void 0===e.clockseq&&(s=s+1&16383),(c<0||a>Wf)&&void 0===e.nsecs&&(u=0),u>=1e4)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");Wf=a,qf=u,Xf=s,a+=122192928e5;const l=(1e4*(268435455&a)+u)%4294967296;i[r++]=l>>>24&255,i[r++]=l>>>16&255,i[r++]=l>>>8&255,i[r++]=255&l;const d=a/4294967296*1e4&268435455;i[r++]=d>>>8&255,i[r++]=255&d,i[r++]=d>>>24&15|16,i[r++]=d>>>16&255,i[r++]=s>>>8|128,i[r++]=255&s;for(let h=0;h<6;++h)i[r+h]=o[h];return t||Bf(i)},v3:tp,v4:function(e,t,n){if(np.randomUUID&&!t&&!e)return np.randomUUID();const r=(e=e||{}).random||(e.rng||Uf)();if(r[6]=15&r[6]|64,r[8]=63&r[8]|128,t){n=n||0;for(let e=0;e<16;++e)t[n+e]=r[e];return t}return Bf(r)},v5:op,NIL:"00000000-0000-0000-0000-000000000000",version:function(e){if(!jf(e))throw TypeError("Invalid UUID");return parseInt(e.slice(14,15),16)},validate:jf,stringify:function(e,t=0){const n=Bf(e,t);if(!jf(n))throw TypeError("Stringified UUID is invalid");return n},parse:Gf}),ap=function(e){return e&&e.default||e}(sp),up=Vi((function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.Envelope=void 0;var n=function(){function e(e,t){this.event=e,this.eid=(0,ap.v4)(),this.ts_ms=Date.now(),this.created_at=Date.now(),this._tracker=new Nf.Tracker,this._globalBPO=t}return Object.defineProperty(e.prototype,"tracker",{get:function(){return this._tracker},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"global",{get:function(){return this._globalBPO},enumerable:!1,configurable:!0}),e.getAttributeTypeMap=function(){return e.attributeTypeMap},e.attributeTypeMap=[{name:"eid",baseName:"eid",type:"string"},{name:"ts_ms",baseName:"ts_ms",type:"number"},{name:"created_at",baseName:"created_at",type:"number"},{name:"event",baseName:"event",type:"Event"},{name:"global",baseName:"global",type:"Event"},{name:"tracker",baseName:"tracker",type:"Tracker"}],e}();t.Envelope=n})),cp=Vi((function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.Event=void 0;var n=function(){function e(e,t,n){this.name=e,this.ts_ms=Date.now(),this.version=t,this.fields=n}return e.getAttributeTypeMap=function(){return e.attributeTypeMap},e.attributeTypeMap=[{name:"name",baseName:"name",type:"string"},{name:"ts_ms",baseName:"ts_ms",type:"number"},{name:"version",baseName:"version",type:"number"},{name:"fields",baseName:"fields",type:"object"}],e}();t.Event=n})),lp=Vi((function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.EventContext=void 0;var n=function(){function e(e,t,n){this.name=e,this.ts_ms=Date.now(),this.version=t,this.fields=n}return e.getAttributeTypeMap=function(){return e.attributeTypeMap},e.attributeTypeMap=[{name:"name",baseName:"name",type:"string"},{name:"ts_ms",baseName:"ts_ms",type:"number"},{name:"version",baseName:"version",type:"number"},{name:"fields",baseName:"fields",type:"object"}],e}();t.EventContext=n})),dp=Vi((function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.GlobalContext=void 0;t.GlobalContext=function(e,t,n){this.name=e,this.ts_ms=Date.now(),this.version=t,this.fields=n}})),hp=Vi((function(e,t){var n=ji&&ji.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var i=Object.getOwnPropertyDescriptor(t,n);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,i)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),r=ji&&ji.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||n(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0}),t.ObjectSerializer=void 0,r(up,t),r(cp,t),r(lp,t),r(Nf,t),r(dp,t);var i=cp,o=lp,s=Nf,a=["string","boolean","double","integer","long","float","number","any"],u={},c={Envelope:up.Envelope,Event:i.Event,Tracker:s.Tracker,EventContext:o.EventContext},l=function(){function e(){}return e.findCorrectType=function(e,t){if(null==e)return t;if(-1!==a.indexOf(t.toLowerCase()))return t;if("Date"===t)return t;if(u[t])return t;if(!c[t])return t;var n=c[t].discriminator;if(null==n)return t;if(e[n]){var r=e[n];return c[r]?r:t}return t},e.serialize=function(t,n){if(null==t)return t;if(-1!==a.indexOf(n.toLowerCase()))return t;if(0===n.lastIndexOf("Array<",0)){var r=n.replace("Array<","");r=r.substring(0,r.length-1);var i=[];for(var o in t){var s=t[o];i.push(e.serialize(s,r))}return i}if("Date"===n)return t.toISOString();if(u[n])return t;if(!c[n])return t;n=this.findCorrectType(t,n);var l=c[n].getAttributeTypeMap(),d={};for(var o in l){var h=l[o];d[h.baseName]=e.serialize(t[h.name],h.type)}return d},e.deserialize=function(t,n){if(n=e.findCorrectType(t,n),null==t)return t;if(-1!==a.indexOf(n.toLowerCase()))return t;if(0===n.lastIndexOf("Array<",0)){var r=n.replace("Array<","");r=r.substring(0,r.length-1);var i=[];for(var o in t){var s=t[o];i.push(e.deserialize(s,r))}return i}if("Date"===n)return new Date(t);if(u[n])return t;if(!c[n])return t;var l=new c[n],d=c[n].getAttributeTypeMap();for(var o in d){var h=d[o];l[h.name]=e.deserialize(t[h.baseName],h.type)}return l},e}();t.ObjectSerializer=l})),fp=Vi((function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.formatRequestEvent=t.parseJwt=t.getCookie=void 0,t.getCookie=function(e){if("undefined"==typeof document)return null;var t=document.cookie.match(new RegExp("(;\\s)?".concat(e,"=")));if(!t||0==t.length||void 0===t.index)return null;var n=document.cookie.indexOf(";",t.index+1),r=t.index+t[0].length,i=-1===n?document.cookie.substr(r):document.cookie.substring(r,n);return decodeURIComponent(i)},t.parseJwt=function(e){var t=e.split(".")[1].replace(/-/g,"+").replace(/_/g,"/"),n=decodeURIComponent(atob(t).split("").map((function(e){return"%"+("00"+e.charCodeAt(0).toString(16)).slice(-2)})).join(""));return JSON.parse(n)},t.formatRequestEvent=function(e){var t=e.split(".");if(t.length<=2)return e;var n=t.pop();return"".concat(t.join("_"),".").concat(n)}})),pp=Vi((function(e,t){var n,r=ji&&ji.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function s(e){try{u(r.next(e))}catch(Rp){o(Rp)}}function a(e){try{u(r.throw(e))}catch(Rp){o(Rp)}}function u(e){e.done?i(e.value):function(e){return e instanceof n?e:new n((function(t){t(e)}))}(e.value).then(s,a)}u((r=r.apply(e,t||[])).next())}))},i=ji&&ji.__generator||function(e,t){var n,r,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(a){return function(u){return function(a){if(n)throw new TypeError("Generator is already executing.");for(;o&&(o=0,a[0]&&(s=0)),s;)try{if(n=1,r&&(i=2&a[0]?r.return:a[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,a[1])).done)return i;switch(r=0,i&&(a=[2&a[0],i.value]),a[0]){case 0:case 1:i=a;break;case 4:return s.label++,{value:a[1],done:!1};case 5:s.label++,r=a[1],a=[0];continue;case 7:a=s.ops.pop(),s.trys.pop();continue;default:if(!((i=(i=s.trys).length>0&&i[i.length-1])||6!==a[0]&&2!==a[0])){s=0;continue}if(3===a[0]&&(!i||a[1]>i[0]&&a[1]<i[3])){s.label=a[1];break}if(6===a[0]&&s.label<i[1]){s.label=i[1],i=a;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(a);break}i[2]&&s.ops.pop(),s.trys.pop();continue}a=t.call(e,s)}catch(Rp){a=[6,Rp],r=0}finally{n=i=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,u])}}},o=ji&&ji.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},s=ji&&ji.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,i,o=n.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(r=o.next()).done;)s.push(r.value)}catch(a){i={error:a}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return s};Object.defineProperty(t,"__esModule",{value:!0}),t.BigPictureClient=t.Configuration=t.Service=void 0,function(e){e.FRESNEL_PROD="https://fresnel-events.vimeocdn.com",e.FRESNEL_PROD_CN="https://fresnel-events.videoji.cn",e.FRESNEL_DEV="https://fresnel-event-staging.vimeows.com",e.EVENTS_PROD="https://lensflare.vimeo.com"}(n=t.Service||(t.Service={}));var a=function(e,t,n,r){void 0===t&&(t=null),void 0===n&&(n=null),void 0===r&&(r=""),this.service=e,this.globalBPO=t,this.contexts=n,this.endpoint=r};t.Configuration=a;var u=function(){function e(){}return Object.defineProperty(e,"isInitalized",{get:function(){return Boolean(e.conf.globalBPO)},enumerable:!1,configurable:!0}),e.configure=function(t){e.conf=t,e.WAIT_QUEUE.length>0&&(e.WAIT_QUEUE.map((function(t){var n=t.event,r=t.contexts;r?e.sendEventWithContexts(n,r):e.sendEvent(n)})),e.WAIT_QUEUE=[])},e.updateObject=function(t,n){return r(this,void 0,void 0,(function(){var r,a,u,c,l,d,h;return i(this,(function(i){try{for(r=o(Object.entries(t)),a=r.next();!a.done;a=r.next())if(u=s(a.value,2),c=u[0],l=u[1],c in n){if(l instanceof Object)return n[c]instanceof Object?(e.updateObject(l,n[c]),[2]):(n[c]=l,[2]);n[c]=l}}catch(f){d={error:f}}finally{try{a&&!a.done&&(h=r.return)&&h.call(r)}finally{if(d)throw d.error}}return[2]}))}))},e.updateContext=function(t){return r(this,void 0,void 0,(function(){return i(this,(function(n){return"global"==t.context&&e.conf.globalBPO&&e.updateObject(t.fields,e.conf.globalBPO.fields),[2]}))}))},e.sendEvent=function(t,n){return r(this,void 0,void 0,(function(){var r,o,s,a,u,c;return i(this,(function(i){switch(i.label){case 0:if(null==t)throw new Error("Required parameter event was null or undefined when calling sendEvent.");return e.isInitalized?(r=JSON.stringify(hp.ObjectSerializer.serialize([new up.Envelope(t,this.conf.globalBPO)],"Array<Envelope>")),o=(0,fp.formatRequestEvent)(t.name),s=""!==this.conf.endpoint?this.conf.endpoint:this.conf.service,a="".concat(s,"/add/").concat(encodeURIComponent(o)),navigator.sendBeacon&&!n?[3,2]:(u={method:"POST",headers:{"Content-Type":"application/json","User-Agent":navigator.userAgent,Origin:location.origin,Referer:document.referrer},body:r},n&&(u.headers.Authorization=n),[4,fetch(a,u)])):(e.WAIT_QUEUE.push({event:t}),e.waitAndFlushQueue(),[2]);case 1:return i.sent(),[3,3];case 2:c=new Blob([r]),navigator.sendBeacon(a,c),i.label=3;case 3:return[2]}}))}))},e.sendEventWithContexts=function(t,n,a){return r(this,void 0,void 0,(function(){var r,u,c,l,d,h,f,p,_,m,v,g,y,E,T,S;return i(this,(function(i){switch(i.label){case 0:if(null==t)throw new Error("Required parameter event was null or undefined when calling sendEvent.");if(!e.isInitalized)return e.WAIT_QUEUE.push({event:t,contexts:n}),e.waitAndFlushQueue(),[2];r=new up.Envelope(t,this.conf.globalBPO),(u=hp.ObjectSerializer.serialize([r],"Array<Envelope>"))[0].contexts={};try{for(c=o(Object.entries(n)),l=c.next();!l.done;l=c.next())d=s(l.value,2),h=d[0],f=d[1],p=hp.ObjectSerializer.serialize(f,"EventContext"),u[0].contexts[h]=p}catch(b){T={error:b}}finally{try{l&&!l.done&&(S=c.return)&&S.call(c)}finally{if(T)throw T.error}}return _=JSON.stringify(u),m=(0,fp.formatRequestEvent)(t.name),v=""!==this.conf.endpoint?this.conf.endpoint:this.conf.service,g="".concat(v,"/add/").concat(encodeURIComponent(m)),navigator.sendBeacon&&!a?[3,2]:(y={method:"POST",headers:{"Content-Type":"application/json","User-Agent":navigator.userAgent,Origin:location.origin,Referer:document.referrer},body:_},a&&(y.headers.Authorization=a),[4,fetch(g,y)]);case 1:return i.sent(),[3,3];case 2:E=new Blob([_]),navigator.sendBeacon(g,E),i.label=3;case 3:return[2]}}))}))},e.waitAndFlushQueue=function(){e.flushQueueTimeoutHandler||(e.flushQueueTimeoutHandler=setTimeout((function(){e.WAIT_QUEUE.length>0&&(e.WAIT_QUEUE=[])}),e.FLUSH_QUEUE_TIMEOUT))},e.FLUSH_QUEUE_TIMEOUT=1e4,e.conf=new a(n.FRESNEL_PROD),e.WAIT_QUEUE=[],e}();t.BigPictureClient=u})),_p=Vi((function(e,t){Object.defineProperty(t,"__esModule",{value:!0})})),mp=Vi((function(e,t){var n=ji&&ji.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var i=Object.getOwnPropertyDescriptor(t,n);i&&!("get"in i?!t.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,i)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),r=ji&&ji.__exportStar||function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||n(t,e,r)};Object.defineProperty(t,"__esModule",{value:!0}),r(pp,t),r(hp,t),r(_p,t)}));const vp=function(e){return(t,...n)=>(n.forEach((n=>{for(const r in n){const i=Object.getOwnPropertyDescriptor(n,r);Object.defineProperty(t,r,Object.assign(i,e))}})),t)}({enumerable:!0,configurable:!0,writeable:!1}),gp={AD_BUFFERING:"ad-buffering",AD_COMPLETE:"ad-complete",AD_CLICK:"ad-click",AD_SKIPPED:"ad-skipped",ALL_ADS_COMPLETED:"all-ads-completed",AD_ERROR:"ad-error",AD_STARTED:"ad-started",ADS_MANAGER_LOADED:"ads-manager-loaded",CONTENT_PAUSE_REQUESTED:"content-pause-requested",CONTENT_RESUME_REQUESTED:"content-resume-requested"};function yp(e,t){const n=new bn;let r,i,o,s,a,u,c=!1,l=1,d=!1;function h(){return ze.iOS?t.videoPlayer.videoElement:t.videoPlayer}function f(){s=new u.AdsRequest,t.adUrl&&(s.adTagUrl=t.adUrl),s.linearAdSlotWidth=t.width.linear,s.linearAdSlotHeight=t.height.linear,s.nonLinearAdSlotWidth=t.width.nonlinear,s.nonLinearAdSlotHeight=t.height.nonlinear,s.setAdWillAutoPlay(t.autoplay),s.setAdWillPlayMuted(t.muted),i.requestAds(s)}function p(e){const t=new u.AdsRenderingSettings;t.restoreCustomPlaybackStateOnAdBreakComplete=!0,t.uiElements=[],t.enablePreloading=!0,o=e.getAdsManager(h(),t);const r=d&&a?0:1;o.setVolume(r),n.fire(gp.ADS_MANAGER_LOADED),o.addEventListener(u.AdErrorEvent.Type.AD_ERROR,R),o.addEventListener(u.AdEvent.Type.CONTENT_PAUSE_REQUESTED,y),o.addEventListener(u.AdEvent.Type.CONTENT_RESUME_REQUESTED,E),o.addEventListener(u.AdEvent.Type.AD_BUFFERING,T),o.addEventListener(u.AdEvent.Type.STARTED,S),o.addEventListener(u.AdEvent.Type.COMPLETE,b),o.addEventListener(u.AdEvent.Type.CLICK,A),o.addEventListener(u.AdEvent.Type.SKIPPED,w),o.addEventListener(u.AdEvent.Type.ALL_ADS_COMPLETED,I)}function _(){t.videoPlayer.pause(),d=!0,a=!1,f()}function m(){t.videoPlayer.volume=0,t.videoPlayer.muted=!0;const e=t.videoPlayer.play();void 0!==e&&e.then(v).catch(g)}function v(){t.videoPlayer.pause(),d=!0,a=!0,f()}function g(){t.videoPlayer.volume=1,t.videoPlayer.muted=!1,d=!1,a=!1,f()}function y(e){n.fire(gp.CONTENT_PAUSE_REQUESTED,e)}function E(e){n.fire(gp.CONTENT_RESUME_REQUESTED,e)}function T(e){n.fire(gp.AD_BUFFERING,e)}function S(e){n.fire(gp.AD_STARTED,e)}function b(e){n.fire(gp.AD_COMPLETE,e)}function A(e){o.pause(),n.fire(gp.AD_CLICK,e)}function w(e){n.fire(gp.AD_SKIPPED,e)}function I(e){n.fire(gp.ALL_ADS_COMPLETED,e)}function R(e){n.fire(gp.AD_ERROR,e.getError()),o&&o.destroy()}const k={isAutoPlayAllowed:()=>d,start:(e,t)=>(c||(r.initialize(),c=!0),o.init(e,t,u.ViewMode.NORMAL),o.start()),stop:()=>o.stop(),pause:()=>o.pause(),play:()=>o.resume(),skip:()=>o.skip(),resize:(e,t,n)=>n?o.resize(e,t,u.ViewMode.FULLSCREEN):o.resize(e,t,u.ViewMode.NORMAL),destroy(){n.off(),o.destroy(),i.destroy(),r.destroy()},get volume(){return M(o.getVolume())},set volume(e){l=N(e),o.setVolume(l)},get muted(){return 0===o.getVolume()},set muted(e){e?o.setVolume(0):o.setVolume(l)},get remainingTime(){return o.getRemainingTime()},setContentComplete(){i&&i.contentComplete()},on(e,t){return n.on(e,t),this},off(e,t){return n.off(e,t),this}};return function(e,t,n){if(document.getElementById(e))n&&n();else{const t=document.createElement("script");t.id=e,t.src="https://imasdk.googleapis.com/js/sdkloader/ima3.js",t.onload=()=>{n&&n()},document.getElementsByTagName("body")[0].appendChild(t)}}("vp-ima-sdk",0,(function(){u=google.ima,r=new u.AdDisplayContainer(e,h()),i=new u.AdsLoader(r),i.addEventListener(u.AdsManagerLoadedEvent.Type.ADS_MANAGER_LOADED,p,!1),i.addEventListener(u.AdErrorEvent.Type.AD_ERROR,R,!1),function(){const e=t.videoPlayer.play();void 0!==e&&e.then(_).catch(m)}()})),vp(this,k)}function Ep(e,t,n,r){if(!vt(e))return e;for(var i=-1,o=(t=$t(t,e)).length,s=o-1,a=e;null!=a&&++i<o;){var u=zt(t[i]),c=n;if("__proto__"===u||"constructor"===u||"prototype"===u)return e;if(i!=s){var l=a[u];void 0===(c=r?r(l,u,a):void 0)&&(c=vt(l)?l:Vn(t[i+1])?[]:{})}kn(a,u,c),a=a[u]}return e}function Tp(e,t){return null!=e&&t in Object(e)}function Sp(e,t){return function(e,t,n){for(var r=-1,i=t.length,o={};++r<i;){var s=t[r],a=Qt(e,s);n(0,s)&&Ep(o,$t(s,e),a)}return o}(e,t,(function(t,n){return function(e,t){return null!=e&&function(e,t,n){for(var r=-1,i=(t=$t(t,e)).length,o=!1;++r<i;){var s=zt(t[r]);if(!(o=null!=e&&n(e,s)))break;e=e[s]}return o||++r!=i?o:!!(i=null==e?0:e.length)&&Bn(i)&&Vn(s,i)&&(tt(e)||Nn(e))}(e,t,Tp)}(e,n)}))}var bp=ot?ot.isConcatSpreadable:void 0;function Ap(e){return tt(e)||Nn(e)||!!(bp&&e&&e[bp])}function wp(e,t,n,r,i){var o=-1,s=e.length;for(n||(n=Ap),i||(i=[]);++o<s;){var a=e[o];t>0&&n(a)?t>1?wp(a,t-1,n,r,i):gr(i,a):r||(i[i.length]=a)}return i}function Ip(e){return null!=e&&e.length?wp(e,1):[]}var Rp,kp,Pp,Dp,Op,Lp,Cp,Np,Mp,xp,Up,Fp=function(e){return fi(ci(e,void 0,Ip),e+"")}((function(e,t){return null==e?{}:Sp(e,t)})),jp=function(e,t){return{name:e,value:void 0===t?-1:t,delta:0,entries:[],id:"v2-".concat(Date.now(),"-").concat(Math.floor(8999999999999*Math.random())+1e12)}},Vp=function(e,t){try{if(PerformanceObserver.supportedEntryTypes.includes(e)){if("first-input"===e&&!("PerformanceEventTiming"in self))return;var n=new PerformanceObserver((function(e){return e.getEntries().map(t)}));return n.observe({type:e,buffered:!0}),n}}catch(e){}},Bp=function(e,t){var n=function n(r){"pagehide"!==r.type&&"hidden"!==document.visibilityState||(e(r),t&&(removeEventListener("visibilitychange",n,!0),removeEventListener("pagehide",n,!0)))};addEventListener("visibilitychange",n,!0),addEventListener("pagehide",n,!0)},Hp=function(e){addEventListener("pageshow",(function(t){t.persisted&&e(t)}),!0)},Xp=function(e,t,n){var r;return function(i){t.value>=0&&(i||n)&&(t.delta=t.value-(r||0),(t.delta||void 0===r)&&(r=t.value,e(t)))}},Wp=-1,qp=function(){return"hidden"===document.visibilityState?0:1/0},Gp=function(){Bp((function(e){var t=e.timeStamp;Wp=t}),!0)},Kp=function(){return Wp<0&&(Wp=qp(),Gp(),Hp((function(){setTimeout((function(){Wp=qp(),Gp()}),0)}))),{get firstHiddenTime(){return Wp}}},Yp=function(e,t){var n,r=Kp(),i=jp("FCP"),o=function(e){"first-contentful-paint"===e.name&&(a&&a.disconnect(),e.startTime<r.firstHiddenTime&&(i.value=e.startTime,i.entries.push(e),n(!0)))},s=window.performance&&performance.getEntriesByName&&performance.getEntriesByName("first-contentful-paint")[0],a=s?null:Vp("paint",o);(s||a)&&(n=Xp(e,i,t),s&&o(s),Hp((function(r){i=jp("FCP"),n=Xp(e,i,t),requestAnimationFrame((function(){requestAnimationFrame((function(){i.value=performance.now()-r.timeStamp,n(!0)}))}))})))},$p=!1,zp=-1,Qp=function(e,t){$p||(Yp((function(e){zp=e.value})),$p=!0);var n,r=function(t){zp>-1&&e(t)},i=jp("CLS",0),o=0,s=[],a=function(e){if(!e.hadRecentInput){var t=s[0],r=s[s.length-1];o&&e.startTime-r.startTime<1e3&&e.startTime-t.startTime<5e3?(o+=e.value,s.push(e)):(o=e.value,s=[e]),o>i.value&&(i.value=o,i.entries=s,n())}},u=Vp("layout-shift",a);u&&(n=Xp(r,i,t),Bp((function(){u.takeRecords().map(a),n(!0)})),Hp((function(){o=0,zp=-1,i=jp("CLS",0),n=Xp(r,i,t)})))},Jp={passive:!0,capture:!0},Zp=new Date,e_=function(e,t){Rp||(Rp=t,kp=e,Pp=new Date,r_(removeEventListener),t_())},t_=function(){if(kp>=0&&kp<Pp-Zp){var e={entryType:"first-input",name:Rp.type,target:Rp.target,cancelable:Rp.cancelable,startTime:Rp.timeStamp,processingStart:Rp.timeStamp+kp};Dp.forEach((function(t){t(e)})),Dp=[]}},n_=function(e){if(e.cancelable){var t=(e.timeStamp>1e12?new Date:performance.now())-e.timeStamp;"pointerdown"==e.type?function(e,t){var n=function(){e_(e,t),i()},r=function(){i()},i=function(){removeEventListener("pointerup",n,Jp),removeEventListener("pointercancel",r,Jp)};addEventListener("pointerup",n,Jp),addEventListener("pointercancel",r,Jp)}(t,e):e_(t,e)}},r_=function(e){["mousedown","keydown","touchstart","pointerdown"].forEach((function(t){return e(t,n_,Jp)}))},i_=function(e,t){var n,r=Kp(),i=jp("FID"),o=function(e){e.startTime<r.firstHiddenTime&&(i.value=e.processingStart-e.startTime,i.entries.push(e),n(!0))},s=Vp("first-input",o);n=Xp(e,i,t),s&&Bp((function(){s.takeRecords().map(o),s.disconnect()}),!0),s&&Hp((function(){var r;i=jp("FID"),n=Xp(e,i,t),Dp=[],kp=-1,Rp=null,r_(addEventListener),r=o,Dp.push(r),t_()}))},o_={},s_=function(e,t){var n,r=Kp(),i=jp("LCP"),o=function(e){var t=e.startTime;t<r.firstHiddenTime&&(i.value=t,i.entries.push(e),n())},s=Vp("largest-contentful-paint",o);if(s){n=Xp(e,i,t);var a=function(){o_[i.id]||(s.takeRecords().map(o),s.disconnect(),o_[i.id]=!0,n(!0))};["keydown","click"].forEach((function(e){addEventListener(e,a,{once:!0,capture:!0})})),Bp(a,!0),Hp((function(r){i=jp("LCP"),n=Xp(e,i,t),requestAnimationFrame((function(){requestAnimationFrame((function(){i.value=performance.now()-r.timeStamp,o_[i.id]=!0,n(!0)}))}))}))}},a_={},u_=[],c_=/acit|ex(?:s|g|n|p|$)|rph|grid|ows|mnc|ntw|ine[ch]|zoo|^ord|itera/i;function l_(e,t){for(var n in t)e[n]=t[n];return e}function d_(e){var t=e.parentNode;t&&t.removeChild(e)}function h_(e,t,n){var r,i,o,s={};for(o in t)"key"==o?r=t[o]:"ref"==o?i=t[o]:s[o]=t[o];if(arguments.length>2&&(s.children=arguments.length>3?Op.call(arguments,2):n),"function"==typeof e&&null!=e.defaultProps)for(o in e.defaultProps)void 0===s[o]&&(s[o]=e.defaultProps[o]);return f_(e,s,r,i,null)}function f_(e,t,n,r,i){var o={type:e,props:t,key:n,ref:r,__k:null,__:null,__b:0,__e:null,__d:void 0,__c:null,__h:null,constructor:void 0,__v:null==i?++Cp:i};return null==i&&null!=Lp.vnode&&Lp.vnode(o),o}function p_(e){return e.children}function __(e,t){this.props=e,this.context=t}function m_(e,t){if(null==t)return e.__?m_(e.__,e.__.__k.indexOf(e)+1):null;for(var n;t<e.__k.length;t++)if(null!=(n=e.__k[t])&&null!=n.__e)return n.__e;return"function"==typeof e.type?m_(e):null}function v_(e){var t,n;if(null!=(e=e.__)&&null!=e.__c){for(e.__e=e.__c.base=null,t=0;t<e.__k.length;t++)if(null!=(n=e.__k[t])&&null!=n.__e){e.__e=e.__c.base=n.__e;break}return v_(e)}}function g_(e){(!e.__d&&(e.__d=!0)&&Np.push(e)&&!y_.__r++||xp!==Lp.debounceRendering)&&((xp=Lp.debounceRendering)||Mp)(y_)}function y_(){for(var e;y_.__r=Np.length;)e=Np.sort((function(e,t){return e.__v.__b-t.__v.__b})),Np=[],e.some((function(e){var t,n,r,i,o,s;e.__d&&(o=(i=(t=e).__v).__e,(s=t.__P)&&(n=[],(r=l_({},i)).__v=i.__v+1,k_(s,i,r,t.__n,void 0!==s.ownerSVGElement,null!=i.__h?[o]:null,n,null==o?m_(i):o,i.__h),P_(n,i),i.__e!=o&&v_(i)))}))}function E_(e,t,n,r,i,o,s,a,u,c){var l,d,h,f,p,_,m,v=r&&r.__k||u_,g=v.length;for(n.__k=[],l=0;l<t.length;l++)if(null!=(f=n.__k[l]=null==(f=t[l])||"boolean"==typeof f?null:"string"==typeof f||"number"==typeof f||"bigint"==typeof f?f_(null,f,null,null,f):Array.isArray(f)?f_(p_,{children:f},null,null,null):f.__b>0?f_(f.type,f.props,f.key,null,f.__v):f)){if(f.__=n,f.__b=n.__b+1,null===(h=v[l])||h&&f.key==h.key&&f.type===h.type)v[l]=void 0;else for(d=0;d<g;d++){if((h=v[d])&&f.key==h.key&&f.type===h.type){v[d]=void 0;break}h=null}k_(e,f,h=h||a_,i,o,s,a,u,c),p=f.__e,(d=f.ref)&&h.ref!=d&&(m||(m=[]),h.ref&&m.push(h.ref,null,f),m.push(d,f.__c||p,f)),null!=p?(null==_&&(_=p),"function"==typeof f.type&&f.__k===h.__k?f.__d=u=T_(f,u,e):u=b_(e,f,h,v,p,u),"function"==typeof n.type&&(n.__d=u)):u&&h.__e==u&&u.parentNode!=e&&(u=m_(h))}for(n.__e=_,l=g;l--;)null!=v[l]&&("function"==typeof n.type&&null!=v[l].__e&&v[l].__e==n.__d&&(n.__d=m_(r,l+1)),L_(v[l],v[l]));if(m)for(l=0;l<m.length;l++)O_(m[l],m[++l],m[++l])}function T_(e,t,n){for(var r,i=e.__k,o=0;i&&o<i.length;o++)(r=i[o])&&(r.__=e,t="function"==typeof r.type?T_(r,t,n):b_(n,r,r,i,r.__e,t));return t}function S_(e,t){return t=t||[],null==e||"boolean"==typeof e||(Array.isArray(e)?e.some((function(e){S_(e,t)})):t.push(e)),t}function b_(e,t,n,r,i,o){var s,a,u;if(void 0!==t.__d)s=t.__d,t.__d=void 0;else if(null==n||i!=o||null==i.parentNode)e:if(null==o||o.parentNode!==e)e.appendChild(i),s=null;else{for(a=o,u=0;(a=a.nextSibling)&&u<r.length;u+=2)if(a==i)break e;e.insertBefore(i,o),s=o}return void 0!==s?s:i.nextSibling}function A_(e,t,n){"-"===t[0]?e.setProperty(t,n):e[t]=null==n?"":"number"!=typeof n||c_.test(t)?n:n+"px"}function w_(e,t,n,r,i){var o;e:if("style"===t)if("string"==typeof n)e.style.cssText=n;else{if("string"==typeof r&&(e.style.cssText=r=""),r)for(t in r)n&&t in n||A_(e.style,t,"");if(n)for(t in n)r&&n[t]===r[t]||A_(e.style,t,n[t])}else if("o"===t[0]&&"n"===t[1])o=t!==(t=t.replace(/Capture$/,"")),t=t.toLowerCase()in e?t.toLowerCase().slice(2):t.slice(2),e.l||(e.l={}),e.l[t+o]=n,n?r||e.addEventListener(t,o?R_:I_,o):e.removeEventListener(t,o?R_:I_,o);else if("dangerouslySetInnerHTML"!==t){if(i)t=t.replace(/xlink[H:h]/,"h").replace(/sName$/,"s");else if("href"!==t&&"list"!==t&&"form"!==t&&"tabIndex"!==t&&"download"!==t&&t in e)try{e[t]=null==n?"":n;break e}catch(e){}"function"==typeof n||(null!=n&&(!1!==n||"a"===t[0]&&"r"===t[1])?e.setAttribute(t,n):e.removeAttribute(t))}}function I_(e){this.l[e.type+!1](Lp.event?Lp.event(e):e)}function R_(e){this.l[e.type+!0](Lp.event?Lp.event(e):e)}function k_(e,t,n,r,i,o,s,a,u){var c,l,d,h,f,p,_,m,v,g,y,E=t.type;if(void 0!==t.constructor)return null;null!=n.__h&&(u=n.__h,a=t.__e=n.__e,t.__h=null,o=[a]),(c=Lp.__b)&&c(t);try{e:if("function"==typeof E){if(m=t.props,v=(c=E.contextType)&&r[c.__c],g=c?v?v.props.value:c.__:r,n.__c?_=(l=t.__c=n.__c).__=l.__E:("prototype"in E&&E.prototype.render?t.__c=l=new E(m,g):(t.__c=l=new __(m,g),l.constructor=E,l.render=C_),v&&v.sub(l),l.props=m,l.state||(l.state={}),l.context=g,l.__n=r,d=l.__d=!0,l.__h=[]),null==l.__s&&(l.__s=l.state),null!=E.getDerivedStateFromProps&&(l.__s==l.state&&(l.__s=l_({},l.__s)),l_(l.__s,E.getDerivedStateFromProps(m,l.__s))),h=l.props,f=l.state,d)null==E.getDerivedStateFromProps&&null!=l.componentWillMount&&l.componentWillMount(),null!=l.componentDidMount&&l.__h.push(l.componentDidMount);else{if(null==E.getDerivedStateFromProps&&m!==h&&null!=l.componentWillReceiveProps&&l.componentWillReceiveProps(m,g),!l.__e&&null!=l.shouldComponentUpdate&&!1===l.shouldComponentUpdate(m,l.__s,g)||t.__v===n.__v){l.props=m,l.state=l.__s,t.__v!==n.__v&&(l.__d=!1),l.__v=t,t.__e=n.__e,t.__k=n.__k,t.__k.forEach((function(e){e&&(e.__=t)})),l.__h.length&&s.push(l);break e}null!=l.componentWillUpdate&&l.componentWillUpdate(m,l.__s,g),null!=l.componentDidUpdate&&l.__h.push((function(){l.componentDidUpdate(h,f,p)}))}l.context=g,l.props=m,l.state=l.__s,(c=Lp.__r)&&c(t),l.__d=!1,l.__v=t,l.__P=e,c=l.render(l.props,l.state,l.context),l.state=l.__s,null!=l.getChildContext&&(r=l_(l_({},r),l.getChildContext())),d||null==l.getSnapshotBeforeUpdate||(p=l.getSnapshotBeforeUpdate(h,f)),y=null!=c&&c.type===p_&&null==c.key?c.props.children:c,E_(e,Array.isArray(y)?y:[y],t,n,r,i,o,s,a,u),l.base=t.__e,t.__h=null,l.__h.length&&s.push(l),_&&(l.__E=l.__=null),l.__e=!1}else null==o&&t.__v===n.__v?(t.__k=n.__k,t.__e=n.__e):t.__e=D_(n.__e,t,n,r,i,o,s,u);(c=Lp.diffed)&&c(t)}catch(e){t.__v=null,(u||null!=o)&&(t.__e=a,t.__h=!!u,o[o.indexOf(a)]=null),Lp.__e(e,t,n)}}function P_(e,t){Lp.__c&&Lp.__c(t,e),e.some((function(t){try{e=t.__h,t.__h=[],e.some((function(e){e.call(t)}))}catch(e){Lp.__e(e,t.__v)}}))}function D_(e,t,n,r,i,o,s,a){var u,c,l,d=n.props,h=t.props,f=t.type,p=0;if("svg"===f&&(i=!0),null!=o)for(;p<o.length;p++)if((u=o[p])&&"setAttribute"in u==!!f&&(f?u.localName===f:3===u.nodeType)){e=u,o[p]=null;break}if(null==e){if(null===f)return document.createTextNode(h);e=i?document.createElementNS("http://www.w3.org/2000/svg",f):document.createElement(f,h.is&&h),o=null,a=!1}if(null===f)d===h||a&&e.data===h||(e.data=h);else{if(o=o&&Op.call(e.childNodes),c=(d=n.props||a_).dangerouslySetInnerHTML,l=h.dangerouslySetInnerHTML,!a){if(null!=o)for(d={},p=0;p<e.attributes.length;p++)d[e.attributes[p].name]=e.attributes[p].value;(l||c)&&(l&&(c&&l.__html==c.__html||l.__html===e.innerHTML)||(e.innerHTML=l&&l.__html||""))}if(function(e,t,n,r,i){var o;for(o in n)"children"===o||"key"===o||o in t||w_(e,o,null,n[o],r);for(o in t)i&&"function"!=typeof t[o]||"children"===o||"key"===o||"value"===o||"checked"===o||n[o]===t[o]||w_(e,o,t[o],n[o],r)}(e,h,d,i,a),l)t.__k=[];else if(p=t.props.children,E_(e,Array.isArray(p)?p:[p],t,n,r,i&&"foreignObject"!==f,o,s,o?o[0]:n.__k&&m_(n,0),a),null!=o)for(p=o.length;p--;)null!=o[p]&&d_(o[p]);a||("value"in h&&void 0!==(p=h.value)&&(p!==e.value||"progress"===f&&!p||"option"===f&&p!==d.value)&&w_(e,"value",p,d.value,!1),"checked"in h&&void 0!==(p=h.checked)&&p!==e.checked&&w_(e,"checked",p,d.checked,!1))}return e}function O_(e,t,n){try{"function"==typeof e?e(t):e.current=t}catch(e){Lp.__e(e,n)}}function L_(e,t,n){var r,i;if(Lp.unmount&&Lp.unmount(e),(r=e.ref)&&(r.current&&r.current!==e.__e||O_(r,null,t)),null!=(r=e.__c)){if(r.componentWillUnmount)try{r.componentWillUnmount()}catch(e){Lp.__e(e,t)}r.base=r.__P=null}if(r=e.__k)for(i=0;i<r.length;i++)r[i]&&L_(r[i],t,"function"!=typeof e.type);n||null==e.__e||d_(e.__e),e.__e=e.__d=void 0}function C_(e,t,n){return this.constructor(e,n)}function N_(e,t,n){var r,i,o;Lp.__&&Lp.__(e,t),i=(r="function"==typeof n)?null:n&&n.__k||t.__k,o=[],k_(t,e=(!r&&n||t).__k=h_(p_,null,[e]),i||a_,a_,void 0!==t.ownerSVGElement,!r&&n?[n]:i?null:t.firstChild?Op.call(t.childNodes):null,o,!r&&n?n:i?i.__e:t.firstChild,r),P_(o,e)}function M_(e,t){N_(e,t,M_)}function x_(e,t,n){var r,i,o,s=l_({},e.props);for(o in t)"key"==o?r=t[o]:"ref"==o?i=t[o]:s[o]=t[o];return arguments.length>2&&(s.children=arguments.length>3?Op.call(arguments,2):n),f_(e.type,s,r||e.key,i||e.ref,null)}function U_(e,t){var n={__c:t="__cC"+Up++,__:e,Consumer:function(e,t){return e.children(t)},Provider:function(e){var n,r;return this.getChildContext||(n=[],(r={})[t]=this,this.getChildContext=function(){return r},this.shouldComponentUpdate=function(e){this.props.value!==e.value&&n.some(g_)},this.sub=function(e){n.push(e);var t=e.componentWillUnmount;e.componentWillUnmount=function(){n.splice(n.indexOf(e),1),t&&t.call(e)}}),e.children}};return n.Provider.__=n.Consumer.contextType=n}Op=u_.slice,Lp={__e:function(e,t){for(var n,r,i;t=t.__;)if((n=t.__c)&&!n.__)try{if((r=n.constructor)&&null!=r.getDerivedStateFromError&&(n.setState(r.getDerivedStateFromError(e)),i=n.__d),null!=n.componentDidCatch&&(n.componentDidCatch(e),i=n.__d),i)return n.__E=n}catch(t){e=t}throw e}},Cp=0,__.prototype.setState=function(e,t){var n;n=null!=this.__s&&this.__s!==this.state?this.__s:this.__s=l_({},this.state),"function"==typeof e&&(e=e(l_({},n),this.props)),e&&l_(n,e),null!=e&&this.__v&&(t&&this.__h.push(t),g_(this))},__.prototype.forceUpdate=function(e){this.__v&&(this.__e=!0,e&&this.__h.push(e),g_(this))},__.prototype.render=p_,Np=[],Mp="function"==typeof Promise?Promise.prototype.then.bind(Promise.resolve()):setTimeout,y_.__r=0,Up=0;var F_,j_,V_,B_=0,H_=[],X_=Lp.__b,W_=Lp.__r,q_=Lp.diffed,G_=Lp.__c,K_=Lp.unmount;function Y_(e,t){Lp.__h&&Lp.__h(j_,e,B_||t),B_=0;var n=j_.__H||(j_.__H={__:[],__h:[]});return e>=n.__.length&&n.__.push({}),n.__[e]}function $_(e){return B_=1,z_(lm,e)}function z_(e,t,n){var r=Y_(F_++,2);return r.t=e,r.__c||(r.__=[n?n(t):lm(void 0,t),function(e){var t=r.t(r.__[0],e);r.__[0]!==t&&(r.__=[t,r.__[1]],r.__c.setState({}))}],r.__c=j_),r.__}function Q_(e,t){var n=Y_(F_++,3);!Lp.__s&&cm(n.__H,t)&&(n.__=e,n.__H=t,j_.__H.__h.push(n))}function J_(e,t){var n=Y_(F_++,4);!Lp.__s&&cm(n.__H,t)&&(n.__=e,n.__H=t,j_.__h.push(n))}function Z_(e){return B_=5,em((function(){return{current:e}}),[])}function em(e,t){var n=Y_(F_++,7);return cm(n.__H,t)&&(n.__=e(),n.__H=t,n.__h=e),n.__}function tm(e,t){return B_=8,em((function(){return e}),t)}function nm(e){var t=j_.context[e.__c],n=Y_(F_++,9);return n.c=e,t?(null==n.__&&(n.__=!0,t.sub(j_)),t.props.value):e.__}function rm(e,t){Lp.useDebugValue&&Lp.useDebugValue(t?t(e):e)}function im(e){var t=Y_(F_++,10),n=$_();return t.__=e,j_.componentDidCatch||(j_.componentDidCatch=function(e){t.__&&t.__(e),n[1](e)}),[n[0],function(){n[1](void 0)}]}function om(){for(var e;e=H_.shift();)if(e.__P)try{e.__H.__h.forEach(am),e.__H.__h.forEach(um),e.__H.__h=[]}catch(Hp){e.__H.__h=[],Lp.__e(Hp,e.__v)}}Lp.__b=function(e){j_=null,X_&&X_(e)},Lp.__r=function(e){W_&&W_(e),F_=0;var t=(j_=e.__c).__H;t&&(t.__h.forEach(am),t.__h.forEach(um),t.__h=[])},Lp.diffed=function(e){q_&&q_(e);var t=e.__c;t&&t.__H&&t.__H.__h.length&&(1!==H_.push(t)&&V_===Lp.requestAnimationFrame||((V_=Lp.requestAnimationFrame)||function(e){var t,n=function(){clearTimeout(r),sm&&cancelAnimationFrame(t),setTimeout(e)},r=setTimeout(n,100);sm&&(t=requestAnimationFrame(n))})(om)),j_=null},Lp.__c=function(e,t){t.some((function(e){try{e.__h.forEach(am),e.__h=e.__h.filter((function(e){return!e.__||um(e)}))}catch(jp){t.some((function(e){e.__h&&(e.__h=[])})),t=[],Lp.__e(jp,e.__v)}})),G_&&G_(e,t)},Lp.unmount=function(e){K_&&K_(e);var t,n=e.__c;n&&n.__H&&(n.__H.__.forEach((function(e){try{am(e)}catch(e){t=e}})),t&&Lp.__e(t,n.__v))};var sm="function"==typeof requestAnimationFrame;function am(e){var t=j_,n=e.__c;"function"==typeof n&&(e.__c=void 0,n()),j_=t}function um(e){var t=j_;e.__c=e.__(),j_=t}function cm(e,t){return!e||e.length!==t.length||t.some((function(t,n){return t!==e[n]}))}function lm(e,t){return"function"==typeof t?t(e):t}function dm(){return dm=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},dm.apply(this,arguments)}function hm(e,t){return hm=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},hm(e,t)}var fm,pm,_m,mm=function(e){var t,n;function r(){return e.apply(this,arguments)||this}n=e,(t=r).prototype=Object.create(n.prototype),t.prototype.constructor=t,hm(t,n);var i=r.prototype;return i.componentDidMount=function(){this.props.nodeRef.current=this.base},i.componentWillUnmount=function(){this.props.nodeRef.current=void 0},i.render=function(){return h_(p_,{},this.props.children)},r}(__);!function(e){e.APPEAR="appear",e.APPEAR_ACTIVE="appearActive",e.APPEAR_DONE="appearDone",e.ENTER="enter",e.ENTER_ACTIVE="enterActive",e.ENTER_DONE="enterDone",e.EXIT="exit",e.EXIT_ACTIVE="exitActive",e.EXIT_DONE="exitDone"}(pm||(pm={})),function(e){e.ENTER="onEnter",e.ENTERING="onEntering",e.ENTERED="onEntered",e.EXIT="onExit",e.EXITING="onExiting",e.EXITED="onExited"}(_m||(_m={}));var vm=((fm={})[pm.APPEAR]=[_m.ENTER,pm.APPEAR_ACTIVE],fm[pm.APPEAR_ACTIVE]=[_m.ENTERING,pm.APPEAR_DONE,!0],fm[pm.APPEAR_DONE]=[_m.ENTERED],fm[pm.ENTER]=[_m.ENTER,pm.ENTER_ACTIVE],fm[pm.ENTER_ACTIVE]=[_m.ENTERING,pm.ENTER_DONE,!0],fm[pm.ENTER_DONE]=[_m.ENTERED],fm[pm.EXIT]=[_m.EXIT,pm.EXIT_ACTIVE],fm[pm.EXIT_ACTIVE]=[_m.EXITING,pm.EXIT_DONE,!0],fm[pm.EXIT_DONE]=[_m.EXITED],fm);function gm(e){var t=e.children,n=e.in,r=void 0!==n&&n,i=e.appear,o=void 0!==i&&i,s=e.enter,a=void 0===s||s,u=e.exit,c=void 0===u||u,l=e.duration,d=void 0===l?500:l,h=e.alwaysMounted,f=void 0!==h&&h,p=e.addEndListener,_=Z_(),m=Z_(),v=!1,g=$_((function(){return v=!0,r?o?pm.APPEAR:pm.APPEAR_DONE:pm.EXIT_DONE})),y=g[0],E=g[1];Q_((function(){var t=window,n=t.setTimeout,r=t.clearTimeout,i=vm[y],o=i[1],s=i[2],a=e[i[0]];return null==a||a(_.current),o&&(s?p?p(_.current,(function(){return E(o)})):m.current=n(E,d,o):E(o)),function(){r(m.current)}}),[y,d]),J_((function(){v||E(r?a?pm.ENTER:pm.ENTER_DONE:c?pm.EXIT:pm.EXIT_DONE)}),[r]);var T=em((function(){var e={};return Object.keys(vm).forEach((function(t){e[t]=y===t})),e}),[y]);return f||(c?y!==pm.EXIT_DONE:r)?h_(mm,{nodeRef:_,children:t(T,y)}):null}var ym,Em=["children","styles"];function Tm(e){var t=e.children,n=e.styles,r=function(e,t){if(null==e)return{};var n,r,i={},o=Object.keys(e);for(r=0;r<o.length;r++)t.indexOf(n=o[r])>=0||(i[n]=e[n]);return i}(e,Em);return h_(gm,r,(function(e,r){var i=t.props.style,o=em((function(){return dm({},function(e,t){var n=t[e];switch(e){case pm.APPEAR_ACTIVE:return dm({},t[pm.APPEAR],n);case pm.ENTER_ACTIVE:return dm({},t[pm.ENTER],n);case pm.EXIT_ACTIVE:return dm({},t[pm.EXIT],n);default:return n}}(r,n),i)}),[i,n,r]);return x_(t,{style:o})}))}function Sm(e,t){for(var n in t)e[n]=t[n];return e}function bm(e,t){for(var n in e)if("__source"!==n&&!(n in t))return!0;for(var r in t)if("__source"!==r&&e[r]!==t[r])return!0;return!1}function Am(e){this.props=e}(ym={})[pm.APPEAR]="-appear",ym[pm.APPEAR_ACTIVE]="-appear-active",ym[pm.APPEAR_DONE]="-appear-done",ym[pm.ENTER]="-enter",ym[pm.ENTER_ACTIVE]="-enter-active",ym[pm.ENTER_DONE]="-enter-done",ym[pm.EXIT]="-exit",ym[pm.EXIT_ACTIVE]="-exit-active",ym[pm.EXIT_DONE]="-exit-done",(Am.prototype=new __).isPureReactComponent=!0,Am.prototype.shouldComponentUpdate=function(e,t){return bm(this.props,e)||bm(this.state,t)};var wm=Lp.__b;Lp.__b=function(e){e.type&&e.type.__f&&e.ref&&(e.props.ref=e.ref,e.ref=null),wm&&wm(e)};var Im="undefined"!=typeof Symbol&&Symbol.for&&Symbol.for("react.forward_ref")||3911;function Rm(e){function t(t,n){var r=Sm({},t);return delete r.ref,e(r,(n=t.ref||n)&&("object"!=typeof n||"current"in n)?n:null)}return t.$$typeof=Im,t.render=t,t.prototype.isReactComponent=t.__f=!0,t.displayName="ForwardRef("+(e.displayName||e.name)+")",t}var km=function(e,t){return null==e?null:S_(S_(e).map(t))},Pm={map:km,forEach:km,count:function(e){return e?S_(e).length:0},only:function(e){var t=S_(e);if(1!==t.length)throw"Children.only";return t[0]},toArray:S_},Dm=Lp.__e;Lp.__e=function(e,t,n){if(e.then)for(var r,i=t;i=i.__;)if((r=i.__c)&&r.__c)return null==t.__e&&(t.__e=n.__e,t.__k=n.__k),r.__c(e,t);Dm(e,t,n)};var Om=Lp.unmount;function Lm(){this.__u=0,this.t=null,this.__b=null}function Cm(e){var t=e.__.__c;return t&&t.__e&&t.__e(e)}function Nm(){this.u=null,this.o=null}Lp.unmount=function(e){var t=e.__c;t&&t.__R&&t.__R(),t&&!0===e.__h&&(e.type=null),Om&&Om(e)},(Lm.prototype=new __).__c=function(e,t){var n=t.__c,r=this;null==r.t&&(r.t=[]),r.t.push(n);var i=Cm(r.__v),o=!1,s=function(){o||(o=!0,n.__R=null,i?i(a):a())};n.__R=s;var a=function(){if(! --r.__u){if(r.state.__e){var e=r.state.__e;r.__v.__k[0]=function e(t,n,r){return t&&(t.__v=null,t.__k=t.__k&&t.__k.map((function(t){return e(t,n,r)})),t.__c&&t.__c.__P===n&&(t.__e&&r.insertBefore(t.__e,t.__d),t.__c.__e=!0,t.__c.__P=r)),t}(e,e.__c.__P,e.__c.__O)}var t;for(r.setState({__e:r.__b=null});t=r.t.pop();)t.forceUpdate()}},u=!0===t.__h;r.__u++||u||r.setState({__e:r.__b=r.__v.__k[0]}),e.then(s,s)},Lm.prototype.componentWillUnmount=function(){this.t=[]},Lm.prototype.render=function(e,t){if(this.__b){if(this.__v.__k){var n=document.createElement("div"),r=this.__v.__k[0].__c;this.__v.__k[0]=function e(t,n,r){return t&&(t.__c&&t.__c.__H&&(t.__c.__H.__.forEach((function(e){"function"==typeof e.__c&&e.__c()})),t.__c.__H=null),null!=(t=Sm({},t)).__c&&(t.__c.__P===r&&(t.__c.__P=n),t.__c=null),t.__k=t.__k&&t.__k.map((function(t){return e(t,n,r)}))),t}(this.__b,n,r.__O=r.__P)}this.__b=null}var i=t.__e&&h_(p_,null,e.fallback);return i&&(i.__h=null),[h_(p_,null,t.__e?null:e.children),i]};var Mm=function(e,t,n){if(++n[1]===n[0]&&e.o.delete(t),e.props.revealOrder&&("t"!==e.props.revealOrder[0]||!e.o.size))for(n=e.u;n;){for(;n.length>3;)n.pop()();if(n[1]<n[0])break;e.u=n=n[2]}};function xm(e){return this.getChildContext=function(){return e.context},e.children}function Um(e){var t=this,n=e.i;t.componentWillUnmount=function(){N_(null,t.l),t.l=null,t.i=null},t.i&&t.i!==n&&t.componentWillUnmount(),e.__v?(t.l||(t.i=n,t.l={nodeType:1,parentNode:n,childNodes:[],appendChild:function(e){this.childNodes.push(e),t.i.appendChild(e)},insertBefore:function(e,n){this.childNodes.push(e),t.i.appendChild(e)},removeChild:function(e){this.childNodes.splice(this.childNodes.indexOf(e)>>>1,1),t.i.removeChild(e)}}),N_(h_(xm,{context:t.context},e.__v),t.l)):t.l&&t.componentWillUnmount()}function Fm(e,t){return h_(Um,{__v:e,i:t})}(Nm.prototype=new __).__e=function(e){var t=this,n=Cm(t.__v),r=t.o.get(e);return r[0]++,function(i){var o=function(){t.props.revealOrder?(r.push(i),Mm(t,e,r)):i()};n?n(o):o()}},Nm.prototype.render=function(e){this.u=null,this.o=new Map;var t=S_(e.children);e.revealOrder&&"b"===e.revealOrder[0]&&t.reverse();for(var n=t.length;n--;)this.o.set(t[n],this.u=[1,0,this.u]);return e.children},Nm.prototype.componentDidUpdate=Nm.prototype.componentDidMount=function(){var e=this;this.o.forEach((function(t,n){Mm(e,n,t)}))};var jm="undefined"!=typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103,Vm=/^(?:accent|alignment|arabic|baseline|cap|clip(?!PathU)|color|dominant|fill|flood|font|glyph(?!R)|horiz|marker(?!H|W|U)|overline|paint|stop|strikethrough|stroke|text(?!L)|underline|unicode|units|v|vector|vert|word|writing|x(?!C))[A-Z]/,Bm="undefined"!=typeof document,Hm=function(e){return("undefined"!=typeof Symbol&&"symbol"==typeof Symbol()?/fil|che|rad/i:/fil|che|ra/i).test(e)};__.prototype.isReactComponent={},["componentWillMount","componentWillReceiveProps","componentWillUpdate"].forEach((function(e){Object.defineProperty(__.prototype,e,{configurable:!0,get:function(){return this["UNSAFE_"+e]},set:function(t){Object.defineProperty(this,e,{configurable:!0,writable:!0,value:t})}})}));var Xm=Lp.event;function Wm(){}function qm(){return this.cancelBubble}function Gm(){return this.defaultPrevented}Lp.event=function(e){return Xm&&(e=Xm(e)),e.persist=Wm,e.isPropagationStopped=qm,e.isDefaultPrevented=Gm,e.nativeEvent=e};var Km,Ym={configurable:!0,get:function(){return this.class}},$m=Lp.vnode;Lp.vnode=function(e){var t=e.type,n=e.props,r=n;if("string"==typeof t){var i=-1===t.indexOf("-");for(var o in r={},n){var s=n[o];Bm&&"children"===o&&"noscript"===t||"value"===o&&"defaultValue"in n&&null==s||("defaultValue"===o&&"value"in n&&null==n.value?o="value":"download"===o&&!0===s?s="":/ondoubleclick/i.test(o)?o="ondblclick":/^onchange(textarea|input)/i.test(o+t)&&!Hm(n.type)?o="oninput":/^onfocus$/i.test(o)?o="onfocusin":/^onblur$/i.test(o)?o="onfocusout":/^on(Ani|Tra|Tou|BeforeInp|Compo)/.test(o)?o=o.toLowerCase():i&&Vm.test(o)?o=o.replace(/[A-Z0-9]/,"-$&").toLowerCase():null===s&&(s=void 0),r[o]=s)}"select"==t&&r.multiple&&Array.isArray(r.value)&&(r.value=S_(n.children).forEach((function(e){e.props.selected=-1!=r.value.indexOf(e.props.value)}))),"select"==t&&null!=r.defaultValue&&(r.value=S_(n.children).forEach((function(e){e.props.selected=r.multiple?-1!=r.defaultValue.indexOf(e.props.value):r.defaultValue==e.props.value}))),e.props=r,n.class!=n.className&&(Ym.enumerable="className"in n,null!=n.className&&(r.class=n.className),Object.defineProperty(r,"className",Ym))}e.$$typeof=jm,$m&&$m(e)};var zm=Lp.__r;Lp.__r=function(e){zm&&zm(e),Km=e.__c};var Qm={ReactCurrentDispatcher:{current:{readContext:function(e){return Km.__n[e.__c].props.value}}}};function Jm(e){return!!e&&e.$$typeof===jm}var Zm={useState:$_,useReducer:z_,useEffect:Q_,useLayoutEffect:J_,useRef:Z_,useImperativeHandle:function(e,t,n){B_=6,J_((function(){"function"==typeof e?e(t()):e&&(e.current=t())}),null==n?n:n.concat(e))},useMemo:em,useCallback:tm,useContext:nm,useDebugValue:rm,version:"17.0.2",Children:Pm,render:function(e,t,n){return null==t.__k&&(t.textContent=""),N_(e,t),"function"==typeof n&&n(),e?e.__c:null},hydrate:function(e,t,n){return M_(e,t),"function"==typeof n&&n(),e?e.__c:null},unmountComponentAtNode:function(e){return!!e.__k&&(N_(null,e),!0)},createPortal:Fm,createElement:h_,createContext:U_,createFactory:function(e){return h_.bind(null,e)},cloneElement:function(e){return Jm(e)?x_.apply(null,arguments):e},createRef:function(){return{current:null}},Fragment:p_,isValidElement:Jm,findDOMNode:function(e){return e&&(e.base||1===e.nodeType&&e)||null},Component:__,PureComponent:Am,memo:function(e,t){function n(e){var n=this.props.ref,r=n==e.ref;return!r&&n&&(n.call?n(null):n.current=null),t?!t(this.props,e)||!r:bm(this.props,e)}function r(t){return this.shouldComponentUpdate=n,h_(e,t)}return r.displayName="Memo("+(e.displayName||e.name)+")",r.prototype.isReactComponent=!0,r.__f=!0,r},forwardRef:Rm,flushSync:function(e,t){return e(t)},unstable_batchedUpdates:function(e,t){return e(t)},StrictMode:p_,Suspense:Lm,SuspenseList:Nm,lazy:function(e){var t,n,r;function i(i){if(t||(t=e()).then((function(e){n=e.default||e}),(function(e){r=e})),r)throw r;if(!n)throw t;return h_(n,i)}return i.displayName="Lazy",i.__f=!0,i},__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED:Qm};const ev="undefined"==typeof window||!window.navigator||/ServerSideRendering|^Deno\//.test(window.navigator.userAgent)?Q_:J_;function tv(e){const t="function"==typeof e?function(e){let t;const n=new Set,r=(e,r)=>{const i="function"==typeof e?e(t):e;if(i!==t){const e=t;t=r?i:Object.assign({},t,i),n.forEach((n=>n(t,e)))}},i=()=>t,o={setState:r,getState:i,subscribe:(e,r,o)=>r||o?((e,r=i,o=Object.is)=>{let s=r(t);function a(){const n=r(t);if(!o(s,n)){const t=s;e(s=n,t)}}return n.add(a),()=>n.delete(a)})(e,r,o):(n.add(e),()=>n.delete(e)),destroy:()=>n.clear()};return t=e(r,i,o),o}(e):e,n=(e=t.getState,n=Object.is)=>{const[,r]=z_((e=>e+1),0),i=t.getState(),o=Z_(i),s=Z_(e),a=Z_(n),u=Z_(!1),c=Z_();let l;void 0===c.current&&(c.current=e(i));let d=!1;(o.current!==i||s.current!==e||a.current!==n||u.current)&&(l=e(i),d=!n(c.current,l)),ev((()=>{d&&(c.current=l),o.current=i,s.current=e,a.current=n,u.current=!1}));const h=Z_(i);ev((()=>{const e=()=>{try{const e=t.getState(),n=s.current(e);a.current(c.current,n)||(o.current=e,c.current=n,r())}catch(e){u.current=!0,r()}},n=t.subscribe(e);return t.getState()!==h.current&&e(),n}),[]);const f=d?l:c.current;return rm(f),f};return Object.assign(n,t),n[Symbol.iterator]=function(){const e=[n,t];return{next(){const t=e.length<=0;return{value:e.shift(),done:t}}}},n}function nv(){const e=U_(void 0);return{Provider:({initialStore:t,createStore:n,children:r})=>{const i=Z_();return i.current||(t&&(n||(n=()=>t)),i.current=n()),h_(e.Provider,{value:i.current},r)},useStore:(t,n=Object.is)=>{const r=nm(e);if(!r)throw new Error("Seems like you have not used zustand provider as an ancestor.");return r(t,n)},useStoreApi:()=>{const t=nm(e);if(!t)throw new Error("Seems like you have not used zustand provider as an ancestor.");return em((()=>({getState:t.getState,setState:t.setState,subscribe:t.subscribe,destroy:t.destroy})),[t])}}}const rv=e=>(t,n,r)=>{const i=r.subscribe;return r.subscribe=(e,t,n)=>{let o=e;if(t){const i=(null==n?void 0:n.equalityFn)||Object.is;let s=e(r.getState());o=n=>{const r=e(n);if(!i(s,r)){const e=s;t(s=r,e)}},(null==n?void 0:n.fireImmediately)&&t(s,s)}return i(o)},e(t,n,r)};var iv=0;function ov(e,t,n,r,i){var o,s,a={};for(s in t)"ref"==s?o=t[s]:a[s]=t[s];var u={type:e,props:a,key:n,ref:o,__k:null,__:null,__b:0,__e:null,__d:void 0,__c:null,__h:null,constructor:void 0,__v:--iv,__source:r,__self:i};if("function"==typeof e&&(o=e.defaultProps))for(s in o)void 0===a[s]&&(a[s]=o[s]);return Lp.vnode&&Lp.vnode(u),u}function sv(e){var t=-1,n=null==e?0:e.length;for(this.__data__=new Vt;++t<n;)this.add(e[t])}function av(e,t){for(var n=-1,r=null==e?0:e.length;++n<r;)if(t(e[n],n,e))return!0;return!1}function uv(e,t){return e.has(t)}function cv(e,t,n,r,i,o){var s=1&n,a=e.length,u=t.length;if(a!=u&&!(s&&u>a))return!1;var c=o.get(e),l=o.get(t);if(c&&l)return c==t&&l==e;var d=-1,h=!0,f=2&n?new sv:void 0;for(o.set(e,t),o.set(t,e);++d<a;){var p=e[d],_=t[d];if(r)var m=s?r(_,p,d,t,e,o):r(p,_,d,e,t,o);if(void 0!==m){if(m)continue;h=!1;break}if(f){if(!av(t,(function(e,t){if(!uv(f,t)&&(p===e||i(p,e,n,r,o)))return f.push(t)}))){h=!1;break}}else if(p!==_&&!i(p,_,n,r,o)){h=!1;break}}return o.delete(e),o.delete(t),h}function lv(e){var t=-1,n=Array(e.size);return e.forEach((function(e,r){n[++t]=[r,e]})),n}function dv(e){var t=-1,n=Array(e.size);return e.forEach((function(e){n[++t]=e})),n}sv.prototype.add=sv.prototype.push=function(e){return this.__data__.set(e,"__lodash_hash_undefined__"),this},sv.prototype.has=function(e){return this.__data__.has(e)};var hv=ot?ot.prototype:void 0,fv=hv?hv.valueOf:void 0,pv=Object.prototype.hasOwnProperty,_v="[object Arguments]",mv="[object Array]",vv="[object Object]",gv=Object.prototype.hasOwnProperty;function yv(e,t,n,r,i){return e===t||(null==e||null==t||!ft(e)&&!ft(t)?e!=e&&t!=t:function(e,t,n,r,i,o){var s=tt(e),a=tt(t),u=s?mv:jr(e),c=a?mv:jr(t),l=(u=u==_v?vv:u)==vv,d=(c=c==_v?vv:c)==vv,h=u==c;if(h&&Fn(e)){if(!Fn(t))return!1;s=!0,l=!1}if(h&&!l)return o||(o=new An),s||$n(e)?cv(e,t,n,r,i,o):function(e,t,n,r,i,o,s){switch(n){case"[object DataView]":if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case"[object ArrayBuffer]":return!(e.byteLength!=t.byteLength||!o(new Br(e),new Br(t)));case"[object Boolean]":case"[object Date]":case"[object Number]":return Nt(+e,+t);case"[object Error]":return e.name==t.name&&e.message==t.message;case"[object RegExp]":case"[object String]":return e==t+"";case"[object Map]":var a=lv;case"[object Set]":var u=1&r;if(a||(a=dv),e.size!=t.size&&!u)return!1;var c=s.get(e);if(c)return c==t;r|=2,s.set(e,t);var l=cv(a(e),a(t),r,i,o,s);return s.delete(e),l;case"[object Symbol]":if(fv)return fv.call(e)==fv.call(t)}return!1}(e,t,u,n,r,i,o);if(!(1&n)){var f=l&&gv.call(e,"__wrapped__"),p=d&&gv.call(t,"__wrapped__");if(f||p){var _=f?e.value():e,m=p?t.value():t;return o||(o=new An),i(_,m,n,r,o)}}return!!h&&(o||(o=new An),function(e,t,n,r,i,o){var s=1&n,a=Sr(e),u=a.length;if(u!=Sr(t).length&&!s)return!1;for(var c=u;c--;){var l=a[c];if(!(s?l in t:pv.call(t,l)))return!1}var d=o.get(e),h=o.get(t);if(d&&h)return d==t&&h==e;var f=!0;o.set(e,t),o.set(t,e);for(var p=s;++c<u;){var _=e[l=a[c]],m=t[l];if(r)var v=s?r(m,_,l,t,e,o):r(_,m,l,e,t,o);if(!(void 0===v?_===m||i(_,m,n,r,o):v)){f=!1;break}p||(p="constructor"==l)}if(f&&!p){var g=e.constructor,y=t.constructor;g==y||!("constructor"in e)||!("constructor"in t)||"function"==typeof g&&g instanceof g&&"function"==typeof y&&y instanceof y||(f=!1)}return o.delete(e),o.delete(t),f}(e,t,n,r,i,o))}(e,t,n,r,yv,i))}function Ev(e,t){return yv(e,t)}var Tv=[],Sv=[];function bv(e,t){if(e&&"undefined"!=typeof document){var n,r=!0===t.prepend?"prepend":"append",i=!0===t.singleTag,o="string"==typeof t.container?document.querySelector(t.container):document.getElementsByTagName("head")[0];if(i){var s=Tv.indexOf(o);-1===s&&(s=Tv.push(o)-1,Sv[s]={}),n=Sv[s]&&Sv[s][r]?Sv[s][r]:Sv[s][r]=a()}else n=a();65279===e.charCodeAt(0)&&(e=e.substring(1)),n.styleSheet?n.styleSheet.cssText+=e:n.appendChild(document.createTextNode(e))}function a(){var e=document.createElement("style");if(e.setAttribute("type","text/css"),t.attributes)for(var n=Object.keys(t.attributes),i=0;i<n.length;i++)e.setAttribute(n[i],t.attributes[n[i]]);var s="prepend"===r?"afterbegin":"beforeend";return o.insertAdjacentElement(s,e),e}}function Av(){return Av=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Av.apply(this,arguments)}var wv,Iv=["bottom","height","left","right","top","width"],Rv=new Map,kv=function e(){var t=[];Rv.forEach((function(e,n){var r=n.getBoundingClientRect();(function(e,t){return void 0===e&&(e={}),void 0===t&&(t={}),Iv.some((function(n){return e[n]!==t[n]}))})(r,e.rect)&&(e.rect=r,t.push(e))})),t.forEach((function(e){e.callbacks.forEach((function(t){return t(e.rect)}))})),wv=window.requestAnimationFrame(e)},Pv="undefined"!=typeof window?Zm.useLayoutEffect:Zm.useEffect;function Dv(e,t){void 0===t&&(t={width:0,height:0});var n=Zm.useState(e.current),r=n[0],i=n[1],o=Zm.useReducer(Ov,t),s=o[0],a=o[1],u=Zm.useRef(!1);return Pv((function(){e.current!==r&&i(e.current)})),Pv((function(){if(r&&!u.current){u.current=!0;var e=r.getBoundingClientRect();a({rect:e})}}),[r]),Zm.useEffect((function(){if(r){var e=function(e,t){return{observe:function(){var n=0===Rv.size;Rv.has(e)?Rv.get(e).callbacks.push(t):Rv.set(e,{rect:void 0,hasRectChanged:!1,callbacks:[t]}),n&&kv()},unobserve:function(){var n=Rv.get(e);if(n){var r=n.callbacks.indexOf(t);r>=0&&n.callbacks.splice(r,1),n.callbacks.length||Rv.delete(e),Rv.size||cancelAnimationFrame(wv)}}}}(r,(function(e){a({rect:e})}));return e.observe(),function(){e.unobserve()}}}),[r]),s}function Ov(e,t){var n=t.rect;return e.height!==n.height||e.width!==n.width?n:e}var Lv=function(){return 50},Cv=function(e){return e},Nv=function(e,t){return e[t?"offsetWidth":"offsetHeight"]},Mv=function(e){for(var t=Math.max(e.start-e.overscan,0),n=Math.min(e.end+e.overscan,e.size-1),r=[],i=t;i<=n;i++)r.push(i);return r};function xv(e){var t,n=e.size,r=void 0===n?0:n,i=e.estimateSize,o=void 0===i?Lv:i,s=e.overscan,a=void 0===s?1:s,u=e.paddingStart,c=void 0===u?0:u,l=e.paddingEnd,d=void 0===l?0:l,h=e.parentRef,f=e.horizontal,p=e.scrollToFn,_=e.useObserver,m=e.initialRect,v=e.onScrollElement,g=e.scrollOffsetFn,y=e.keyExtractor,E=void 0===y?Cv:y,T=e.measureSize,S=void 0===T?Nv:T,b=e.rangeExtractor,A=void 0===b?Mv:b,w=f?"width":"height",I=f?"scrollLeft":"scrollTop",R=Zm.useRef({scrollOffset:0,measurements:[]}),k=Zm.useState(0),P=k[0],D=k[1];R.current.scrollOffset=P;var O=(_||Dv)(h,m)[w];R.current.outerSize=O;var L=Zm.useCallback((function(e){h.current&&(h.current[I]=e)}),[h,I]),C=p||L;p=Zm.useCallback((function(e){C(e,L)}),[L,C]);var N=Zm.useState({}),M=N[0],x=N[1],U=Zm.useCallback((function(){return x({})}),[]),F=Zm.useRef([]),j=Zm.useMemo((function(){var e=F.current.length>0?Math.min.apply(Math,F.current):0;F.current=[];for(var t=R.current.measurements.slice(0,e),n=e;n<r;n++){var i=E(n),s=M[i],a=t[n-1]?t[n-1].end:c,u="number"==typeof s?s:o(n),l=a+u;t[n]={index:n,start:a,size:u,end:l,key:i}}return t}),[o,M,c,r,E]),V=((null==(t=j[r-1])?void 0:t.end)||c)+d;R.current.measurements=j,R.current.totalSize=V;var B=v?v.current:h.current,H=Zm.useRef(g);H.current=g,Pv((function(){if(B){var e=function(e){var t=H.current?H.current(e):B[I];D(t)};return e(),B.addEventListener("scroll",e,{capture:!1,passive:!0}),function(){B.removeEventListener("scroll",e)}}D(0)}),[B,I]);var X=function(e){for(var t=e.measurements,n=e.outerSize,r=e.scrollOffset,i=t.length-1,o=Uv(0,i,(function(e){return t[e].start}),r),s=o;s<i&&t[s].end<r+n;)s++;return{start:o,end:s}}(R.current),W=X.start,q=X.end,G=Zm.useMemo((function(){return A({start:W,end:q,overscan:a,size:j.length})}),[W,q,a,j.length,A]),K=Zm.useRef(S);K.current=S;var Y=Zm.useMemo((function(){for(var e=[],t=function(t,n){var r=G[t],i=Av(Av({},j[r]),{},{measureRef:function(e){if(e){var t=K.current(e,f);if(t!==i.size){var n=R.current.scrollOffset;i.start<n&&L(n+(t-i.size)),F.current.push(r),x((function(e){var n;return Av(Av({},e),{},((n={})[i.key]=t,n))}))}}}});e.push(i)},n=0,r=G.length;n<r;n++)t(n);return e}),[G,L,f,j]),$=Zm.useRef(!1);Pv((function(){$.current&&x({}),$.current=!0}),[o]);var z=Zm.useCallback((function(e,t){var n=(void 0===t?{}:t).align,r=void 0===n?"start":n,i=R.current,o=i.scrollOffset,s=i.outerSize;"auto"===r&&(r=e<=o?"start":e>=o+s?"end":"start"),"start"===r?p(e):"end"===r?p(e-s):"center"===r&&p(e-s/2)}),[p]),Q=Zm.useCallback((function(e,t){var n=void 0===t?{}:t,i=n.align,o=void 0===i?"auto":i,s=function(e,t){if(null==e)return{};var n,r,i={},o=Object.keys(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||(i[n]=e[n]);return i}(n,["align"]),a=R.current,u=a.measurements,c=a.scrollOffset,l=a.outerSize,d=u[Math.max(0,Math.min(e,r-1))];if(d){if("auto"===o)if(d.end>=c+l)o="end";else{if(!(d.start<=c))return;o="start"}var h="center"===o?d.start+d.size/2:"end"===o?d.end:d.start;z(h,Av({align:o},s))}}),[z,r]),J=Zm.useCallback((function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];Q.apply(void 0,t),requestAnimationFrame((function(){Q.apply(void 0,t)}))}),[Q]);return{virtualItems:Y,totalSize:V,scrollToOffset:z,scrollToIndex:J,measure:U}}var Uv=function(e,t,n,r){for(;e<=t;){var i=(e+t)/2|0,o=n(i);if(o<r)e=i+1;else{if(!(o>r))return i;t=i-1}}return e>0?e-1:0};export{Vo as $,Il as A,wl as B,uh as C,kl as D,bn as E,Tl as F,Dh as G,Sl as H,Pl as I,Ol as J,Ll as K,dh as L,Li as M,Kl as N,Ui as O,bl as P,Al as Q,Dl as R,Rl as S,Ni as T,xi as U,Di as V,Dc as W,Xo as X,Wo as Y,Ho as Z,T as _,Q as a,Qe as a$,O as a0,Bt as a1,gt as a2,Fh as a3,sf as a4,af as a5,pf as a6,Of as a7,Df as a8,Si as a9,C as aA,rv as aB,Tm as aC,Rm as aD,h_ as aE,m as aF,p_ as aG,nm as aH,U_ as aI,S_ as aJ,x_ as aK,Ie as aL,Fm as aM,bv as aN,em as aO,N_ as aP,Mi as aQ,o as aR,id as aS,a as aT,s as aU,Dd as aV,vn as aW,En as aX,gn as aY,Y as aZ,oh as a_,lh as aa,W as ab,_h as ac,q as ad,B as ae,ch as af,Td as ag,J as ah,Cf as ai,mp as aj,yp as ak,gp as al,Fp as am,i_ as an,Qp as ao,s_ as ap,H as aq,Q_ as ar,$_ as as,Z_ as at,tm as au,nv as av,im as aw,ov as ax,tv as ay,Ev as az,g as b,F as b0,L as b1,ff as b2,Oe as b3,t as b4,Qi as b5,xv as b6,oi as c,$ as d,x as e,td as f,Jt as g,e as h,sh as i,d as j,y as k,X as l,Eh as m,h as n,Nd as o,z as p,ll as q,Se as r,ze as s,K as t,Z as u,l as v,yh as w,oe as x,p as y,Uh as z};
